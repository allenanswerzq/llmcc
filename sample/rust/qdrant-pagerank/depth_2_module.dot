digraph architecture {
  // Layout settings
  rankdir=TB;
  ranksep=0.8;
  nodesep=0.4;
  splines=ortho;
  concentrate=true;

  node [shape=box, style="rounded,filled", fillcolor="#f0f0f0", fontname="Helvetica"];
  edge [color="#666666", arrowsize=0.7];

  labelloc=t;
  fontsize=16;
  fontname="Helvetica Bold";

  subgraph cluster_api {
    label="api";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_api_grpc[label="grpc"];
    mod_api_rest[label="rest"];
  }

  subgraph cluster_collection {
    label="collection";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_collection_common[label="common"];
    mod_collection_operations[label="operations"];
    mod_collection_shards[label="shards"];
    mod_collection_verification[label="verification"];
  }

  subgraph cluster_common {
    label="common";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_common_counter[label="counter"];
  }

  subgraph cluster_qdrant {
    label="qdrant";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_qdrant_actix[label="actix"];
    mod_qdrant_api[label="api"];
    mod_qdrant_common[label="common"];
    mod_qdrant_inference[label="inference"];
  }

  subgraph cluster_qdrant_edge_py {
    label="qdrant-edge-py";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_qdrant_edge_py_filter[label="filter"];
    mod_qdrant_edge_py_types[label="types"];
  }

  subgraph cluster_segment {
    label="segment";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_segment_common[label="common"];
    mod_segment_data_types[label="data_types"];
    mod_segment_dense[label="dense"];
    mod_segment_field_index[label="field_index"];
    mod_segment_hnsw_index[label="hnsw_index"];
    mod_segment_id_tracker[label="id_tracker"];
    mod_segment_index[label="index"];
    mod_segment_inverted_index[label="inverted_index"];
    mod_segment_numeric_index[label="numeric_index"];
    mod_segment_payload_storage[label="payload_storage"];
    mod_segment_quantized[label="quantized"];
    mod_segment_segment_constructor[label="segment_constructor"];
    mod_segment_types[label="types"];
    mod_segment_vector_storage[label="vector_storage"];
  }

  subgraph cluster_shard {
    label="shard";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_shard_operations[label="operations"];
    mod_shard_query[label="query"];
  }

  subgraph cluster_storage {
    label="storage";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_storage_content_manager[label="content_manager"];
  }


  mod_api_grpc -> mod_api_rest [dir=both]; // dir best-effort not accurate
  mod_api_grpc -> mod_collection_operations [dir=both]; // dir best-effort not accurate
  mod_api_grpc -> mod_qdrant_edge_py_types [dir=both]; // dir best-effort not accurate
  mod_api_grpc -> mod_segment_data_types [dir=both]; // dir best-effort not accurate
  mod_api_grpc -> mod_segment_field_index [dir=both]; // dir best-effort not accurate
  mod_api_grpc -> mod_segment_payload_storage [dir=both]; // dir best-effort not accurate
  mod_api_grpc -> mod_segment_types [dir=both]; // dir best-effort not accurate
  mod_api_grpc -> mod_segment_vector_storage [dir=both]; // dir best-effort not accurate
  mod_api_rest -> mod_collection_verification [dir=both]; // dir best-effort not accurate
  mod_api_rest -> mod_segment_data_types [dir=both]; // dir best-effort not accurate
  mod_api_rest -> mod_segment_types;
  mod_collection_common -> mod_collection_operations [dir=both]; // dir best-effort not accurate
  mod_collection_operations -> mod_api_rest;
  mod_collection_operations -> mod_collection_shards [dir=both]; // dir best-effort not accurate
  mod_collection_operations -> mod_segment_types [dir=both]; // dir best-effort not accurate
  mod_collection_operations -> mod_segment_vector_storage;
  mod_collection_operations -> mod_shard_operations [dir=both]; // dir best-effort not accurate
  mod_collection_shards -> mod_api_grpc;
  mod_collection_shards -> mod_shard_operations;
  mod_collection_verification -> mod_api_grpc;
  mod_collection_verification -> mod_segment_data_types;
  mod_qdrant_actix -> mod_api_rest;
  mod_qdrant_actix -> mod_storage_content_manager;
  mod_qdrant_api -> mod_api_grpc;
  mod_qdrant_api -> mod_api_rest;
  mod_qdrant_api -> mod_collection_common;
  mod_qdrant_api -> mod_collection_operations;
  mod_qdrant_api -> mod_collection_verification;
  mod_qdrant_api -> mod_qdrant_actix;
  mod_qdrant_api -> mod_qdrant_common [dir=both]; // dir best-effort not accurate
  mod_qdrant_api -> mod_qdrant_inference [dir=both]; // dir best-effort not accurate
  mod_qdrant_api -> mod_segment_vector_storage;
  mod_qdrant_api -> mod_storage_content_manager;
  mod_qdrant_common -> mod_api_grpc;
  mod_qdrant_common -> mod_api_rest;
  mod_qdrant_common -> mod_collection_operations;
  mod_qdrant_common -> mod_collection_verification;
  mod_qdrant_common -> mod_common_counter;
  mod_qdrant_common -> mod_qdrant_inference;
  mod_qdrant_common -> mod_shard_operations;
  mod_qdrant_common -> mod_storage_content_manager;
  mod_qdrant_edge_py_filter -> mod_api_grpc;
  mod_qdrant_edge_py_filter -> mod_segment_types;
  mod_qdrant_edge_py_types -> mod_segment_data_types;
  mod_qdrant_edge_py_types -> mod_shard_operations;
  mod_qdrant_inference -> mod_api_grpc;
  mod_qdrant_inference -> mod_api_rest;
  mod_qdrant_inference -> mod_segment_vector_storage;
  mod_qdrant_inference -> mod_shard_operations;
  mod_qdrant_inference -> mod_storage_content_manager;
  mod_segment_common -> mod_api_grpc;
  mod_segment_common -> mod_segment_data_types;
  mod_segment_common -> mod_segment_hnsw_index [dir=both]; // dir best-effort not accurate
  mod_segment_common -> mod_segment_types;
  mod_segment_data_types -> mod_segment_dense [dir=both]; // dir best-effort not accurate
  mod_segment_data_types -> mod_segment_types [dir=both]; // dir best-effort not accurate
  mod_segment_data_types -> mod_segment_vector_storage [dir=both]; // dir best-effort not accurate
  mod_segment_data_types -> mod_shard_operations [dir=both]; // dir best-effort not accurate
  mod_segment_data_types -> mod_shard_query [dir=both]; // dir best-effort not accurate
  mod_segment_dense -> mod_api_grpc;
  mod_segment_dense -> mod_segment_types;
  mod_segment_dense -> mod_segment_vector_storage [dir=both]; // dir best-effort not accurate
  mod_segment_field_index -> mod_segment_numeric_index [dir=both]; // dir best-effort not accurate
  mod_segment_hnsw_index -> mod_segment_index [dir=both]; // dir best-effort not accurate
  mod_segment_hnsw_index -> mod_segment_quantized [dir=both]; // dir best-effort not accurate
  mod_segment_hnsw_index -> mod_segment_vector_storage;
  mod_segment_index -> mod_api_grpc;
  mod_segment_index -> mod_segment_field_index;
  mod_segment_index -> mod_segment_quantized;
  mod_segment_inverted_index -> mod_api_rest;
  mod_segment_numeric_index -> mod_common_counter;
  mod_segment_numeric_index -> mod_qdrant_actix;
  mod_segment_numeric_index -> mod_segment_common;
  mod_segment_payload_storage -> mod_segment_common;
  mod_segment_quantized -> mod_common_counter;
  mod_segment_quantized -> mod_segment_types;
  mod_segment_quantized -> mod_segment_vector_storage [dir=both]; // dir best-effort not accurate
  mod_segment_segment_constructor -> mod_common_counter;
  mod_segment_segment_constructor -> mod_segment_dense;
  mod_segment_segment_constructor -> mod_segment_id_tracker;
  mod_segment_segment_constructor -> mod_segment_index;
  mod_segment_segment_constructor -> mod_segment_payload_storage;
  mod_segment_segment_constructor -> mod_segment_types;
  mod_segment_segment_constructor -> mod_segment_vector_storage;
  mod_segment_vector_storage -> mod_common_counter;
  mod_shard_operations -> mod_api_grpc;
  mod_shard_operations -> mod_api_rest;
  mod_shard_query -> mod_api_grpc;
  mod_shard_query -> mod_segment_types;
  mod_storage_content_manager -> mod_api_grpc;
  mod_storage_content_manager -> mod_collection_operations;
  mod_storage_content_manager -> mod_collection_verification;
}
