digraph architecture {
  // Layout settings
  rankdir=TB;
  ranksep=0.8;
  nodesep=0.4;
  splines=ortho;
  concentrate=true;

  node [shape=box, style="rounded,filled", fillcolor="#f0f0f0", fontname="Helvetica"];
  edge [color="#666666", arrowsize=0.7];

  labelloc=t;
  fontsize=16;
  fontname="Helvetica Bold";

  subgraph cluster_codex_app_server_protocol {
    label="codex-app-server-protocol";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_codex_app_server_protocol_export[label="export"];
    mod_codex_app_server_protocol_protocol[label="protocol"];
  }

  subgraph cluster_codex_core {
    label="codex-core";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_codex_core_auth[label="auth"];
    mod_codex_core_codex[label="codex"];
    mod_codex_core_command_safety[label="command_safety"];
    mod_codex_core_config[label="config"];
    mod_codex_core_config_loader[label="config_loader"];
    mod_codex_core_handlers[label="handlers"];
    mod_codex_core_rollout[label="rollout"];
    mod_codex_core_skills[label="skills"];
    mod_codex_core_tools[label="tools"];
    mod_codex_core_unified_exec[label="unified_exec"];
  }

  subgraph cluster_codex_protocol {
    label="codex-protocol";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_codex_protocol_protocol[label="protocol"];
  }

  subgraph cluster_codex_rmcp_client {
    label="codex-rmcp-client";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_codex_rmcp_client_oauth[label="oauth"];
  }

  subgraph cluster_codex_tui {
    label="codex-tui";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_codex_tui_bottom_pane[label="bottom_pane"];
    mod_codex_tui_chatwidget[label="chatwidget"];
    mod_codex_tui_history_cell[label="history_cell"];
    mod_codex_tui_status[label="status"];
  }

  subgraph cluster_codex_tui2 {
    label="codex-tui2";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_codex_tui2_bottom_pane[label="bottom_pane"];
    mod_codex_tui2_chatwidget[label="chatwidget"];
    mod_codex_tui2_history_cell[label="history_cell"];
    mod_codex_tui2_render[label="render"];
    mod_codex_tui2_status[label="status"];
  }

  subgraph cluster_mcp_types {
    label="mcp-types";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_mcp_types_lib[label="lib"];
  }


  mod_codex_app_server_protocol_export -> mod_mcp_types_lib;
  mod_codex_app_server_protocol_protocol -> mod_codex_core_config [dir=both]; // dir best-effort not accurate
  mod_codex_app_server_protocol_protocol -> mod_codex_protocol_protocol [dir=both]; // dir best-effort not accurate
  mod_codex_core_auth -> mod_codex_app_server_protocol_protocol;
  mod_codex_core_codex -> mod_codex_app_server_protocol_protocol;
  mod_codex_core_codex -> mod_codex_core_config;
  mod_codex_core_codex -> mod_codex_core_tools [dir=both]; // dir best-effort not accurate
  mod_codex_core_codex -> mod_codex_protocol_protocol;
  mod_codex_core_codex -> mod_mcp_types_lib;
  mod_codex_core_command_safety -> mod_codex_protocol_protocol;
  mod_codex_core_config -> mod_codex_core_auth;
  mod_codex_core_config -> mod_codex_core_config_loader [dir=both]; // dir best-effort not accurate
  mod_codex_core_config -> mod_codex_protocol_protocol;
  mod_codex_core_config -> mod_codex_rmcp_client_oauth;
  mod_codex_core_config_loader -> mod_codex_app_server_protocol_protocol;
  mod_codex_core_config_loader -> mod_codex_protocol_protocol;
  mod_codex_core_handlers -> mod_codex_core_codex;
  mod_codex_core_handlers -> mod_codex_core_tools;
  mod_codex_core_handlers -> mod_codex_protocol_protocol;
  mod_codex_core_handlers -> mod_mcp_types_lib;
  mod_codex_core_rollout -> mod_codex_protocol_protocol;
  mod_codex_core_skills -> mod_codex_app_server_protocol_protocol;
  mod_codex_core_skills -> mod_codex_protocol_protocol;
  mod_codex_core_tools -> mod_codex_protocol_protocol;
  mod_codex_core_unified_exec -> mod_codex_core_codex;
  mod_codex_core_unified_exec -> mod_codex_core_tools;
  mod_codex_protocol_protocol -> mod_mcp_types_lib;
  mod_codex_tui2_bottom_pane -> mod_codex_core_skills;
  mod_codex_tui2_bottom_pane -> mod_codex_protocol_protocol;
  mod_codex_tui2_bottom_pane -> mod_codex_tui2_render;
  mod_codex_tui2_chatwidget -> mod_codex_app_server_protocol_protocol;
  mod_codex_tui2_chatwidget -> mod_codex_core_auth;
  mod_codex_tui2_chatwidget -> mod_codex_protocol_protocol;
  mod_codex_tui2_chatwidget -> mod_codex_tui2_bottom_pane;
  mod_codex_tui2_chatwidget -> mod_codex_tui2_status [dir=both]; // dir best-effort not accurate
  mod_codex_tui2_chatwidget -> mod_codex_tui_chatwidget [dir=both]; // dir best-effort not accurate
  mod_codex_tui2_history_cell -> mod_codex_protocol_protocol;
  mod_codex_tui2_history_cell -> mod_mcp_types_lib;
  mod_codex_tui2_status -> mod_codex_app_server_protocol_protocol;
  mod_codex_tui2_status -> mod_codex_core_auth;
  mod_codex_tui2_status -> mod_codex_protocol_protocol;
  mod_codex_tui2_status -> mod_codex_tui2_history_cell;
  mod_codex_tui_bottom_pane -> mod_codex_core_skills;
  mod_codex_tui_bottom_pane -> mod_codex_protocol_protocol;
  mod_codex_tui_bottom_pane -> mod_codex_tui2_render;
  mod_codex_tui_chatwidget -> mod_codex_app_server_protocol_protocol;
  mod_codex_tui_chatwidget -> mod_codex_core_auth;
  mod_codex_tui_chatwidget -> mod_codex_protocol_protocol;
  mod_codex_tui_history_cell -> mod_codex_core_config;
  mod_codex_tui_history_cell -> mod_codex_protocol_protocol;
  mod_codex_tui_history_cell -> mod_mcp_types_lib;
  mod_codex_tui_status -> mod_codex_app_server_protocol_protocol;
  mod_codex_tui_status -> mod_codex_core_auth;
  mod_codex_tui_status -> mod_codex_protocol_protocol;
  mod_codex_tui_status -> mod_codex_tui2_chatwidget;
  mod_codex_tui_status -> mod_codex_tui2_history_cell;
  mod_codex_tui_status -> mod_codex_tui2_status;
}
