digraph architecture {
  // Layout settings
  rankdir=TB;
  ranksep=0.8;
  nodesep=0.4;
  splines=ortho;
  concentrate=true;

  node [shape=box, style="rounded,filled", fillcolor="#f0f0f0", fontname="Helvetica"];
  edge [color="#666666", arrowsize=0.7];

  labelloc=t;
  fontsize=16;
  fontname="Helvetica Bold";

  subgraph cluster_fsst {
    label="fsst";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_fsst_fsst[label="fsst"];
  }

  subgraph cluster_lance {
    label="lance";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_commit[label="commit"];
    mod_lance_dataset[label="dataset"];
    mod_lance_exec[label="exec"];
    mod_lance_index[label="index"];
    mod_lance_io[label="io"];
    mod_lance_ivf[label="ivf"];
    mod_lance_optimize[label="optimize"];
    mod_lance_session[label="session"];
    mod_lance_vector[label="vector"];
    mod_lance_write[label="write"];
  }

  subgraph cluster_lance_core {
    label="lance-core";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_core_cache[label="cache"];
    mod_lance_core_datatypes[label="datatypes"];
    mod_lance_core_utils[label="utils"];
  }

  subgraph cluster_lance_datagen {
    label="lance-datagen";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_datagen_generator[label="generator"];
  }

  subgraph cluster_lance_encoding {
    label="lance-encoding";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_encoding_buffer[label="buffer"];
    mod_lance_encoding_compression[label="compression"];
    mod_lance_encoding_compression_config[label="compression_config"];
    mod_lance_encoding_data[label="data"];
    mod_lance_encoding_decoder[label="decoder"];
    mod_lance_encoding_encoder[label="encoder"];
    mod_lance_encoding_encodings[label="encodings"];
    mod_lance_encoding_lib[label="lib"];
    mod_lance_encoding_logical[label="logical"];
    mod_lance_encoding_physical[label="physical"];
    mod_lance_encoding_previous[label="previous"];
    mod_lance_encoding_primitive[label="primitive"];
    mod_lance_encoding_testing[label="testing"];
    mod_lance_encoding_version[label="version"];
  }

  subgraph cluster_lance_file {
    label="lance-file";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_file_datatypes[label="datatypes"];
    mod_lance_file_previous[label="previous"];
    mod_lance_file_reader[label="reader"];
    mod_lance_file_testing[label="testing"];
    mod_lance_file_writer[label="writer"];
  }

  subgraph cluster_lance_index {
    label="lance-index";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_index_bq[label="bq"];
    mod_lance_index_flat[label="flat"];
    mod_lance_index_frag_reuse[label="frag_reuse"];
    mod_lance_index_hnsw[label="hnsw"];
    mod_lance_index_inverted[label="inverted"];
    mod_lance_index_ivf[label="ivf"];
    mod_lance_index_lib[label="lib"];
    mod_lance_index_mem_wal[label="mem_wal"];
    mod_lance_index_optimize[label="optimize"];
    mod_lance_index_pq[label="pq"];
    mod_lance_index_scalar[label="scalar"];
    mod_lance_index_sq[label="sq"];
    mod_lance_index_tokenizer[label="tokenizer"];
    mod_lance_index_vector[label="vector"];
  }

  subgraph cluster_lance_io {
    label="lance-io";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_io_encodings[label="encodings"];
    mod_lance_io_lib[label="lib"];
    mod_lance_io_object_store[label="object_store"];
    mod_lance_io_providers[label="providers"];
    mod_lance_io_scheduler[label="scheduler"];
    mod_lance_io_stream[label="stream"];
    mod_lance_io_traits[label="traits"];
    mod_lance_io_utils[label="utils"];
  }

  subgraph cluster_lance_jni {
    label="lance-jni";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_jni_blocking_dataset[label="blocking_dataset"];
    mod_lance_jni_merge_insert[label="merge_insert"];
    mod_lance_jni_traits[label="traits"];
    mod_lance_jni_transaction[label="transaction"];
    mod_lance_jni_utils[label="utils"];
  }

  subgraph cluster_lance_linalg {
    label="lance-linalg";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_linalg_distance[label="distance"];
    mod_lance_linalg_kernels[label="kernels"];
  }

  subgraph cluster_lance_namespace_impls {
    label="lance-namespace-impls";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_namespace_impls_rest_adapter[label="rest_adapter"];
  }

  subgraph cluster_lance_table {
    label="lance-table";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_table_commit[label="commit"];
    mod_lance_table_format[label="format"];
    mod_lance_table_io[label="io"];
    mod_lance_table_rowids[label="rowids"];
  }

  subgraph cluster_lance_test_macros {
    label="lance-test-macros";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_test_macros_lib[label="lib"];
  }

  subgraph cluster_lance_testing {
    label="lance-testing";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_lance_testing_datagen[label="datagen"];
  }

  subgraph cluster_pylance {
    label="pylance";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";
    fontname="Helvetica Bold";

    mod_pylance_dataset[label="dataset"];
    mod_pylance_indices[label="indices"];
    mod_pylance_lib[label="lib"];
    mod_pylance_schema[label="schema"];
  }


  mod_fsst_fsst -> mod_lance_encoding_lib;
  mod_lance_commit -> mod_lance_dataset;
  mod_lance_datagen_generator -> mod_lance_core_datatypes;
  mod_lance_dataset -> mod_lance_core_datatypes;
  mod_lance_dataset -> mod_lance_core_utils;
  mod_lance_dataset -> mod_lance_encoding_version;
  mod_lance_dataset -> mod_lance_file_reader;
  mod_lance_dataset -> mod_lance_index_scalar [dir=both]; // dir best-effort not accurate
  mod_lance_dataset -> mod_lance_io [dir=both]; // dir best-effort not accurate
  mod_lance_dataset -> mod_lance_io_object_store;
  mod_lance_dataset -> mod_lance_io_scheduler [dir=both]; // dir best-effort not accurate
  mod_lance_dataset -> mod_lance_optimize [dir=both]; // dir best-effort not accurate
  mod_lance_dataset -> mod_lance_session;
  mod_lance_dataset -> mod_lance_table_format;
  mod_lance_dataset -> mod_lance_table_io [dir=both]; // dir best-effort not accurate
  mod_lance_dataset -> mod_lance_table_rowids;
  mod_lance_dataset -> mod_lance_write [dir=both]; // dir best-effort not accurate
  mod_lance_encoding_compression -> mod_lance_encoding_compression_config;
  mod_lance_encoding_compression -> mod_lance_encoding_data;
  mod_lance_encoding_compression -> mod_lance_encoding_physical [dir=both]; // dir best-effort not accurate
  mod_lance_encoding_compression -> mod_lance_encoding_primitive [dir=both]; // dir best-effort not accurate
  mod_lance_encoding_data -> mod_lance_encoding_buffer;
  mod_lance_encoding_decoder -> mod_lance_core_cache;
  mod_lance_encoding_decoder -> mod_lance_core_datatypes;
  mod_lance_encoding_decoder -> mod_lance_encoding_encoder [dir=both]; // dir best-effort not accurate
  mod_lance_encoding_decoder -> mod_lance_encoding_encodings [dir=both]; // dir best-effort not accurate
  mod_lance_encoding_decoder -> mod_lance_encoding_logical [dir=both]; // dir best-effort not accurate
  mod_lance_encoding_encoder -> mod_lance_encoding_version;
  mod_lance_encoding_encoder -> mod_lance_file_writer [dir=both]; // dir best-effort not accurate
  mod_lance_encoding_logical -> mod_lance_core_datatypes;
  mod_lance_encoding_logical -> mod_lance_encoding_buffer;
  mod_lance_encoding_logical -> mod_lance_encoding_compression;
  mod_lance_encoding_logical -> mod_lance_encoding_data;
  mod_lance_encoding_logical -> mod_lance_encoding_encoder;
  mod_lance_encoding_logical -> mod_lance_encoding_previous;
  mod_lance_encoding_logical -> mod_lance_encoding_primitive [dir=both]; // dir best-effort not accurate
  mod_lance_encoding_logical -> mod_lance_file_datatypes;
  mod_lance_encoding_physical -> mod_lance_encoding_buffer;
  mod_lance_encoding_physical -> mod_lance_encoding_data;
  mod_lance_encoding_physical -> mod_lance_encoding_decoder;
  mod_lance_encoding_physical -> mod_lance_encoding_previous;
  mod_lance_encoding_physical -> mod_lance_encoding_primitive;
  mod_lance_encoding_primitive -> mod_lance_encoding_data;
  mod_lance_encoding_primitive -> mod_lance_encoding_decoder;
  mod_lance_encoding_testing -> mod_lance_core_datatypes;
  mod_lance_encoding_testing -> mod_lance_encoding_decoder;
  mod_lance_encoding_testing -> mod_lance_encoding_encoder;
  mod_lance_encoding_testing -> mod_lance_encoding_version;
  mod_lance_exec -> mod_lance_core_datatypes;
  mod_lance_exec -> mod_lance_core_utils;
  mod_lance_exec -> mod_lance_dataset;
  mod_lance_exec -> mod_lance_index_inverted;
  mod_lance_exec -> mod_lance_index_vector;
  mod_lance_exec -> mod_lance_io_scheduler;
  mod_lance_exec -> mod_lance_table_format;
  mod_lance_exec -> mod_pylance_dataset;
  mod_lance_file_previous -> mod_lance_core_datatypes;
  mod_lance_file_previous -> mod_lance_io_lib;
  mod_lance_file_testing -> mod_lance_encoding_decoder;
  mod_lance_index -> mod_lance_core_cache;
  mod_lance_index -> mod_lance_dataset;
  mod_lance_index -> mod_lance_index_frag_reuse;
  mod_lance_index -> mod_lance_index_ivf;
  mod_lance_index -> mod_lance_index_lib;
  mod_lance_index -> mod_lance_index_mem_wal;
  mod_lance_index -> mod_lance_index_scalar [dir=both]; // dir best-effort not accurate
  mod_lance_index -> mod_lance_index_vector [dir=both]; // dir best-effort not accurate
  mod_lance_index -> mod_lance_io_utils;
  mod_lance_index -> mod_lance_optimize [dir=both]; // dir best-effort not accurate
  mod_lance_index -> mod_lance_table_format;
  mod_lance_index -> mod_lance_vector [dir=both]; // dir best-effort not accurate
  mod_lance_index_bq -> mod_lance_index_vector [dir=both]; // dir best-effort not accurate
  mod_lance_index_flat -> mod_lance_index_vector [dir=both]; // dir best-effort not accurate
  mod_lance_index_flat -> mod_lance_linalg_distance;
  mod_lance_index_hnsw -> mod_lance_index_vector [dir=both]; // dir best-effort not accurate
  mod_lance_index_inverted -> mod_lance_index_scalar [dir=both]; // dir best-effort not accurate
  mod_lance_index_inverted -> mod_lance_index_tokenizer;
  mod_lance_index_ivf -> mod_lance_index_vector [dir=both]; // dir best-effort not accurate
  mod_lance_index_pq -> mod_lance_index_vector;
  mod_lance_index_scalar -> mod_lance_core_cache;
  mod_lance_index_scalar -> mod_lance_core_datatypes;
  mod_lance_index_scalar -> mod_lance_core_utils;
  mod_lance_index_scalar -> mod_lance_index_frag_reuse;
  mod_lance_index_scalar -> mod_lance_index_lib;
  mod_lance_index_sq -> mod_lance_index_vector [dir=both]; // dir best-effort not accurate
  mod_lance_index_vector -> mod_lance_linalg_distance;
  mod_lance_io -> mod_lance_core_utils;
  mod_lance_io -> mod_lance_io_object_store;
  mod_lance_io -> mod_lance_table_format;
  mod_lance_io -> mod_lance_table_io;
  mod_lance_io -> mod_pylance_dataset;
  mod_lance_io_encodings -> mod_lance_io_traits;
  mod_lance_io_object_store -> mod_lance_io_utils [dir=both]; // dir best-effort not accurate
  mod_lance_io_providers -> mod_lance_io_object_store;
  mod_lance_io_stream -> mod_lance_ivf [dir=both]; // dir best-effort not accurate
  mod_lance_io_stream -> mod_lance_vector [dir=both]; // dir best-effort not accurate
  mod_lance_io_traits -> mod_lance_io_utils [dir=both]; // dir best-effort not accurate
  mod_lance_ivf -> mod_lance_dataset;
  mod_lance_ivf -> mod_lance_index_hnsw;
  mod_lance_ivf -> mod_lance_index_ivf;
  mod_lance_ivf -> mod_lance_index_vector;
  mod_lance_ivf -> mod_lance_linalg_distance;
  mod_lance_ivf -> mod_lance_table_io;
  mod_lance_ivf -> mod_lance_vector [dir=both]; // dir best-effort not accurate
  mod_lance_jni_blocking_dataset -> mod_lance_dataset;
  mod_lance_jni_blocking_dataset -> mod_lance_jni_traits;
  mod_lance_jni_blocking_dataset -> mod_lance_jni_utils;
  mod_lance_jni_merge_insert -> mod_lance_write;
  mod_lance_jni_transaction -> mod_lance_dataset;
  mod_lance_linalg_kernels -> mod_lance_index_inverted;
  mod_lance_namespace_impls_rest_adapter -> mod_lance_io_scheduler;
  mod_lance_session -> mod_lance_core_cache;
  mod_lance_table_commit -> mod_lance_table_io [dir=both]; // dir best-effort not accurate
  mod_lance_table_format -> mod_lance_table_rowids [dir=both]; // dir best-effort not accurate
  mod_lance_table_io -> mod_lance_io_object_store;
  mod_lance_table_io -> mod_lance_table_format;
  mod_lance_table_io -> mod_pylance_dataset [dir=both]; // dir best-effort not accurate
  mod_lance_test_macros_lib -> mod_lance_index_inverted;
  mod_lance_testing_datagen -> mod_lance_datagen_generator;
  mod_lance_vector -> mod_lance_core_datatypes;
  mod_lance_vector -> mod_lance_dataset;
  mod_lance_vector -> mod_lance_index_ivf;
  mod_lance_vector -> mod_lance_index_optimize;
  mod_lance_vector -> mod_lance_index_pq;
  mod_lance_vector -> mod_lance_index_vector;
  mod_lance_vector -> mod_lance_linalg_distance;
  mod_lance_write -> mod_lance_core_datatypes;
  mod_lance_write -> mod_lance_core_utils;
  mod_lance_write -> mod_lance_table_format;
  mod_lance_write -> mod_pylance_dataset;
  mod_pylance_dataset -> mod_lance_dataset;
  mod_pylance_indices -> mod_lance_dataset;
  mod_pylance_indices -> mod_lance_index_ivf;
  mod_pylance_indices -> mod_lance_index_vector;
  mod_pylance_indices -> mod_lance_linalg_distance;
  mod_pylance_indices -> mod_pylance_lib [dir=both]; // dir best-effort not accurate
  mod_pylance_schema -> mod_lance_core_datatypes;
}
