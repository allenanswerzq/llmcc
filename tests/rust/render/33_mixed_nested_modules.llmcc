===============================================================================
mixed-nested-modules
===============================================================================
Deep module nesting with pub use re-exports and scoped paths.
Combines: nested modules, pub use, crate::, super::, scoped paths.

--- file: sample/Cargo.toml ---
[package]
name = "sample"

--- file: sample/src/lib.rs ---
pub mod core;
pub mod api;

pub use api::client::HttpClient;
pub use core::types::Result;

--- file: sample/src/core/mod.rs ---
pub mod types;
pub mod error;

--- file: sample/src/core/types.rs ---
use super::error::Error;

pub type Result<T> = std::result::Result<T, Error>;

pub struct Request {
    pub url: String,
    pub method: String,
}

pub struct Response {
    pub status: u16,
    pub body: String,
}

--- file: sample/src/core/error.rs ---
pub struct Error {
    pub code: i32,
    pub message: String,
}

--- file: sample/src/api/mod.rs ---
pub mod client;

--- file: sample/src/api/client.rs ---
use crate::core::types::{Request, Response};
use crate::core::error::Error;

pub trait Transport {
    fn send(&self, req: Request) -> Response;
}

pub struct HttpClient {
    pub base_url: String,
}

// TOOD: do we need to have edge with Request -> Transport, then
// Transport -> Response?
impl Transport for HttpClient {
    fn send(&self, req: Request) -> Response {
        Response {
            status: 200,
            body: String::new(),
        }
    }
}

pub fn create_client(url: String) -> HttpClient {
    HttpClient { base_url: url }
}

--- expect:block-graph ---
(root:1 lib ($TMP/sample/src/lib.rs)
  (module:2 core)
  (module:3 api)
)

(root:4 mod ($TMP/sample/src/core/mod.rs)
  (module:5 types)
  (module:6 error)
)

(root:7 types ($TMP/sample/src/core/types.rs)
  (alias:8 Result)
  (class:9 Request
    (field:10 url @type String)
    (field:11 method @type String)
  )
  (class:12 Response
    (field:13 status @type u16)
    (field:14 body @type String)
  )
)

(root:15 error ($TMP/sample/src/core/error.rs)
  (class:16 Error
    (field:17 code @type i32)
    (field:18 message @type String)
  )
)

(root:19 mod ($TMP/sample/src/api/mod.rs)
  (module:20 client)
)

(root:21 client ($TMP/sample/src/api/client.rs)
  (trait:22 Transport
    (method:23 send
      (parameter:24 self @type:22 Transport)
      (parameter:25 req @type:9 Request)
      (return:26 @type:12 Response)
      (@tdep:9 Request)
      (@tdep:12 Response)
    )
  )
  (class:27 HttpClient
    (field:28 base_url @type String)
  )
  (impl:29 HttpClient @type:27 @trait:22
    (method:30 send
      (parameter:31 self @type:27 HttpClient)
      (parameter:32 req @type:9 Request)
      (return:33 @type:12 Response)
      (@tdep:9 Request)
      (@tdep:12 Response)
    )
  )
  (func:35 create_client
    (parameter:36 url @type String)
    (return:37 @type:27 HttpClient)
    (@tdep:27 HttpClient)
  )
)

--- expect:arch-graph ---
digraph architecture {
  rankdir=TB;
  ranksep=0.6;
  nodesep=0.3;
  splines=ortho;
  compound=true;

  node [shape=box, style=rounded];
  edge [arrowsize=0.7];

  subgraph cluster_sample {
    label="sample";
    style=rounded;
        bgcolor="#f8f8f8";

    subgraph cluster_api {
      label="api";
      style=rounded;
            bgcolor="#f5f5f5";

      subgraph cluster_client_rs {
        label="client.rs";
        style=rounded;
                bgcolor="#fafafa";

        n35[label="create_client", path="$TMP/sample/src/api/client.rs:23", sym_ty="Function", shape=ellipse];
        n22[label="Transport", path="$TMP/sample/src/api/client.rs:4", sym_ty="Trait", shape=box];
        n27[label="HttpClient", path="$TMP/sample/src/api/client.rs:8", sym_ty="Struct", shape=box];
      }

    }

  }


  n22 -> n27 [from="trait", to="impl"];
  n35 -> n27 [from="func", to="output"];
}
