===============================================================================
mixed-builder-pattern
===============================================================================
Builder pattern with method chaining, multiple traits, and factory function.
Combines: impl blocks, method returns Self, trait bounds, factory functions.

--- file: sample/Cargo.toml ---
[package]
name = "sample"

--- file: sample/src/lib.rs ---
mod config;
mod builder;

--- file: sample/src/config.rs ---
pub trait Configurable {
    fn validate(&self) -> bool;
}

pub trait Buildable {
    type Output;
    fn build(self) -> Self::Output;
}

pub struct ServerConfig {
    pub host: String,
    pub port: u16,
    pub timeout: u32,
}

impl Configurable for ServerConfig {
    fn validate(&self) -> bool {
        self.port > 0
    }
}

--- file: sample/src/builder.rs ---
use crate::config::{ServerConfig, Configurable, Buildable};

pub struct ConfigBuilder {
    host: String,
    port: u16,
    timeout: u32,
}

impl ConfigBuilder {
    pub fn new() -> Self {
        ConfigBuilder {
            host: String::new(),
            port: 8080,
            timeout: 30,
        }
    }

    pub fn host(mut self, host: String) -> Self {
        self.host = host;
        self
    }

    pub fn port(mut self, port: u16) -> Self {
        self.port = port;
        self
    }
}

impl Buildable for ConfigBuilder {
    type Output = ServerConfig;

    fn build(self) -> ServerConfig {
        ServerConfig {
            host: self.host,
            port: self.port,
            timeout: self.timeout,
        }
    }
}

pub fn create_default_config() -> impl Configurable {
    ConfigBuilder::new().build()
}

--- expect:block-graph ---
(root:1 lib ($TMP/sample/src/lib.rs)
  (module:2 config)
  (module:3 builder)
)

(root:4 config ($TMP/sample/src/config.rs)
  (trait:5 Configurable
    (method:6 validate
      (parameter:7 self @type:5 Configurable)
      (return:8 @type bool)
    )
  )
  (trait:9 Buildable
    (alias:10 Output)
    (method:11 build
      (parameter:12 self @type:9 Buildable)
      (return:13 @type:9 Buildable)
    )
  )
  (class:14 ServerConfig @extends:14 ServerConfig
    (field:15 host @type String)
    (field:16 port @type u16)
    (field:17 timeout @type u32)
  )
  (impl:18 ServerConfig @type:14 @trait:5
    (method:19 validate
      (parameter:20 self @type:14 ServerConfig)
      (return:21 @type bool)
    )
  )
)

(root:22 builder ($TMP/sample/src/builder.rs)
  (class:23 ConfigBuilder
    (field:24 host @type Self)
    (field:25 port @type Self)
    (field:26 timeout @type u32)
  )
  (impl:27 ConfigBuilder @type:23
    (method:28 new
      (return:29 @type:23 ConfigBuilder)
    )
    (method:31 host
      (parameter:32 self @type:23 ConfigBuilder)
      (parameter:33 host @type String)
      (return:34 @type:23 ConfigBuilder)
    )
    (method:35 port
      (parameter:36 self @type:23 ConfigBuilder)
      (parameter:37 port @type u16)
      (return:38 @type:23 ConfigBuilder)
    )
  )
  (impl:39 ConfigBuilder @type:23 @trait:9
    (alias:40 Output)
    (method:41 build
      (parameter:42 self @type:23 ConfigBuilder)
      (return:43 @type:14 ServerConfig)
      (@tdep:14 ServerConfig)
    )
  )
  (func:44 create_default_config
    (return:45 @type:5 Configurable)
  )
)

--- expect:arch-graph ---
digraph architecture {
  rankdir=TB;
  ranksep=0.6;
  nodesep=0.3;
  splines=ortho;
  compound=true;

  node [shape=box, style=rounded];
  edge [arrowsize=0.7];

  subgraph cluster_sample {
    label="sample";
    style=rounded;
        bgcolor="#f8f8f8";

    subgraph cluster_builder_rs {
      label="builder.rs";
      style=rounded;
            bgcolor="#fafafa";

      n23[label="ConfigBuilder", path="$TMP/sample/src/builder.rs:3", sym_ty="Struct", shape=box];
      n44[label="create_default_config", path="$TMP/sample/src/builder.rs:41", sym_ty="Function", shape=ellipse];
    }

    subgraph cluster_config_rs {
      label="config.rs";
      style=rounded;
            bgcolor="#fafafa";

      n5[label="Configurable", path="$TMP/sample/src/config.rs:1", sym_ty="Trait", shape=box];
      n14[label="ServerConfig", path="$TMP/sample/src/config.rs:10", sym_ty="Struct", shape=box];
      n9[label="Buildable", path="$TMP/sample/src/config.rs:5", sym_ty="Trait", shape=box];
    }

  }


  n5 -> n14 [from="trait", to="impl"];
  n9 -> n23 [from="trait", to="impl"];
  n44 -> n5 [from="func", to="output"];
}
