===============================================================================
mixed-builder-pattern
===============================================================================
Builder pattern with method chaining, multiple traits, and factory function.
Combines: impl blocks, method returns Self, trait bounds, factory functions.

--- file: sample/Cargo.toml ---
[package]
name = "sample"

--- file: sample/src/lib.rs ---
mod config;
mod builder;

--- file: sample/src/config.rs ---
pub trait Configurable {
    fn validate(&self) -> bool;
}

pub trait Buildable {
    type Output;
    fn build(self) -> Self::Output;
}

pub struct ServerConfig {
    pub host: String,
    pub port: u16,
    pub timeout: u32,
}

impl Configurable for ServerConfig {
    fn validate(&self) -> bool {
        self.port > 0
    }
}

--- file: sample/src/builder.rs ---
use crate::config::{ServerConfig, Configurable, Buildable};

pub struct ConfigBuilder {
    host: String,
    port: u16,
    timeout: u32,
}

impl ConfigBuilder {
    pub fn new() -> Self {
        ConfigBuilder {
            host: String::new(),
            port: 8080,
            timeout: 30,
        }
    }

    pub fn host(mut self, host: String) -> Self {
        self.host = host;
        self
    }

    pub fn port(mut self, port: u16) -> Self {
        self.port = port;
        self
    }
}

impl Buildable for ConfigBuilder {
    type Output = ServerConfig;

    fn build(self) -> ServerConfig {
        ServerConfig {
            host: self.host,
            port: self.port,
            timeout: self.timeout,
        }
    }
}

pub fn create_default_config() -> impl Configurable {
    ConfigBuilder::new().build()
}

--- expect:block-graph ---
(root:1 lib ($TMP/sample/src/lib.rs))

(root:2 config ($TMP/sample/src/config.rs)
  (trait:3 Configurable
    (method:4 validate
      (parameter:5 self @type:3 Configurable)
      (return:6 @type bool)
    )
  )
  (trait:7 Buildable
    (alias:8 Output)
    (method:9 build
      (parameter:10 self @type:7 Buildable)
      (return:11 @type:7 Buildable)
    )
  )
  (class:12 ServerConfig
    (field:13 host @type String)
    (field:14 port @type u16)
    (field:15 timeout @type u32)
  )
  (impl:16 ServerConfig @type:12 @trait:3
    (method:17 validate
      (parameter:18 self @type:12 ServerConfig)
      (return:19 @type bool)
    )
  )
)

(root:20 builder ($TMP/sample/src/builder.rs)
  (class:21 ConfigBuilder
    (field:22 host @type Self)
    (field:23 port @type Self)
    (field:24 timeout @type u32)
  )
  (impl:25 ConfigBuilder @type:21
    (method:26 new
      (return:27 @type:21 ConfigBuilder)
    )
    (method:29 host
      (parameter:30 self @type:21 ConfigBuilder)
      (parameter:31 host @type String)
      (return:32 @type:21 ConfigBuilder)
    )
    (method:33 port
      (parameter:34 self @type:21 ConfigBuilder)
      (parameter:35 port @type u16)
      (return:36 @type:21 ConfigBuilder)
    )
  )
  (impl:37 ConfigBuilder @type:21 @trait:7
    (alias:38 Output)
    (method:39 build
      (parameter:40 self @type:21 ConfigBuilder)
      (return:41 @type:12 ServerConfig)
    )
  )
  (func:42 create_default_config
    (return:43 @type:3 Configurable)
    (@tdep:21 ConfigBuilder)
  )
)

--- expect:arch-graph ---
digraph architecture {
  // Layout settings
  rankdir=TB;
  ranksep=0.6;
  nodesep=0.3;
  splines=ortho;
  compound=true;

  node [shape=box, style=rounded];
  edge [arrowsize=0.7];

  label="architecture graph";
  labelloc=t;

  subgraph cluster_sample {
    label="sample";
    style=rounded;
    color="#888888";
    bgcolor="#f0f0f0";

    subgraph cluster_builder_rs {
      label="builder.rs";
      style=rounded;
      color="#aaaaaa";
      bgcolor="#fafafa";

      n21[label="ConfigBuilder", full_path="$TMP/sample/src/builder.rs:3", sym_ty="Struct", shape=box];
      n42[label="create_default_config", full_path="$TMP/sample/src/builder.rs:41", sym_ty="Function"];
    }

    subgraph cluster_config_rs {
      label="config.rs";
      style=rounded;
      color="#aaaaaa";
      bgcolor="#fafafa";

      n3[label="Configurable", full_path="$TMP/sample/src/config.rs:1", sym_ty="Trait", shape=box];
      n12[label="ServerConfig", full_path="$TMP/sample/src/config.rs:10", sym_ty="Struct", shape=box];
      n7[label="Buildable", full_path="$TMP/sample/src/config.rs:5", sym_ty="Trait", shape=box];
    }

  }


  n3 -> n12 [from="trait", to="impl"];
  n7 -> n21 [from="trait", to="impl"];
  n42 -> n3 [from="func", to="output"];
  n42 -> n21 [from="func", to="type_dep"];
}
