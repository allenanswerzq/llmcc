===============================================================================
basic-identifiers
===============================================================================


--- file: src/main.rs ---
abc;

--- expect:symbol-deps ---


===============================================================================
raw-identifiers
===============================================================================


--- file: src/main.rs ---
(r#abc as r#Def).r#ghi;

--- expect:symbol-deps ---


===============================================================================
unary-operator-expressions
===============================================================================


--- file: src/main.rs ---
-num;
!bits;
*boxed_thing;

--- expect:symbol-deps ---


===============================================================================
reference-expressions
===============================================================================


--- file: src/main.rs ---
&a;
&mut self.name;
&raw const b;
&raw mut self.age;

--- expect:symbol-deps ---


===============================================================================
try-expressions
===============================================================================


--- file: src/main.rs ---
a.unwrap()?;
&a?;

--- expect:symbol-deps ---


===============================================================================
binary-operator-expressions
===============================================================================


--- file: src/main.rs ---
a * b;
a / b;
a % b;
a + b;
a - b;
a >> b;
a << b;
a == b;
a && b;
a || b;

--- expect:symbol-deps ---


===============================================================================
grouped-expressions
===============================================================================


--- file: src/main.rs ---
(0);
(2 * (3 + 4));

--- expect:symbol-deps ---


===============================================================================
range-expressions
===============================================================================


--- file: src/main.rs ---
1..2;
3..;
..4;
..;
1..b;
a..b;
1..(1);
(1)..1;
(1)..(1);
1..{1};
for i in 1.. {
}

--- expect:symbol-deps ---


===============================================================================
assignment-expressions
===============================================================================


--- file: src/main.rs ---
x = y;

--- expect:symbol-deps ---


===============================================================================
compound-assignment-expressions
===============================================================================


--- file: src/main.rs ---
x += 1;
x += y;

--- expect:symbol-deps ---


===============================================================================
type-cast-expressions
===============================================================================


--- file: src/main.rs ---
struct Foo;
1000 as u8;
let character = integer as Foo;
let size: f64 = 1.0 + -len(values) as f64 + 1.0;

--- expect:symbol-deps ---
u0:14 <- [u0:25]
u0:23 <- [u0:24]
u0:24 -> [u0:23]
u0:25 -> [u0:14]


===============================================================================
call-expressions-basic
===============================================================================


--- file: src/main.rs ---
struct Foo;
struct Bar;
fn foo() {}
fn add(f: Foo, b: Bar) {}
fn func() {
  let f = Foo::new();
  let b: Bar = Bar::new(42);
  foo();
  add(f, b);
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                   | [global]
u0:2  | Primitive | i64    | i64                   | [global]
u0:3  | Primitive | i16    | i16                   | [global]
u0:4  | Primitive | i8     | i8                    | [global]
u0:5  | Primitive | i128   | i128                  | [global]
u0:6  | Primitive | isize  | isize                 | [global]
u0:7  | Primitive | u32    | u32                   | [global]
u0:8  | Primitive | u64    | u64                   | [global]
u0:9  | Primitive | u16    | u16                   | [global]
u0:10 | Primitive | u8     | u8                    | [global]
u0:11 | Primitive | u128   | u128                  | [global]
u0:12 | Primitive | usize  | usize                 | [global]
u0:13 | Primitive | f32    | f32                   | [global]
u0:14 | Primitive | f64    | f64                   | [global]
u0:15 | Primitive | bool   | bool                  | [global]
u0:16 | Primitive | char   | char                  | [global]
u0:17 | Primitive | str    | str                   | [global]
u0:18 | Primitive | String | String                | [global]
u0:19 | Crate     | _c     | _c                    | [global]
u0:20 | Crate     | crate  | _c::crate             |
u0:21 | Module    | _m     | _c::_m                |
u0:22 | File      | main   | _c::_m::main          |
u0:23 | Struct    | Foo    | _c::_m::main::Foo     |
u0:24 | Struct    | Bar    | _c::_m::main::Bar     |
u0:25 | Function  | foo    | _c::_m::main::foo     |
u0:26 | Function  | add    | _c::_m::main::add     |
u0:27 | Variable  | f      | _c::_m::main::add::f  |
u0:28 | Variable  | b      | _c::_m::main::add::b  |
u0:29 | Function  | func   | _c::_m::main::func    |
u0:30 | Variable  | f      | _c::_m::main::func::f |
u0:31 | Variable  | b      | _c::_m::main::func::b |

--- expect:symbol-deps ---
u0:23 <- [u0:26, u0:27]
u0:24 <- [u0:26, u0:28, u0:29, u0:31]
u0:25 <- [u0:29]
u0:26 -> [u0:23, u0:24]
u0:26 <- [u0:29]
u0:27 -> [u0:23]
u0:28 -> [u0:24]
u0:29 -> [u0:24, u0:25, u0:26]
u0:31 -> [u0:24]


===============================================================================
call-expressions-chained
===============================================================================


--- file: app/src/main.rs ---
struct Foo;
struct Bar;

struct AddResult;
struct ComputeResult;
impl AddResult {
    fn compute(self, b: Bar) -> ComputeResult {
        ComputeResult
    }
}
impl ComputeResult {
    fn finalize(self) {}
}
fn foo() {}
fn add(f: Foo) -> AddResult {
    AddResult
}
fn compute(b: Bar) -> ComputeResult {
    ComputeResult
}
fn finalize() {}

fn func() {
  let f = Foo::new();
  let b: Bar = Bar::new(42);
  foo();
  add(f).compute(b).finalize();
}

--- expect:symbols ---
u0:1  | Primitive | i32           | i32                                   | [global]
u0:2  | Primitive | i64           | i64                                   | [global]
u0:3  | Primitive | i16           | i16                                   | [global]
u0:4  | Primitive | i8            | i8                                    | [global]
u0:5  | Primitive | i128          | i128                                  | [global]
u0:6  | Primitive | isize         | isize                                 | [global]
u0:7  | Primitive | u32           | u32                                   | [global]
u0:8  | Primitive | u64           | u64                                   | [global]
u0:9  | Primitive | u16           | u16                                   | [global]
u0:10 | Primitive | u8            | u8                                    | [global]
u0:11 | Primitive | u128          | u128                                  | [global]
u0:12 | Primitive | usize         | usize                                 | [global]
u0:13 | Primitive | f32           | f32                                   | [global]
u0:14 | Primitive | f64           | f64                                   | [global]
u0:15 | Primitive | bool          | bool                                  | [global]
u0:16 | Primitive | char          | char                                  | [global]
u0:17 | Primitive | str           | str                                   | [global]
u0:18 | Primitive | String        | String                                | [global]
u0:19 | Crate     | _c            | _c                                    | [global]
u0:20 | Crate     | crate         | _c::crate                             |
u0:21 | Module    | _m            | _c::_m                                |
u0:22 | File      | main          | _c::_m::main                          |
u0:23 | Struct    | Foo           | _c::_m::main::Foo                     |
u0:24 | Struct    | Bar           | _c::_m::main::Bar                     |
u0:25 | Struct    | AddResult     | _c::_m::main::AddResult               |
u0:26 | Struct    | ComputeResult | _c::_m::main::ComputeResult           |
u0:27 | Function  | compute       | _c::_m::main::AddResult::compute      |
u0:28 | Variable  | b             | _c::_m::main::AddResult::compute::b   |
u0:29 | Function  | finalize      | _c::_m::main::ComputeResult::finalize |
u0:30 | Function  | foo           | _c::_m::main::foo                     |
u0:31 | Function  | add           | _c::_m::main::add                     |
u0:32 | Variable  | f             | _c::_m::main::add::f                  |
u0:33 | Function  | compute       | _c::_m::main::compute                 |
u0:34 | Variable  | b             | _c::_m::main::compute::b              |
u0:35 | Function  | finalize      | _c::_m::main::finalize                |
u0:36 | Function  | func          | _c::_m::main::func                    |
u0:37 | Variable  | f             | _c::_m::main::func::f                 |
u0:38 | Variable  | b             | _c::_m::main::func::b                 |

--- expect:symbol-deps ---
u0:23 <- [u0:31, u0:32]
u0:24 <- [u0:27, u0:28, u0:33, u0:34, u0:36, u0:38]
u0:25 -> [u0:26, u0:27]
u0:25 <- [u0:31]
u0:26 -> [u0:29]
u0:26 <- [u0:25, u0:27, u0:33]
u0:27 -> [u0:24, u0:26]
u0:27 <- [u0:25]
u0:28 -> [u0:24]
u0:29 <- [u0:26]
u0:30 <- [u0:36]
u0:31 -> [u0:23, u0:25]
u0:31 <- [u0:36]
u0:32 -> [u0:23]
u0:33 -> [u0:24, u0:26]
u0:33 <- [u0:36]
u0:34 -> [u0:24]
u0:35 <- [u0:36]
u0:36 -> [u0:24, u0:30, u0:31, u0:33, u0:35]
u0:38 -> [u0:24]

--- expect:blocks ---
u0:1  | root   | main
u0:2  | class  | Foo
u0:3  | class  | Bar
u0:4  | class  | AddResult
u0:5  | class  | ComputeResult
u0:6  | impl   | AddResult
u0:7  | method | compute
u0:8  | impl   | ComputeResult
u0:9  | method | finalize
u0:10 | func   | foo
u0:11 | func   | add
u0:12 | func   | compute
u0:13 | func   | finalize
u0:14 | func   | func

--- expect:block-deps ---
u0:10 <- [u0:14]
u0:11 -> [u0:2, u0:4]
u0:11 <- [u0:14]
u0:12 -> [u0:3, u0:5]
u0:12 <- [u0:14]
u0:13 <- [u0:14]
u0:14 -> [u0:10, u0:11, u0:12, u0:13, u0:3]
u0:2 <- [u0:11]
u0:3 <- [u0:12, u0:14, u0:7]
u0:4 -> [u0:5, u0:7]
u0:4 <- [u0:11]
u0:5 -> [u0:9]
u0:5 <- [u0:12, u0:4, u0:7]
u0:7 -> [u0:3, u0:5]
u0:7 <- [u0:4]
u0:9 <- [u0:5]

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Foo", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:1"];
    n10 [label="foo", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:14"];
    n11 [label="add", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:15"];
    n12 [label="compute", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:18"];
    n3 [label="Bar", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:2"];
    n13 [label="finalize", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:21"];
    n14 [label="func", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:23"];
    n4 [label="AddResult", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:4"];
    n5 [label="ComputeResult", full_path="/tmp/.tmpzVNZCK/app/src/main.rs:5"];
  }
  n11 -> n2;
  n11 -> n4;
  n12 -> n3;
  n12 -> n5;
  n14 -> n10;
  n14 -> n11;
  n14 -> n12;
  n14 -> n13;
  n4 -> n5;
}


===============================================================================
call-expressions-nested
===============================================================================


--- file: app/src/main.rs ---
struct Foo;
struct Bar;

struct AddResult;
struct ComputeResult;
impl AddResult {
    fn compute(self, b: Bar) -> ComputeResult {
        ComputeResult
    }
}
impl ComputeResult {
    fn finalize(self) {}
}
fn foo() {}
fn add(f: ComputeResult) -> AddResult {
    AddResult
}
fn compute(b: Bar) -> ComputeResult {
    ComputeResult
}

fn func() {
  let f = Foo::new();
  let b: Bar = Bar::new(42);
  foo();
  add(f, compute(b));
}

--- expect:symbols ---
u0:1  | Primitive | i32           | i32                                   | [global]
u0:2  | Primitive | i64           | i64                                   | [global]
u0:3  | Primitive | i16           | i16                                   | [global]
u0:4  | Primitive | i8            | i8                                    | [global]
u0:5  | Primitive | i128          | i128                                  | [global]
u0:6  | Primitive | isize         | isize                                 | [global]
u0:7  | Primitive | u32           | u32                                   | [global]
u0:8  | Primitive | u64           | u64                                   | [global]
u0:9  | Primitive | u16           | u16                                   | [global]
u0:10 | Primitive | u8            | u8                                    | [global]
u0:11 | Primitive | u128          | u128                                  | [global]
u0:12 | Primitive | usize         | usize                                 | [global]
u0:13 | Primitive | f32           | f32                                   | [global]
u0:14 | Primitive | f64           | f64                                   | [global]
u0:15 | Primitive | bool          | bool                                  | [global]
u0:16 | Primitive | char          | char                                  | [global]
u0:17 | Primitive | str           | str                                   | [global]
u0:18 | Primitive | String        | String                                | [global]
u0:19 | Crate     | _c            | _c                                    | [global]
u0:20 | Crate     | crate         | _c::crate                             |
u0:21 | Module    | _m            | _c::_m                                |
u0:22 | File      | main          | _c::_m::main                          |
u0:23 | Struct    | Foo           | _c::_m::main::Foo                     |
u0:24 | Struct    | Bar           | _c::_m::main::Bar                     |
u0:25 | Struct    | AddResult     | _c::_m::main::AddResult               |
u0:26 | Struct    | ComputeResult | _c::_m::main::ComputeResult           |
u0:27 | Function  | compute       | _c::_m::main::AddResult::compute      |
u0:28 | Variable  | b             | _c::_m::main::AddResult::compute::b   |
u0:29 | Function  | finalize      | _c::_m::main::ComputeResult::finalize |
u0:30 | Function  | foo           | _c::_m::main::foo                     |
u0:31 | Function  | add           | _c::_m::main::add                     |
u0:32 | Variable  | f             | _c::_m::main::add::f                  |
u0:33 | Function  | compute       | _c::_m::main::compute                 |
u0:34 | Variable  | b             | _c::_m::main::compute::b              |
u0:35 | Function  | func          | _c::_m::main::func                    |
u0:36 | Variable  | f             | _c::_m::main::func::f                 |
u0:37 | Variable  | b             | _c::_m::main::func::b                 |

--- expect:symbol-deps ---
u0:24 <- [u0:27, u0:28, u0:33, u0:34, u0:35, u0:37]
u0:25 -> [u0:26, u0:27]
u0:25 <- [u0:31]
u0:26 -> [u0:29]
u0:26 <- [u0:25, u0:27, u0:31, u0:32, u0:33]
u0:27 -> [u0:24, u0:26]
u0:27 <- [u0:25]
u0:28 -> [u0:24]
u0:29 <- [u0:26]
u0:30 <- [u0:35]
u0:31 -> [u0:25, u0:26, u0:33]
u0:31 <- [u0:35]
u0:32 -> [u0:26]
u0:33 -> [u0:24, u0:26]
u0:33 <- [u0:31, u0:35]
u0:34 -> [u0:24]
u0:35 -> [u0:24, u0:30, u0:31, u0:33]
u0:37 -> [u0:24]

--- expect:blocks ---
u0:1  | root   | main
u0:2  | class  | Foo
u0:3  | class  | Bar
u0:4  | class  | AddResult
u0:5  | class  | ComputeResult
u0:6  | impl   | AddResult
u0:7  | method | compute
u0:8  | impl   | ComputeResult
u0:9  | method | finalize
u0:10 | func   | foo
u0:11 | func   | add
u0:12 | func   | compute
u0:13 | func   | func

--- expect:block-deps ---
u0:10 <- [u0:13]
u0:11 -> [u0:12, u0:4, u0:5]
u0:11 <- [u0:13]
u0:12 -> [u0:3, u0:5]
u0:12 <- [u0:11, u0:13]
u0:13 -> [u0:10, u0:11, u0:12, u0:3]
u0:3 <- [u0:12, u0:13, u0:7]
u0:4 -> [u0:5, u0:7]
u0:4 <- [u0:11]
u0:5 -> [u0:9]
u0:5 <- [u0:11, u0:12, u0:4, u0:7]
u0:7 -> [u0:3, u0:5]
u0:7 <- [u0:4]
u0:9 <- [u0:5]

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n10 [label="foo", full_path="/tmp/.tmpsmOsFW/app/src/main.rs:14"];
    n11 [label="add", full_path="/tmp/.tmpsmOsFW/app/src/main.rs:15"];
    n12 [label="compute", full_path="/tmp/.tmpsmOsFW/app/src/main.rs:18"];
    n3 [label="Bar", full_path="/tmp/.tmpsmOsFW/app/src/main.rs:2"];
    n13 [label="func", full_path="/tmp/.tmpsmOsFW/app/src/main.rs:22"];
    n4 [label="AddResult", full_path="/tmp/.tmpsmOsFW/app/src/main.rs:4"];
    n5 [label="ComputeResult", full_path="/tmp/.tmpsmOsFW/app/src/main.rs:5"];
  }
  n11 -> n12;
  n11 -> n4;
  n12 -> n3;
  n12 -> n5;
  n13 -> n10;
  n13 -> n11;
  n4 -> n5;
}


===============================================================================
array-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Foo;

fn foo() {
  let a = Foo::new();
  [];
  let b = [1, a, 3];
  ["a", "b", "c"];
  [0; 128];
  [
      #[cfg(foo)]
      "foo",
      #[cfg(bar)]
      "bar",
  ];
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                  | [global]
u0:2  | Primitive | i64    | i64                  | [global]
u0:3  | Primitive | i16    | i16                  | [global]
u0:4  | Primitive | i8     | i8                   | [global]
u0:5  | Primitive | i128   | i128                 | [global]
u0:6  | Primitive | isize  | isize                | [global]
u0:7  | Primitive | u32    | u32                  | [global]
u0:8  | Primitive | u64    | u64                  | [global]
u0:9  | Primitive | u16    | u16                  | [global]
u0:10 | Primitive | u8     | u8                   | [global]
u0:11 | Primitive | u128   | u128                 | [global]
u0:12 | Primitive | usize  | usize                | [global]
u0:13 | Primitive | f32    | f32                  | [global]
u0:14 | Primitive | f64    | f64                  | [global]
u0:15 | Primitive | bool   | bool                 | [global]
u0:16 | Primitive | char   | char                 | [global]
u0:17 | Primitive | str    | str                  | [global]
u0:18 | Primitive | String | String               | [global]
u0:19 | Crate     | _c     | _c                   | [global]
u0:20 | Crate     | crate  | _c::crate            |
u0:21 | Module    | _m     | _c::_m               |
u0:22 | File      | main   | _c::_m::main         |
u0:23 | Struct    | Foo    | _c::_m::main::Foo    |
u0:24 | Function  | foo    | _c::_m::main::foo    |
u0:25 | Variable  | a      | _c::_m::main::foo::a |
u0:26 | Variable  | b      | _c::_m::main::foo::b |

--- expect:symbol-deps ---
u0:1 <- [u0:24, u0:26]
u0:24 -> [u0:1]
u0:26 -> [u0:1]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Foo
u0:3 | func  | foo

--- expect:block-deps ---


--- expect:graph ---
digraph project {
}


===============================================================================
tuple-expressions
===============================================================================


--- file: app/src/main.rs ---
struct TupleThing;

fn make_tuples() {
  let empty = ();
  let single = (TupleThing,);
  let triple = (TupleThing, 2, 3);
  let nested = ((1, 2), (3, 4));
  let destructured = match triple {
    (a, b, c) => (a, b, c),
  };
  let _all = (empty, single, nested, destructured);
}

--- expect:symbols ---
u0:1  | Primitive | i32          | i32                                     | [global]
u0:2  | Primitive | i64          | i64                                     | [global]
u0:3  | Primitive | i16          | i16                                     | [global]
u0:4  | Primitive | i8           | i8                                      | [global]
u0:5  | Primitive | i128         | i128                                    | [global]
u0:6  | Primitive | isize        | isize                                   | [global]
u0:7  | Primitive | u32          | u32                                     | [global]
u0:8  | Primitive | u64          | u64                                     | [global]
u0:9  | Primitive | u16          | u16                                     | [global]
u0:10 | Primitive | u8           | u8                                      | [global]
u0:11 | Primitive | u128         | u128                                    | [global]
u0:12 | Primitive | usize        | usize                                   | [global]
u0:13 | Primitive | f32          | f32                                     | [global]
u0:14 | Primitive | f64          | f64                                     | [global]
u0:15 | Primitive | bool         | bool                                    | [global]
u0:16 | Primitive | char         | char                                    | [global]
u0:17 | Primitive | str          | str                                     | [global]
u0:18 | Primitive | String       | String                                  | [global]
u0:19 | Crate     | _c           | _c                                      | [global]
u0:20 | Crate     | crate        | _c::crate                               |
u0:21 | Module    | _m           | _c::_m                                  |
u0:22 | File      | main         | _c::_m::main                            |
u0:23 | Struct    | TupleThing   | _c::_m::main::TupleThing                |
u0:24 | Function  | make_tuples  | _c::_m::main::make_tuples               |
u0:25 | Variable  | empty        | _c::_m::main::make_tuples::empty        |
u0:26 | Variable  | single       | _c::_m::main::make_tuples::single       |
u0:27 | Variable  | triple       | _c::_m::main::make_tuples::triple       |
u0:28 | Variable  | nested       | _c::_m::main::make_tuples::nested       |
u0:29 | Variable  | destructured | _c::_m::main::make_tuples::destructured |
u0:30 | Variable  | _all         | _c::_m::main::make_tuples::_all         |

--- expect:symbol-deps ---
u0:1 <- [u0:24, u0:28]
u0:23 <- [u0:24, u0:26, u0:27, u0:29]
u0:24 -> [u0:1, u0:23]
u0:26 -> [u0:23]
u0:27 -> [u0:23]
u0:28 -> [u0:1]
u0:29 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | TupleThing
u0:3 | func  | make_tuples

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="TupleThing", full_path="/tmp/.tmpMDZQxg/app/src/main.rs:1"];
    n3 [label="make_tuples", full_path="/tmp/.tmpMDZQxg/app/src/main.rs:3"];
  }
  n3 -> n2;
}


===============================================================================
struct-expressions
===============================================================================


--- file: app/src/main.rs ---
struct SomeStruct {
    field1: i32,
    field2: String,
    field3: f64,
}
struct NothingInMe;
struct Point {
    x: f64,
    y: f64,
}
mod game {
    pub struct User {
        pub name: &'static str,
        pub age: u8,
        pub score: u32,
    }
}

struct Instant(Duration);


fn func() {
  NothingInMe {};
  Point {x: 10.0, y: 20.0};
  let a = SomeStruct { field1, field2: expression, field3, };
  let u = game::User {name: "Joe", age: 35, score: 100_000};
  let i = Instant { 0: Duration::from_millis(0) };
}

--- expect:symbols ---
u0:1  | Primitive | i32         | i32                              | [global]
u0:2  | Primitive | i64         | i64                              | [global]
u0:3  | Primitive | i16         | i16                              | [global]
u0:4  | Primitive | i8          | i8                               | [global]
u0:5  | Primitive | i128        | i128                             | [global]
u0:6  | Primitive | isize       | isize                            | [global]
u0:7  | Primitive | u32         | u32                              | [global]
u0:8  | Primitive | u64         | u64                              | [global]
u0:9  | Primitive | u16         | u16                              | [global]
u0:10 | Primitive | u8          | u8                               | [global]
u0:11 | Primitive | u128        | u128                             | [global]
u0:12 | Primitive | usize       | usize                            | [global]
u0:13 | Primitive | f32         | f32                              | [global]
u0:14 | Primitive | f64         | f64                              | [global]
u0:15 | Primitive | bool        | bool                             | [global]
u0:16 | Primitive | char        | char                             | [global]
u0:17 | Primitive | str         | str                              | [global]
u0:18 | Primitive | String      | String                           | [global]
u0:19 | Crate     | _c          | _c                               | [global]
u0:20 | Crate     | crate       | _c::crate                        |
u0:21 | Module    | _m          | _c::_m                           |
u0:22 | File      | main        | _c::_m::main                     |
u0:23 | Struct    | SomeStruct  | _c::_m::main::SomeStruct         |
u0:24 | Field     | field1      | _c::_m::main::SomeStruct::field1 |
u0:25 | Field     | field2      | _c::_m::main::SomeStruct::field2 |
u0:26 | Field     | field3      | _c::_m::main::SomeStruct::field3 |
u0:27 | Struct    | NothingInMe | _c::_m::main::NothingInMe        |
u0:28 | Struct    | Point       | _c::_m::main::Point              |
u0:29 | Field     | x           | _c::_m::main::Point::x           |
u0:30 | Field     | y           | _c::_m::main::Point::y           |
u0:31 | Namespace | game        | _c::_m::main::game               |
u0:32 | Struct    | User        | _c::_m::main::game::User         | [global]
u0:33 | Field     | name        | _c::_m::main::game::User::name   |
u0:34 | Field     | age         | _c::_m::main::game::User::age    |
u0:35 | Field     | score       | _c::_m::main::game::User::score  |
u0:36 | Struct    | Instant     | _c::_m::main::Instant            |
u0:37 | Function  | func        | _c::_m::main::func               |
u0:38 | Variable  | a           | _c::_m::main::func::a            |
u0:39 | Variable  | u           | _c::_m::main::func::u            |
u0:40 | Variable  | i           | _c::_m::main::func::i            |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:24]
u0:10 <- [u0:32, u0:34]
u0:14 <- [u0:23, u0:26, u0:28, u0:29, u0:30]
u0:17 <- [u0:32]
u0:18 <- [u0:23, u0:25]
u0:23 -> [u0:1, u0:14, u0:18]
u0:23 <- [u0:37, u0:38]
u0:24 -> [u0:1]
u0:25 -> [u0:18]
u0:26 -> [u0:14]
u0:27 <- [u0:37]
u0:28 -> [u0:14]
u0:28 <- [u0:37]
u0:29 -> [u0:14]
u0:30 -> [u0:14]
u0:31 -> [u0:32]
u0:32 -> [u0:10, u0:17, u0:7]
u0:32 <- [u0:31, u0:37, u0:39]
u0:34 -> [u0:10]
u0:35 -> [u0:7]
u0:36 <- [u0:37, u0:40]
u0:37 -> [u0:23, u0:27, u0:28, u0:32, u0:36]
u0:38 -> [u0:23]
u0:39 -> [u0:32]
u0:40 -> [u0:36]
u0:7 <- [u0:32, u0:35]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | SomeStruct
u0:3 | class | NothingInMe
u0:4 | class | Point
u0:5 | class | User
u0:6 | class | Instant
u0:7 | func  | func

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="SomeStruct", full_path="/tmp/.tmp9CQxqp/app/src/main.rs:1"];
    n5 [label="User", full_path="/tmp/.tmp9CQxqp/app/src/main.rs:12"];
    n6 [label="Instant", full_path="/tmp/.tmp9CQxqp/app/src/main.rs:19"];
    n7 [label="func", full_path="/tmp/.tmp9CQxqp/app/src/main.rs:22"];
    n3 [label="NothingInMe", full_path="/tmp/.tmp9CQxqp/app/src/main.rs:6"];
    n4 [label="Point", full_path="/tmp/.tmp9CQxqp/app/src/main.rs:7"];
  }
  n7 -> n2;
  n7 -> n5;
  n7 -> n6;
  n7 -> n3;
  n7 -> n4;
}


===============================================================================
struct-expressions-with-update-initializers
===============================================================================


--- file: app/src/main.rs ---
struct User {
    id: u32,
    score: u32,
}

fn build_user(score: u32) -> User {
  let base = User { id: 1, score: 10 };
  User {
    score,
    ..base
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32        | i32                             | [global]
u0:2  | Primitive | i64        | i64                             | [global]
u0:3  | Primitive | i16        | i16                             | [global]
u0:4  | Primitive | i8         | i8                              | [global]
u0:5  | Primitive | i128       | i128                            | [global]
u0:6  | Primitive | isize      | isize                           | [global]
u0:7  | Primitive | u32        | u32                             | [global]
u0:8  | Primitive | u64        | u64                             | [global]
u0:9  | Primitive | u16        | u16                             | [global]
u0:10 | Primitive | u8         | u8                              | [global]
u0:11 | Primitive | u128       | u128                            | [global]
u0:12 | Primitive | usize      | usize                           | [global]
u0:13 | Primitive | f32        | f32                             | [global]
u0:14 | Primitive | f64        | f64                             | [global]
u0:15 | Primitive | bool       | bool                            | [global]
u0:16 | Primitive | char       | char                            | [global]
u0:17 | Primitive | str        | str                             | [global]
u0:18 | Primitive | String     | String                          | [global]
u0:19 | Crate     | _c         | _c                              | [global]
u0:20 | Crate     | crate      | _c::crate                       |
u0:21 | Module    | _m         | _c::_m                          |
u0:22 | File      | main       | _c::_m::main                    |
u0:23 | Struct    | User       | _c::_m::main::User              |
u0:24 | Field     | id         | _c::_m::main::User::id          |
u0:25 | Field     | score      | _c::_m::main::User::score       |
u0:26 | Function  | build_user | _c::_m::main::build_user        |
u0:27 | Variable  | score      | _c::_m::main::build_user::score |
u0:28 | Variable  | base       | _c::_m::main::build_user::base  |

--- expect:symbol-deps ---
u0:23 -> [u0:7]
u0:23 <- [u0:26, u0:28]
u0:24 -> [u0:7]
u0:25 -> [u0:7]
u0:26 -> [u0:23, u0:7]
u0:27 -> [u0:7]
u0:28 -> [u0:23]
u0:7 <- [u0:23, u0:24, u0:25, u0:26, u0:27]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | User
u0:3 | func  | build_user

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="User", full_path="/tmp/.tmp0FYHVC/app/src/main.rs:1"];
    n3 [label="build_user", full_path="/tmp/.tmp0FYHVC/app/src/main.rs:6"];
  }
  n3 -> n2;
}


===============================================================================
if-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Config {
  n: i32,
  x: i32,
}

fn main() {
  let cfg = Config { n: 1, x: 5 };
  if cfg.n == 1 {
  } else if cfg.n == 2 {
  } else {
  }

  let y = if cfg.x == 5 { 10 } else { 15 };

  if cfg.x > 0 && cfg.n > 0 {}

  if cfg.x > 0 || cfg.n > 0 {}
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                     | [global]
u0:2  | Primitive | i64    | i64                     | [global]
u0:3  | Primitive | i16    | i16                     | [global]
u0:4  | Primitive | i8     | i8                      | [global]
u0:5  | Primitive | i128   | i128                    | [global]
u0:6  | Primitive | isize  | isize                   | [global]
u0:7  | Primitive | u32    | u32                     | [global]
u0:8  | Primitive | u64    | u64                     | [global]
u0:9  | Primitive | u16    | u16                     | [global]
u0:10 | Primitive | u8     | u8                      | [global]
u0:11 | Primitive | u128   | u128                    | [global]
u0:12 | Primitive | usize  | usize                   | [global]
u0:13 | Primitive | f32    | f32                     | [global]
u0:14 | Primitive | f64    | f64                     | [global]
u0:15 | Primitive | bool   | bool                    | [global]
u0:16 | Primitive | char   | char                    | [global]
u0:17 | Primitive | str    | str                     | [global]
u0:18 | Primitive | String | String                  | [global]
u0:19 | Crate     | _c     | _c                      | [global]
u0:20 | Crate     | crate  | _c::crate               |
u0:21 | Module    | _m     | _c::_m                  |
u0:22 | File      | main   | _c::_m::main            |
u0:23 | Struct    | Config | _c::_m::main::Config    |
u0:24 | Field     | n      | _c::_m::main::Config::n |
u0:25 | Field     | x      | _c::_m::main::Config::x |
u0:26 | Function  | main   | _c::_m::main::main      |
u0:27 | Variable  | cfg    | _c::_m::main::main::cfg |
u0:28 | Variable  | y      | _c::_m::main::main::y   |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:24, u0:25, u0:26, u0:28]
u0:23 -> [u0:1]
u0:23 <- [u0:26, u0:27]
u0:24 -> [u0:1]
u0:25 -> [u0:1]
u0:26 -> [u0:1, u0:23]
u0:27 -> [u0:23]
u0:28 -> [u0:1]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Config
u0:3 | func  | main

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Config", full_path="/tmp/.tmpHRYYNJ/app/src/main.rs:1"];
    n3 [label="main", full_path="/tmp/.tmpHRYYNJ/app/src/main.rs:6"];
  }
  n3 -> n2;
}


===============================================================================
basic-if-let-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Guard {
  val: Option<i32>,
}

fn check() {
  let guard = Guard { val: Some(42) };
  if let Some(a) = guard.val
    && a > 0
  {
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                        | [global]
u0:2  | Primitive | i64    | i64                        | [global]
u0:3  | Primitive | i16    | i16                        | [global]
u0:4  | Primitive | i8     | i8                         | [global]
u0:5  | Primitive | i128   | i128                       | [global]
u0:6  | Primitive | isize  | isize                      | [global]
u0:7  | Primitive | u32    | u32                        | [global]
u0:8  | Primitive | u64    | u64                        | [global]
u0:9  | Primitive | u16    | u16                        | [global]
u0:10 | Primitive | u8     | u8                         | [global]
u0:11 | Primitive | u128   | u128                       | [global]
u0:12 | Primitive | usize  | usize                      | [global]
u0:13 | Primitive | f32    | f32                        | [global]
u0:14 | Primitive | f64    | f64                        | [global]
u0:15 | Primitive | bool   | bool                       | [global]
u0:16 | Primitive | char   | char                       | [global]
u0:17 | Primitive | str    | str                        | [global]
u0:18 | Primitive | String | String                     | [global]
u0:19 | Crate     | _c     | _c                         | [global]
u0:20 | Crate     | crate  | _c::crate                  |
u0:21 | Module    | _m     | _c::_m                     |
u0:22 | File      | main   | _c::_m::main               |
u0:23 | Struct    | Guard  | _c::_m::main::Guard        |
u0:24 | Field     | val    | _c::_m::main::Guard::val   |
u0:25 | Function  | check  | _c::_m::main::check        |
u0:26 | Variable  | guard  | _c::_m::main::check::guard |

--- expect:symbol-deps ---
u0:1 <- [u0:23]
u0:23 -> [u0:1]
u0:23 <- [u0:25, u0:26]
u0:25 -> [u0:23]
u0:26 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Guard
u0:3 | func  | check

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Guard", full_path="/tmp/.tmpqe11w6/app/src/main.rs:1"];
    n3 [label="check", full_path="/tmp/.tmpqe11w6/app/src/main.rs:5"];
  }
  n3 -> n2;
}


===============================================================================
if-let-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Dish;
fn parse() {
  let dish_opt = Some(Dish);
  if let Some(dish) = dish_opt {
  }

  if let Some("chained") = a && b && let (C, D) = e {
  }

  if foo && let bar = || baz && quux {}
  if a && let b = || c || d && e {}
}

--- expect:symbols ---
u0:1  | Primitive | i32      | i32                           | [global]
u0:2  | Primitive | i64      | i64                           | [global]
u0:3  | Primitive | i16      | i16                           | [global]
u0:4  | Primitive | i8       | i8                            | [global]
u0:5  | Primitive | i128     | i128                          | [global]
u0:6  | Primitive | isize    | isize                         | [global]
u0:7  | Primitive | u32      | u32                           | [global]
u0:8  | Primitive | u64      | u64                           | [global]
u0:9  | Primitive | u16      | u16                           | [global]
u0:10 | Primitive | u8       | u8                            | [global]
u0:11 | Primitive | u128     | u128                          | [global]
u0:12 | Primitive | usize    | usize                         | [global]
u0:13 | Primitive | f32      | f32                           | [global]
u0:14 | Primitive | f64      | f64                           | [global]
u0:15 | Primitive | bool     | bool                          | [global]
u0:16 | Primitive | char     | char                          | [global]
u0:17 | Primitive | str      | str                           | [global]
u0:18 | Primitive | String   | String                        | [global]
u0:19 | Crate     | _c       | _c                            | [global]
u0:20 | Crate     | crate    | _c::crate                     |
u0:21 | Module    | _m       | _c::_m                        |
u0:22 | File      | main     | _c::_m::main                  |
u0:23 | Struct    | Dish     | _c::_m::main::Dish            |
u0:24 | Function  | parse    | _c::_m::main::parse           |
u0:25 | Variable  | dish_opt | _c::_m::main::parse::dish_opt |

--- expect:symbol-deps ---
u0:23 <- [u0:24, u0:25]
u0:24 -> [u0:23]
u0:25 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Dish
u0:3 | func  | parse

--- expect:block-deps ---
u0:2 <- [u0:3]
u0:3 -> [u0:2]

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Dish", full_path="/private/var/folders/rk/clc9y9hn0m32mr3ls_j801kw0000gn/T/.tmp5DUxM2/app/src/main.rs:1"];
    n3 [label="parse", full_path="/private/var/folders/rk/clc9y9hn0m32mr3ls_j801kw0000gn/T/.tmp5DUxM2/app/src/main.rs:2"];
  }
  n3 -> n2;
}


===============================================================================
while-let-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Queue {
  items: Option<Vec<i32>>,
}

fn process() {
  let queue = Queue { items: Some(vec![]) };
  while let Some(items) = queue.items {
    let _ = items;
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32     | i32                          | [global]
u0:2  | Primitive | i64     | i64                          | [global]
u0:3  | Primitive | i16     | i16                          | [global]
u0:4  | Primitive | i8      | i8                           | [global]
u0:5  | Primitive | i128    | i128                         | [global]
u0:6  | Primitive | isize   | isize                        | [global]
u0:7  | Primitive | u32     | u32                          | [global]
u0:8  | Primitive | u64     | u64                          | [global]
u0:9  | Primitive | u16     | u16                          | [global]
u0:10 | Primitive | u8      | u8                           | [global]
u0:11 | Primitive | u128    | u128                         | [global]
u0:12 | Primitive | usize   | usize                        | [global]
u0:13 | Primitive | f32     | f32                          | [global]
u0:14 | Primitive | f64     | f64                          | [global]
u0:15 | Primitive | bool    | bool                         | [global]
u0:16 | Primitive | char    | char                         | [global]
u0:17 | Primitive | str     | str                          | [global]
u0:18 | Primitive | String  | String                       | [global]
u0:19 | Crate     | _c      | _c                           | [global]
u0:20 | Crate     | crate   | _c::crate                    |
u0:21 | Module    | _m      | _c::_m                       |
u0:22 | File      | main    | _c::_m::main                 |
u0:23 | Struct    | Queue   | _c::_m::main::Queue          |
u0:24 | Field     | items   | _c::_m::main::Queue::items   |
u0:25 | Function  | process | _c::_m::main::process        |
u0:26 | Variable  | queue   | _c::_m::main::process::queue |

--- expect:symbol-deps ---
u0:1 <- [u0:23]
u0:23 -> [u0:1]
u0:23 <- [u0:25, u0:26]
u0:25 -> [u0:23]
u0:26 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Queue
u0:3 | func  | process

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Queue", full_path="/tmp/.tmpxug0UT/app/src/main.rs:1"];
    n3 [label="process", full_path="/tmp/.tmpxug0UT/app/src/main.rs:5"];
  }
  n3 -> n2;
}


===============================================================================
match-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Value;

fn process_value() {
  let val = Value;
  match val {
    _ => {},
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32           | i32                              | [global]
u0:2  | Primitive | i64           | i64                              | [global]
u0:3  | Primitive | i16           | i16                              | [global]
u0:4  | Primitive | i8            | i8                               | [global]
u0:5  | Primitive | i128          | i128                             | [global]
u0:6  | Primitive | isize         | isize                            | [global]
u0:7  | Primitive | u32           | u32                              | [global]
u0:8  | Primitive | u64           | u64                              | [global]
u0:9  | Primitive | u16           | u16                              | [global]
u0:10 | Primitive | u8            | u8                               | [global]
u0:11 | Primitive | u128          | u128                             | [global]
u0:12 | Primitive | usize         | usize                            | [global]
u0:13 | Primitive | f32           | f32                              | [global]
u0:14 | Primitive | f64           | f64                              | [global]
u0:15 | Primitive | bool          | bool                             | [global]
u0:16 | Primitive | char          | char                             | [global]
u0:17 | Primitive | str           | str                              | [global]
u0:18 | Primitive | String        | String                           | [global]
u0:19 | Crate     | _c            | _c                               | [global]
u0:20 | Crate     | crate         | _c::crate                        |
u0:21 | Module    | _m            | _c::_m                           |
u0:22 | File      | main          | _c::_m::main                     |
u0:23 | Struct    | Value         | _c::_m::main::Value              |
u0:24 | Function  | process_value | _c::_m::main::process_value      |
u0:25 | Variable  | val           | _c::_m::main::process_value::val |

--- expect:symbol-deps ---
u0:23 <- [u0:24, u0:25]
u0:24 -> [u0:23]
u0:25 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Value
u0:3 | func  | process_value

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Value", full_path="/tmp/.tmpwhqF30/app/src/main.rs:1"];
    n3 [label="process_value", full_path="/tmp/.tmpwhqF30/app/src/main.rs:3"];
  }
  n3 -> n2;
}


===============================================================================
while-expressions
===============================================================================


--- file: app/src/main.rs ---
struct State {
  done: bool,
}

fn loop_until() {
  let state = State { done: false };
  while !state.done {
    let _ = state.done;
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32        | i32                             | [global]
u0:2  | Primitive | i64        | i64                             | [global]
u0:3  | Primitive | i16        | i16                             | [global]
u0:4  | Primitive | i8         | i8                              | [global]
u0:5  | Primitive | i128       | i128                            | [global]
u0:6  | Primitive | isize      | isize                           | [global]
u0:7  | Primitive | u32        | u32                             | [global]
u0:8  | Primitive | u64        | u64                             | [global]
u0:9  | Primitive | u16        | u16                             | [global]
u0:10 | Primitive | u8         | u8                              | [global]
u0:11 | Primitive | u128       | u128                            | [global]
u0:12 | Primitive | usize      | usize                           | [global]
u0:13 | Primitive | f32        | f32                             | [global]
u0:14 | Primitive | f64        | f64                             | [global]
u0:15 | Primitive | bool       | bool                            | [global]
u0:16 | Primitive | char       | char                            | [global]
u0:17 | Primitive | str        | str                             | [global]
u0:18 | Primitive | String     | String                          | [global]
u0:19 | Crate     | _c         | _c                              | [global]
u0:20 | Crate     | crate      | _c::crate                       |
u0:21 | Module    | _m         | _c::_m                          |
u0:22 | File      | main       | _c::_m::main                    |
u0:23 | Struct    | State      | _c::_m::main::State             |
u0:24 | Field     | done       | _c::_m::main::State::done       |
u0:25 | Function  | loop_until | _c::_m::main::loop_until        |
u0:26 | Variable  | state      | _c::_m::main::loop_until::state |

--- expect:symbol-deps ---
u0:15 <- [u0:23, u0:24, u0:25]
u0:23 -> [u0:15]
u0:23 <- [u0:25, u0:26]
u0:24 -> [u0:15]
u0:25 -> [u0:15, u0:23]
u0:26 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | State
u0:3 | func  | loop_until

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="State", full_path="/tmp/.tmpbV57T8/app/src/main.rs:1"];
    n3 [label="loop_until", full_path="/tmp/.tmpbV57T8/app/src/main.rs:5"];
  }
  n3 -> n2;
}


===============================================================================
loop-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Counter {
  limit: i32,
}

fn count() {
  let counter = Counter { limit: 10 };
  'outer: loop {
    'inner: loop {
      break 'outer;
    }
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32     | i32                          | [global]
u0:2  | Primitive | i64     | i64                          | [global]
u0:3  | Primitive | i16     | i16                          | [global]
u0:4  | Primitive | i8      | i8                           | [global]
u0:5  | Primitive | i128    | i128                         | [global]
u0:6  | Primitive | isize   | isize                        | [global]
u0:7  | Primitive | u32     | u32                          | [global]
u0:8  | Primitive | u64     | u64                          | [global]
u0:9  | Primitive | u16     | u16                          | [global]
u0:10 | Primitive | u8      | u8                           | [global]
u0:11 | Primitive | u128    | u128                         | [global]
u0:12 | Primitive | usize   | usize                        | [global]
u0:13 | Primitive | f32     | f32                          | [global]
u0:14 | Primitive | f64     | f64                          | [global]
u0:15 | Primitive | bool    | bool                         | [global]
u0:16 | Primitive | char    | char                         | [global]
u0:17 | Primitive | str     | str                          | [global]
u0:18 | Primitive | String  | String                       | [global]
u0:19 | Crate     | _c      | _c                           | [global]
u0:20 | Crate     | crate   | _c::crate                    |
u0:21 | Module    | _m      | _c::_m                       |
u0:22 | File      | main    | _c::_m::main                 |
u0:23 | Struct    | Counter | _c::_m::main::Counter        |
u0:24 | Field     | limit   | _c::_m::main::Counter::limit |
u0:25 | Function  | count   | _c::_m::main::count          |
u0:26 | Variable  | counter | _c::_m::main::count::counter |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:24]
u0:23 -> [u0:1]
u0:23 <- [u0:25, u0:26]
u0:24 -> [u0:1]
u0:25 -> [u0:23]
u0:26 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Counter
u0:3 | func  | count

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Counter", full_path="/tmp/.tmpoxR6Zq/app/src/main.rs:1"];
    n3 [label="count", full_path="/tmp/.tmpoxR6Zq/app/src/main.rs:5"];
  }
  n3 -> n2;
}


===============================================================================
for-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Container;

fn iterate() {
  let container = Container;
  for i in 0..10 {
    let _ = i;
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32       | i32                              | [global]
u0:2  | Primitive | i64       | i64                              | [global]
u0:3  | Primitive | i16       | i16                              | [global]
u0:4  | Primitive | i8        | i8                               | [global]
u0:5  | Primitive | i128      | i128                             | [global]
u0:6  | Primitive | isize     | isize                            | [global]
u0:7  | Primitive | u32       | u32                              | [global]
u0:8  | Primitive | u64       | u64                              | [global]
u0:9  | Primitive | u16       | u16                              | [global]
u0:10 | Primitive | u8        | u8                               | [global]
u0:11 | Primitive | u128      | u128                             | [global]
u0:12 | Primitive | usize     | usize                            | [global]
u0:13 | Primitive | f32       | f32                              | [global]
u0:14 | Primitive | f64       | f64                              | [global]
u0:15 | Primitive | bool      | bool                             | [global]
u0:16 | Primitive | char      | char                             | [global]
u0:17 | Primitive | str       | str                              | [global]
u0:18 | Primitive | String    | String                           | [global]
u0:19 | Crate     | _c        | _c                               | [global]
u0:20 | Crate     | crate     | _c::crate                        |
u0:21 | Module    | _m        | _c::_m                           |
u0:22 | File      | main      | _c::_m::main                     |
u0:23 | Struct    | Container | _c::_m::main::Container          |
u0:24 | Function  | iterate   | _c::_m::main::iterate            |
u0:25 | Variable  | container | _c::_m::main::iterate::container |

--- expect:symbol-deps ---
u0:23 <- [u0:24, u0:25]
u0:24 -> [u0:23]
u0:25 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Container
u0:3 | func  | iterate

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Container", full_path="/tmp/.tmp2ELXZY/app/src/main.rs:1"];
    n3 [label="iterate", full_path="/tmp/.tmp2ELXZY/app/src/main.rs:3"];
  }
  n3 -> n2;
}


===============================================================================
field-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Foo;
struct Far;
struct Baz {
  x: Far,
}

struct MyStruct {
  myfield: Foo,
}

fn foo() -> Baz {
  Baz
}

fn bar() {
  let mystruct = MyStruct { myfield: Foo };
  let x = mystruct.myfield;
  let y = foo().x;
  value.0.1.iter();
  1.max(2);
}

--- expect:symbols ---
u0:1  | Primitive | i32      | i32                             | [global]
u0:2  | Primitive | i64      | i64                             | [global]
u0:3  | Primitive | i16      | i16                             | [global]
u0:4  | Primitive | i8       | i8                              | [global]
u0:5  | Primitive | i128     | i128                            | [global]
u0:6  | Primitive | isize    | isize                           | [global]
u0:7  | Primitive | u32      | u32                             | [global]
u0:8  | Primitive | u64      | u64                             | [global]
u0:9  | Primitive | u16      | u16                             | [global]
u0:10 | Primitive | u8       | u8                              | [global]
u0:11 | Primitive | u128     | u128                            | [global]
u0:12 | Primitive | usize    | usize                           | [global]
u0:13 | Primitive | f32      | f32                             | [global]
u0:14 | Primitive | f64      | f64                             | [global]
u0:15 | Primitive | bool     | bool                            | [global]
u0:16 | Primitive | char     | char                            | [global]
u0:17 | Primitive | str      | str                             | [global]
u0:18 | Primitive | String   | String                          | [global]
u0:19 | Crate     | _c       | _c                              | [global]
u0:20 | Crate     | crate    | _c::crate                       |
u0:21 | Module    | _m       | _c::_m                          |
u0:22 | File      | main     | _c::_m::main                    |
u0:23 | Struct    | Foo      | _c::_m::main::Foo               |
u0:24 | Struct    | Far      | _c::_m::main::Far               |
u0:25 | Struct    | Baz      | _c::_m::main::Baz               |
u0:26 | Field     | x        | _c::_m::main::Baz::x            |
u0:27 | Struct    | MyStruct | _c::_m::main::MyStruct          |
u0:28 | Field     | myfield  | _c::_m::main::MyStruct::myfield |
u0:29 | Function  | foo      | _c::_m::main::foo               |
u0:30 | Function  | bar      | _c::_m::main::bar               |
u0:31 | Variable  | mystruct | _c::_m::main::bar::mystruct     |
u0:32 | Variable  | x        | _c::_m::main::bar::x            |
u0:33 | Variable  | y        | _c::_m::main::bar::y            |

--- expect:symbol-deps ---
u0:23 <- [u0:27, u0:28, u0:30, u0:32]
u0:24 <- [u0:25, u0:26, u0:30, u0:33]
u0:25 -> [u0:24]
u0:25 <- [u0:29]
u0:26 -> [u0:24]
u0:27 -> [u0:23]
u0:27 <- [u0:30, u0:31]
u0:28 -> [u0:23]
u0:29 -> [u0:25]
u0:29 <- [u0:30]
u0:30 -> [u0:23, u0:24, u0:27, u0:29]
u0:31 -> [u0:27]
u0:32 -> [u0:23]
u0:33 -> [u0:24]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Foo
u0:3 | class | Far
u0:4 | class | Baz
u0:5 | class | MyStruct
u0:6 | func  | foo
u0:7 | func  | bar

--- expect:block-deps ---
u0:2 <- [u0:5, u0:7]
u0:3 <- [u0:4, u0:7]
u0:4 -> [u0:3]
u0:4 <- [u0:6]
u0:5 -> [u0:2]
u0:5 <- [u0:7]
u0:6 -> [u0:4]
u0:6 <- [u0:7]
u0:7 -> [u0:2, u0:3, u0:5, u0:6]

--- expect:graph ---
digraph project {
  subgraph cluster_0 {
    label="todo";
    style=filled;
    color=lightgrey;
    n2 [label="Foo", full_path="/tmp/.tmpmhxtCN/app/src/main.rs:1"];
    n6 [label="foo", full_path="/tmp/.tmpmhxtCN/app/src/main.rs:11"];
    n7 [label="bar", full_path="/tmp/.tmpmhxtCN/app/src/main.rs:15"];
    n3 [label="Far", full_path="/tmp/.tmpmhxtCN/app/src/main.rs:2"];
    n4 [label="Baz", full_path="/tmp/.tmpmhxtCN/app/src/main.rs:3"];
    n5 [label="MyStruct", full_path="/tmp/.tmpmhxtCN/app/src/main.rs:7"];
  }
  n6 -> n4;
  n7 -> n6;
  n7 -> n5;
  n4 -> n3;
  n5 -> n2;
}


===============================================================================
method-call-expressions
===============================================================================


--- file: src/main.rs ---
struct Foo;

struct MyStruct;

impl MyStruct {
  fn foo(&self) -> Foo {}
}

fn func() {
    let mystruct = MyStruct;
    let x = mystruct.foo();
}

--- expect:symbols ---
u0:1  | Primitive | i32      | i32                          | [global]
u0:2  | Primitive | i64      | i64                          | [global]
u0:3  | Primitive | i16      | i16                          | [global]
u0:4  | Primitive | i8       | i8                           | [global]
u0:5  | Primitive | i128     | i128                         | [global]
u0:6  | Primitive | isize    | isize                        | [global]
u0:7  | Primitive | u32      | u32                          | [global]
u0:8  | Primitive | u64      | u64                          | [global]
u0:9  | Primitive | u16      | u16                          | [global]
u0:10 | Primitive | u8       | u8                           | [global]
u0:11 | Primitive | u128     | u128                         | [global]
u0:12 | Primitive | usize    | usize                        | [global]
u0:13 | Primitive | f32      | f32                          | [global]
u0:14 | Primitive | f64      | f64                          | [global]
u0:15 | Primitive | bool     | bool                         | [global]
u0:16 | Primitive | char     | char                         | [global]
u0:17 | Primitive | str      | str                          | [global]
u0:18 | Primitive | String   | String                       | [global]
u0:19 | Crate     | _c       | _c                           | [global]
u0:20 | Crate     | crate    | _c::crate                    |
u0:21 | Module    | _m       | _c::_m                       |
u0:22 | File      | main     | _c::_m::main                 |
u0:23 | Struct    | Foo      | _c::_m::main::Foo            |
u0:24 | Struct    | MyStruct | _c::_m::main::MyStruct       |
u0:25 | Function  | foo      | _c::_m::main::MyStruct::foo  |
u0:26 | Function  | func     | _c::_m::main::func           |
u0:27 | Variable  | mystruct | _c::_m::main::func::mystruct |
u0:28 | Variable  | x        | _c::_m::main::func::x        |

--- expect:symbol-deps ---
u0:23 <- [u0:24, u0:25, u0:26, u0:28]
u0:24 -> [u0:23, u0:25]
u0:24 <- [u0:26, u0:27]
u0:25 -> [u0:23]
u0:25 <- [u0:24, u0:26]
u0:26 -> [u0:23, u0:24, u0:25]
u0:27 -> [u0:24]
u0:28 -> [u0:23]


===============================================================================
index-expressions
===============================================================================


--- file: src/main.rs ---
struct Item;

fn func() {
    let arr: [Item; 4] = [Item, Item, Item, Item];
    let first = arr[0];
    let second = arr[1];
}

--- expect:symbols ---
u0:1  | Primitive | i32      | i32                       | [global]
u0:2  | Primitive | i64      | i64                       | [global]
u0:3  | Primitive | i16      | i16                       | [global]
u0:4  | Primitive | i8       | i8                        | [global]
u0:5  | Primitive | i128     | i128                      | [global]
u0:6  | Primitive | isize    | isize                     | [global]
u0:7  | Primitive | u32      | u32                       | [global]
u0:8  | Primitive | u64      | u64                       | [global]
u0:9  | Primitive | u16      | u16                       | [global]
u0:10 | Primitive | u8       | u8                        | [global]
u0:11 | Primitive | u128     | u128                      | [global]
u0:12 | Primitive | usize    | usize                     | [global]
u0:13 | Primitive | f32      | f32                       | [global]
u0:14 | Primitive | f64      | f64                       | [global]
u0:15 | Primitive | bool     | bool                      | [global]
u0:16 | Primitive | char     | char                      | [global]
u0:17 | Primitive | str      | str                       | [global]
u0:18 | Primitive | String   | String                    | [global]
u0:19 | Crate     | _c       | _c                        | [global]
u0:20 | Crate     | crate    | _c::crate                 |
u0:21 | Module    | _m       | _c::_m                    |
u0:22 | File      | main     | _c::_m::main              |
u0:23 | Struct    | Item     | _c::_m::main::Item        |
u0:24 | Function  | func     | _c::_m::main::func        |
u0:25 | Variable  | arr      | _c::_m::main::func::arr   |
u0:26 | Variable  | first    | _c::_m::main::func::first |
u0:27 | Variable  | second   | _c::_m::main::func::second|

--- expect:symbol-deps ---
u0:23 <- [u0:24, u0:25, u0:26, u0:27]
u0:24 -> [u0:23]
u0:25 -> [u0:23]
u0:26 -> [u0:23]
u0:27 -> [u0:23]


===============================================================================
scoped-functions
===============================================================================


--- file: app/src/foo.rs ---
pub fn f() {}

pub mod g {
  pub fn h() {}
}

--- file: app/src/main.rs ---
struct a;
impl a {
  fn b() {}
}

struct C<T>;
impl C<T> {
  fn e() {}
}

fn foo() {
  a::b();
  C::<D>::e();
  ::f();
  ::g::h();
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                | [global]
u0:2  | Primitive | i64    | i64                | [global]
u0:3  | Primitive | i16    | i16                | [global]
u0:4  | Primitive | i8     | i8                 | [global]
u0:5  | Primitive | i128   | i128               | [global]
u0:6  | Primitive | isize  | isize              | [global]
u0:7  | Primitive | u32    | u32                | [global]
u0:8  | Primitive | u64    | u64                | [global]
u0:9  | Primitive | u16    | u16                | [global]
u0:10 | Primitive | u8     | u8                 | [global]
u0:11 | Primitive | u128   | u128               | [global]
u0:12 | Primitive | usize  | usize              | [global]
u0:13 | Primitive | f32    | f32                | [global]
u0:14 | Primitive | f64    | f64                | [global]
u0:15 | Primitive | bool   | bool               | [global]
u0:16 | Primitive | char   | char               | [global]
u0:17 | Primitive | str    | str                | [global]
u0:18 | Primitive | String | String             | [global]
u0:19 | Crate     | _c     | _c                 | [global]
u0:20 | Crate     | crate  | _c::crate          |
u0:21 | Module    | _m     | _c::_m             |
u0:22 | File      | foo    | _c::_m::foo        |
u0:23 | Function      | f      | _c::_m::foo::f     | [global]
u0:24 | Namespace     | g      | _c::_m::foo::g     | [global]
u0:25 | Function      | h      | _c::_m::foo::g::h  | [global]
u1:26 | Crate         | crate  | _c::crate          |
u1:27 | Module        | _m     | _c::_m             |
u1:28 | File          | main   | _c::_m::main       |
u1:29 | Struct        | a      | _c::_m::main::a    |
u1:30 | Function      | b      | _c::_m::main::a::b |
u1:31 | Struct        | C      | _c::_m::main::C    |
u1:32 | TypeParameter | T      | _c::_m::main::C::T |
u1:33 | Function      | e      | _c::_m::main::C::e |
u1:34 | Function      | foo    | _c::_m::main::foo  |

--- expect:symbol-deps ---
u0:23 <- [u1:34]
u0:24 -> [u0:25]
u0:25 <- [u0:24, u1:34]
u1:29 -> [u1:30]
u1:30 <- [u1:29, u1:34]
u1:31 -> [u1:33]
u1:33 <- [u1:31, u1:34]
u1:34 -> [u0:23, u0:25, u1:30, u1:33]

--- expect:block-graph ---
(root:1 foo
    (func:2 f)
    (func:3 h)
)

(root:4 main
    (class:5 a)
    (impl:6 a
        (method:7 b)
    )
    (class:8 C)
    (impl:9 C
        (method:10 e)
    )
    (func:11 foo)
)

--- expect:block-deps ---
u0:2 <- [u1:11]
u0:3 <- [u1:11]
u1:10 <- [u1:11, u1:8]
u1:11 -> [u0:2, u0:3, u1:10, u1:7]
u1:5 -> [u1:7]
u1:7 <- [u1:11, u1:5]
u1:8 -> [u1:10]


===============================================================================
scoped-functions-with-fully-qualified-syntax
===============================================================================


--- file: src/main.rs ---
trait Animal {
    fn eat(&self);
}

struct Dog;
impl Dog {
  fn talk(&self) {}
}

impl Animal for Dog {
    fn eat(&self) {
      self.talk();
    }
}

fn foo(d: Dog) {
    <Dog as Animal>::eat(&d);
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                       | [global]
u0:2  | Primitive | i64    | i64                       | [global]
u0:3  | Primitive | i16    | i16                       | [global]
u0:4  | Primitive | i8     | i8                        | [global]
u0:5  | Primitive | i128   | i128                      | [global]
u0:6  | Primitive | isize  | isize                     | [global]
u0:7  | Primitive | u32    | u32                       | [global]
u0:8  | Primitive | u64    | u64                       | [global]
u0:9  | Primitive | u16    | u16                       | [global]
u0:10 | Primitive | u8     | u8                        | [global]
u0:11 | Primitive | u128   | u128                      | [global]
u0:12 | Primitive | usize  | usize                     | [global]
u0:13 | Primitive | f32    | f32                       | [global]
u0:14 | Primitive | f64    | f64                       | [global]
u0:15 | Primitive | bool   | bool                      | [global]
u0:16 | Primitive | char   | char                      | [global]
u0:17 | Primitive | str    | str                       | [global]
u0:18 | Primitive | String | String                    | [global]
u0:19 | Crate     | _c     | _c                        | [global]
u0:20 | Crate     | crate  | _c::crate                 |
u0:21 | Module    | _m     | _c::_m                    |
u0:22 | File      | main   | _c::_m::main              |
u0:23 | Trait     | Animal | _c::_m::main::Animal      |
u0:24 | Function  | eat    | _c::_m::main::Animal::eat |
u0:25 | Struct    | Dog    | _c::_m::main::Dog         |
u0:26 | Function  | talk   | _c::_m::main::Dog::talk   |
u0:27 | Function  | eat    | _c::_m::main::Dog::eat    |
u0:28 | Function  | foo    | _c::_m::main::foo         |
u0:29 | Variable  | d      | _c::_m::main::foo::d      |

--- expect:symbol-deps ---
u0:23 -> [u0:24]
u0:23 <- [u0:25]
u0:24 <- [u0:23]
u0:25 -> [u0:23, u0:26, u0:27]
u0:25 <- [u0:28, u0:29]
u0:26 <- [u0:25, u0:27]
u0:27 -> [u0:26]
u0:27 <- [u0:25, u0:28]
u0:28 -> [u0:25, u0:27]
u0:29 -> [u0:25]


===============================================================================
scoped-functions-with-macros-as-types
===============================================================================


--- file: src/main.rs ---
<Token![]>::foo();

--- expect:symbols ---
u0:1  | Primitive | i32    | i32          | [global]
u0:2  | Primitive | i64    | i64          | [global]
u0:3  | Primitive | i16    | i16          | [global]
u0:4  | Primitive | i8     | i8           | [global]
u0:5  | Primitive | i128   | i128         | [global]
u0:6  | Primitive | isize  | isize        | [global]
u0:7  | Primitive | u32    | u32          | [global]
u0:8  | Primitive | u64    | u64          | [global]
u0:9  | Primitive | u16    | u16          | [global]
u0:10 | Primitive | u8     | u8           | [global]
u0:11 | Primitive | u128   | u128         | [global]
u0:12 | Primitive | usize  | usize        | [global]
u0:13 | Primitive | f32    | f32          | [global]
u0:14 | Primitive | f64    | f64          | [global]
u0:15 | Primitive | bool   | bool         | [global]
u0:16 | Primitive | char   | char         | [global]
u0:17 | Primitive | str    | str          | [global]
u0:18 | Primitive | String | String       | [global]
u0:19 | Crate     | _c     | _c           | [global]
u0:20 | Crate     | crate  | _c::crate    |
u0:21 | Module    | _m     | _c::_m       |
u0:22 | File      | main   | _c::_m::main |

--- expect:symbol-deps ---


===============================================================================
scoped-identifier-with-nested-super
===============================================================================


--- file: src/main.rs ---
pub fn foo() {}
pub mod m1 {
  mod m2 {
    fn bar() {
      super::super::foo();
    }
}


--- expect:symbols ---
u0:1  | Primitive | i32    | i32                       | [global]
u0:2  | Primitive | i64    | i64                       | [global]
u0:3  | Primitive | i16    | i16                       | [global]
u0:4  | Primitive | i8     | i8                        | [global]
u0:5  | Primitive | i128   | i128                      | [global]
u0:6  | Primitive | isize  | isize                     | [global]
u0:7  | Primitive | u32    | u32                       | [global]
u0:8  | Primitive | u64    | u64                       | [global]
u0:9  | Primitive | u16    | u16                       | [global]
u0:10 | Primitive | u8     | u8                        | [global]
u0:11 | Primitive | u128   | u128                      | [global]
u0:12 | Primitive | usize  | usize                     | [global]
u0:13 | Primitive | f32    | f32                       | [global]
u0:14 | Primitive | f64    | f64                       | [global]
u0:15 | Primitive | bool   | bool                      | [global]
u0:16 | Primitive | char   | char                      | [global]
u0:17 | Primitive | str    | str                       | [global]
u0:18 | Primitive | String | String                    | [global]
u0:19 | Crate     | _c     | _c                        | [global]
u0:20 | Crate     | crate  | _c::crate                 |
u0:21 | Module    | _m     | _c::_m                    |
u0:22 | File      | main   | _c::_m::main              |
u0:23 | Function  | foo    | _c::_m::main::foo         | [global]
u0:24 | Namespace | m1     | _c::_m::main::m1          | [global]
u0:25 | Namespace | m2     | _c::_m::main::m1::m2      |
u0:26 | Function  | bar    | _c::_m::main::m1::m2::bar |

--- expect:symbol-deps ---
u0:23 <- [u0:26]
u0:24 -> [u0:25]
u0:25 -> [u0:26]
u0:25 <- [u0:24]
u0:26 -> [u0:23]
u0:26 <- [u0:25]

--- expect:blocks ---
u0:1 | root | main
u0:2 | func | foo
u0:3 | func | bar


===============================================================================
generic-functions
===============================================================================


--- file: src/main.rs ---
fn identity<T>(x: T) -> T {
    x
}

fn process<T, const N: usize>(arr: [T; N]) -> T {
    arr[0]
}

fn caller() {
    let a = identity::<i32>(42);
    let b = identity::<String>("hello".to_string());
    let c = process::<u8, 4>([1, 2, 3, 4]);
}

--- expect:symbols ---
u0:1  | Primitive     | i32      | i32                        | [global]
u0:2  | Primitive     | i64      | i64                        | [global]
u0:3  | Primitive     | i16      | i16                        | [global]
u0:4  | Primitive     | i8       | i8                         | [global]
u0:5  | Primitive     | i128     | i128                       | [global]
u0:6  | Primitive     | isize    | isize                      | [global]
u0:7  | Primitive     | u32      | u32                        | [global]
u0:8  | Primitive     | u64      | u64                        | [global]
u0:9  | Primitive     | u16      | u16                        | [global]
u0:10 | Primitive     | u8       | u8                         | [global]
u0:11 | Primitive     | u128     | u128                       | [global]
u0:12 | Primitive     | usize    | usize                      | [global]
u0:13 | Primitive     | f32      | f32                        | [global]
u0:14 | Primitive     | f64      | f64                        | [global]
u0:15 | Primitive     | bool     | bool                       | [global]
u0:16 | Primitive     | char     | char                       | [global]
u0:17 | Primitive     | str      | str                        | [global]
u0:18 | Primitive     | String   | String                     | [global]
u0:19 | Crate         | _c       | _c                         | [global]
u0:20 | Crate         | crate    | _c::crate                  |
u0:21 | Module        | _m       | _c::_m                     |
u0:22 | File          | main     | _c::_m::main               |
u0:23 | Function      | identity | _c::_m::main::identity     |
u0:24 | TypeParameter | T        | _c::_m::main::identity::T  |
u0:25 | Variable      | x        | _c::_m::main::identity::x  |
u0:26 | Function      | process  | _c::_m::main::process      |
u0:27 | TypeParameter | T        | _c::_m::main::process::T   |
u0:28 | Const         | N        | _c::_m::main::process::N   |
u0:29 | Variable      | arr      | _c::_m::main::process::arr |
u0:30 | Function      | caller   | _c::_m::main::caller       |
u0:31 | Variable      | a        | _c::_m::main::caller::a    |
u0:32 | Variable      | b        | _c::_m::main::caller::b    |
u0:33 | Variable      | c        | _c::_m::main::caller::c    |

--- expect:symbol-deps ---
u0:1 <- [u0:30]
u0:10 <- [u0:30]
u0:12 <- [u0:26, u0:28]
u0:23 <- [u0:30, u0:31, u0:32]
u0:26 -> [u0:12, u0:28]
u0:26 <- [u0:30, u0:33]
u0:28 -> [u0:12]
u0:28 <- [u0:26]
u0:30 -> [u0:1, u0:10, u0:23, u0:26]
u0:31 -> [u0:23]
u0:32 -> [u0:23]
u0:33 -> [u0:26]


===============================================================================
closures
===============================================================================


--- file: src/main.rs ---
fn apply<F: Fn(i32) -> i32>(f: F, x: i32) -> i32 {
    f(x)
}

fn transform(items: Vec<i32>) -> Vec<i32> {
    let factor = 2;
    items.into_iter().map(|x| x * factor).collect()
}

fn caller() {
    let add_one = |n: i32| n + 1;
    let result = apply(add_one, 5);

    let mul = |a, b| a * b;
    let product = mul(3, 4);

    let closure_with_block = |x| {
        let y = x + 1;
        y * 2
    };
}

--- expect:symbols ---
u0:1  | Primitive     | i32                | i32                                      | [global]
u0:2  | Primitive     | i64                | i64                                      | [global]
u0:3  | Primitive     | i16                | i16                                      | [global]
u0:4  | Primitive     | i8                 | i8                                       | [global]
u0:5  | Primitive     | i128               | i128                                     | [global]
u0:6  | Primitive     | isize              | isize                                    | [global]
u0:7  | Primitive     | u32                | u32                                      | [global]
u0:8  | Primitive     | u64                | u64                                      | [global]
u0:9  | Primitive     | u16                | u16                                      | [global]
u0:10 | Primitive     | u8                 | u8                                       | [global]
u0:11 | Primitive     | u128               | u128                                     | [global]
u0:12 | Primitive     | usize              | usize                                    | [global]
u0:13 | Primitive     | f32                | f32                                      | [global]
u0:14 | Primitive     | f64                | f64                                      | [global]
u0:15 | Primitive     | bool               | bool                                     | [global]
u0:16 | Primitive     | char               | char                                     | [global]
u0:17 | Primitive     | str                | str                                      | [global]
u0:18 | Primitive     | String             | String                                   | [global]
u0:19 | Crate         | _c                 | _c                                       | [global]
u0:20 | Crate         | crate              | _c::crate                                |
u0:21 | Module        | _m                 | _c::_m                                   |
u0:22 | File          | main               | _c::_m::main                             |
u0:23 | Function      | apply              | _c::_m::main::apply                      |
u0:24 | TypeParameter | F                  | _c::_m::main::apply::F                   |
u0:25 | Variable      | f                  | _c::_m::main::apply::f                   |
u0:26 | Variable      | x                  | _c::_m::main::apply::x                   |
u0:27 | Function      | transform          | _c::_m::main::transform                  |
u0:28 | Variable      | items              | _c::_m::main::transform::items           |
u0:29 | Variable      | factor             | _c::_m::main::transform::factor          |
u0:30 | Variable      | x                  | _c::_m::main::transform::x               |
u0:31 | Function      | caller             | _c::_m::main::caller                     |
u0:32 | Closure       | add_one            | _c::_m::main::caller::add_one            |
u0:33 | Variable      | n                  | _c::_m::main::caller::n                  |
u0:34 | Variable      | result             | _c::_m::main::caller::result             |
u0:35 | Closure       | mul                | _c::_m::main::caller::mul                |
u0:36 | Variable      | a                  | _c::_m::main::caller::a                  |
u0:37 | Variable      | b                  | _c::_m::main::caller::b                  |
u0:38 | Variable      | product            | _c::_m::main::caller::product            |
u0:39 | Closure       | closure_with_block | _c::_m::main::caller::closure_with_block |
u0:40 | Variable      | x                  | _c::_m::main::caller::x                  |
u0:41 | Variable      | y                  | _c::_m::main::caller::y                  |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:26, u0:27, u0:29, u0:31, u0:32, u0:33, u0:39, u0:41]
u0:23 -> [u0:1]
u0:23 <- [u0:31, u0:34]
u0:26 -> [u0:1]
u0:27 -> [u0:1]
u0:29 -> [u0:1]
u0:31 -> [u0:1, u0:23, u0:35]
u0:32 -> [u0:1]
u0:33 -> [u0:1]
u0:34 -> [u0:23]
u0:35 <- [u0:31, u0:38]
u0:38 -> [u0:35]
u0:39 -> [u0:1]
u0:41 -> [u0:1]


===============================================================================
closures-with-typed-parameters
===============================================================================


--- file: src/main.rs ---
fn process<F: Fn(i32) -> bool>(filter: F, items: Vec<i32>) -> Vec<i32> {
    items.into_iter().filter(|x| filter(*x)).collect()
}

fn caller() {
    let is_even = |n: i32| -> bool { n % 2 == 0 };
    let is_positive = |x: i32| x > 0;

    let items = vec![1, 2, 3, 4, 5];
    let evens = process(is_even, items.clone());
    let positives = process(is_positive, items);

    let with_multiple_params = |a: i32, b: i32, c: i32| -> i32 {
        a + b + c
    };
    let sum = with_multiple_params(1, 2, 3);
}

--- expect:symbols ---
u0:1  | Primitive     | i32                  | i32                                        | [global]
u0:2  | Primitive     | i64                  | i64                                        | [global]
u0:3  | Primitive     | i16                  | i16                                        | [global]
u0:4  | Primitive     | i8                   | i8                                         | [global]
u0:5  | Primitive     | i128                 | i128                                       | [global]
u0:6  | Primitive     | isize                | isize                                      | [global]
u0:7  | Primitive     | u32                  | u32                                        | [global]
u0:8  | Primitive     | u64                  | u64                                        | [global]
u0:9  | Primitive     | u16                  | u16                                        | [global]
u0:10 | Primitive     | u8                   | u8                                         | [global]
u0:11 | Primitive     | u128                 | u128                                       | [global]
u0:12 | Primitive     | usize                | usize                                      | [global]
u0:13 | Primitive     | f32                  | f32                                        | [global]
u0:14 | Primitive     | f64                  | f64                                        | [global]
u0:15 | Primitive     | bool                 | bool                                       | [global]
u0:16 | Primitive     | char                 | char                                       | [global]
u0:17 | Primitive     | str                  | str                                        | [global]
u0:18 | Primitive     | String               | String                                     | [global]
u0:19 | Crate         | _c                   | _c                                         | [global]
u0:20 | Crate         | crate                | _c::crate                                  |
u0:21 | Module        | _m                   | _c::_m                                     |
u0:22 | File          | main                 | _c::_m::main                               |
u0:23 | Function      | process              | _c::_m::main::process                      |
u0:24 | TypeParameter | F                    | _c::_m::main::process::F                   |
u0:25 | Variable      | filter               | _c::_m::main::process::filter              |
u0:26 | Variable      | items                | _c::_m::main::process::items               |
u0:27 | Variable      | x                    | _c::_m::main::process::x                   |
u0:28 | Function      | caller               | _c::_m::main::caller                       |
u0:29 | Closure       | is_even              | _c::_m::main::caller::is_even              |
u0:30 | Variable      | n                    | _c::_m::main::caller::n                    |
u0:31 | Closure       | is_positive          | _c::_m::main::caller::is_positive          |
u0:32 | Variable      | x                    | _c::_m::main::caller::x                    |
u0:33 | Variable      | items                | _c::_m::main::caller::items                |
u0:34 | Variable      | evens                | _c::_m::main::caller::evens                |
u0:35 | Variable      | positives            | _c::_m::main::caller::positives            |
u0:36 | Closure       | with_multiple_params | _c::_m::main::caller::with_multiple_params |
u0:37 | Variable      | a                    | _c::_m::main::caller::a                    |
u0:38 | Variable      | b                    | _c::_m::main::caller::b                    |
u0:39 | Variable      | c                    | _c::_m::main::caller::c                    |
u0:40 | Variable      | sum                  | _c::_m::main::caller::sum                  |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:28, u0:29, u0:30, u0:31, u0:32, u0:33, u0:36, u0:37, u0:38, u0:39, u0:40]
u0:15 <- [u0:23, u0:28]
u0:23 -> [u0:1, u0:15]
u0:23 <- [u0:28, u0:34, u0:35]
u0:28 -> [u0:1, u0:15, u0:23, u0:36]
u0:29 -> [u0:1]
u0:30 -> [u0:1]
u0:31 -> [u0:1]
u0:32 -> [u0:1]
u0:33 -> [u0:1]
u0:34 -> [u0:23]
u0:35 -> [u0:23]
u0:36 -> [u0:1]
u0:36 <- [u0:28]
u0:37 -> [u0:1]
u0:38 -> [u0:1]
u0:39 -> [u0:1]
u0:40 -> [u0:1]


===============================================================================
generators
===============================================================================


--- file: src/main.rs ---
fn create_counter(start: i32, end: i32) -> impl Iterator<Item = i32> {
    let mut i = start;
    move || {
        while i <= end {
            yield i;
            i += 1;
        }
    }
}

fn caller() {
    let counter = create_counter(0, 10);
    let gen = move || {
        yield 1;
        yield 2;
        return 3;
    };
}

--- expect:symbols ---
u0:1  | Primitive | i32            | i32                                 | [global]
u0:2  | Primitive | i64            | i64                                 | [global]
u0:3  | Primitive | i16            | i16                                 | [global]
u0:4  | Primitive | i8             | i8                                  | [global]
u0:5  | Primitive | i128           | i128                                | [global]
u0:6  | Primitive | isize          | isize                               | [global]
u0:7  | Primitive | u32            | u32                                 | [global]
u0:8  | Primitive | u64            | u64                                 | [global]
u0:9  | Primitive | u16            | u16                                 | [global]
u0:10 | Primitive | u8             | u8                                  | [global]
u0:11 | Primitive | u128           | u128                                | [global]
u0:12 | Primitive | usize          | usize                               | [global]
u0:13 | Primitive | f32            | f32                                 | [global]
u0:14 | Primitive | f64            | f64                                 | [global]
u0:15 | Primitive | bool           | bool                                | [global]
u0:16 | Primitive | char           | char                                | [global]
u0:17 | Primitive | str            | str                                 | [global]
u0:18 | Primitive | String         | String                              | [global]
u0:19 | Crate     | _c             | _c                                  | [global]
u0:20 | Crate     | crate          | _c::crate                           |
u0:21 | Module    | _m             | _c::_m                              |
u0:22 | File      | main           | _c::_m::main                        |
u0:23 | Function  | create_counter | _c::_m::main::create_counter        |
u0:24 | Variable  | start          | _c::_m::main::create_counter::start |
u0:25 | Variable  | end            | _c::_m::main::create_counter::end   |
u0:26 | Variable  | i              | _c::_m::main::create_counter::i     |
u0:27 | Function  | caller         | _c::_m::main::caller                |
u0:28 | Variable  | counter        | _c::_m::main::caller::counter       |
u0:29 | Closure   | gen            | _c::_m::main::caller::gen           |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:24, u0:25, u0:26, u0:27, u0:29]
u0:23 -> [u0:1]
u0:23 <- [u0:27, u0:28]
u0:24 -> [u0:1]
u0:25 -> [u0:1]
u0:26 -> [u0:1]
u0:27 -> [u0:1, u0:23]
u0:28 -> [u0:23]
u0:29 -> [u0:1]


===============================================================================
unsafe-blocks
===============================================================================


--- file: src/main.rs ---
unsafe fn dangerous() -> i32 { 42 }

fn safe_wrapper() -> i32 {
    unsafe { dangerous() }
}

static mut COUNTER: i32 = 0;

fn increment_counter() {
    unsafe {
        COUNTER += 1;
    }
}

fn read_counter() -> i32 {
    unsafe { COUNTER }
}

fn with_raw_pointers() {
    let x = 10;
    let ptr = &x as *const i32;
    unsafe {
        let val = *ptr;
    }
}

--- expect:symbols ---
u0:1  | Primitive | i32               | i32                                  | [global]
u0:2  | Primitive | i64               | i64                                  | [global]
u0:3  | Primitive | i16               | i16                                  | [global]
u0:4  | Primitive | i8                | i8                                   | [global]
u0:5  | Primitive | i128              | i128                                 | [global]
u0:6  | Primitive | isize             | isize                                | [global]
u0:7  | Primitive | u32               | u32                                  | [global]
u0:8  | Primitive | u64               | u64                                  | [global]
u0:9  | Primitive | u16               | u16                                  | [global]
u0:10 | Primitive | u8                | u8                                   | [global]
u0:11 | Primitive | u128              | u128                                 | [global]
u0:12 | Primitive | usize             | usize                                | [global]
u0:13 | Primitive | f32               | f32                                  | [global]
u0:14 | Primitive | f64               | f64                                  | [global]
u0:15 | Primitive | bool              | bool                                 | [global]
u0:16 | Primitive | char              | char                                 | [global]
u0:17 | Primitive | str               | str                                  | [global]
u0:18 | Primitive | String            | String                               | [global]
u0:19 | Crate     | _c                | _c                                   | [global]
u0:20 | Crate     | crate             | _c::crate                            |
u0:21 | Module    | _m                | _c::_m                               |
u0:22 | File      | main              | _c::_m::main                         |
u0:23 | Function  | dangerous         | _c::_m::main::dangerous              |
u0:24 | Function  | safe_wrapper      | _c::_m::main::safe_wrapper           |
u0:25 | Static    | COUNTER           | _c::_m::main::COUNTER                |
u0:26 | Function  | increment_counter | _c::_m::main::increment_counter      |
u0:27 | Function  | read_counter      | _c::_m::main::read_counter           |
u0:28 | Function  | with_raw_pointers | _c::_m::main::with_raw_pointers      |
u0:29 | Variable  | x                 | _c::_m::main::with_raw_pointers::x   |
u0:30 | Variable  | ptr               | _c::_m::main::with_raw_pointers::ptr |
u0:31 | Variable  | val               | _c::_m::main::with_raw_pointers::val |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:24, u0:25, u0:27, u0:28, u0:29, u0:30, u0:31]
u0:23 -> [u0:1]
u0:23 <- [u0:24]
u0:24 -> [u0:1, u0:23]
u0:25 -> [u0:1]
u0:25 <- [u0:26, u0:27]
u0:26 -> [u0:25]
u0:27 -> [u0:1, u0:25]
u0:28 -> [u0:1]
u0:29 -> [u0:1]
u0:30 -> [u0:1]
u0:31 -> [u0:1]


===============================================================================
inline-const-or-const-blocks-as-expression
===============================================================================


--- file: src/main.rs ---
fn compute_at_compile_time() {
    // Simple const block
    let sum = const { 1 + 2 + 3 };

    // Const block in array repeat expression
    let powers: [i32; 4] = [const { 2_i32.pow(10) }; 4];

    // Const block for complex compile-time computation
    let factorial_5 = const {
        let mut result = 1;
        let mut i = 1;
        while i <= 5 {
            result *= i;
            i += 1;
        }
        result
    };

    // Const block in conditional
    let max_size = if true { const { 1024 } } else { const { 512 } };
}

const ARRAY_SIZE: usize = const { 10 * 10 };

static PRECOMPUTED: i32 = const { 7 * 8 };

--- expect:symbols ---
u0:1  | Primitive | i32                     | i32                                                | [global]
u0:2  | Primitive | i64                     | i64                                                | [global]
u0:3  | Primitive | i16                     | i16                                                | [global]
u0:4  | Primitive | i8                      | i8                                                 | [global]
u0:5  | Primitive | i128                    | i128                                               | [global]
u0:6  | Primitive | isize                   | isize                                              | [global]
u0:7  | Primitive | u32                     | u32                                                | [global]
u0:8  | Primitive | u64                     | u64                                                | [global]
u0:9  | Primitive | u16                     | u16                                                | [global]
u0:10 | Primitive | u8                      | u8                                                 | [global]
u0:11 | Primitive | u128                    | u128                                               | [global]
u0:12 | Primitive | usize                   | usize                                              | [global]
u0:13 | Primitive | f32                     | f32                                                | [global]
u0:14 | Primitive | f64                     | f64                                                | [global]
u0:15 | Primitive | bool                    | bool                                               | [global]
u0:16 | Primitive | char                    | char                                               | [global]
u0:17 | Primitive | str                     | str                                                | [global]
u0:18 | Primitive | String                  | String                                             | [global]
u0:19 | Crate     | _c                      | _c                                                 | [global]
u0:20 | Crate     | crate                   | _c::crate                                          |
u0:21 | Module    | _m                      | _c::_m                                             |
u0:22 | File      | main                    | _c::_m::main                                       |
u0:23 | Function  | compute_at_compile_time | _c::_m::main::compute_at_compile_time              |
u0:24 | Variable  | sum                     | _c::_m::main::compute_at_compile_time::sum         |
u0:25 | Variable  | powers                  | _c::_m::main::compute_at_compile_time::powers      |
u0:26 | Variable  | factorial_5             | _c::_m::main::compute_at_compile_time::factorial_5 |
u0:27 | Variable  | result                  | _c::_m::main::compute_at_compile_time::result      |
u0:28 | Variable  | i                       | _c::_m::main::compute_at_compile_time::i           |
u0:29 | Variable  | max_size                | _c::_m::main::compute_at_compile_time::max_size    |
u0:30 | Const     | ARRAY_SIZE              | _c::_m::main::ARRAY_SIZE                           |
u0:31 | Static    | PRECOMPUTED             | _c::_m::main::PRECOMPUTED                          |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:24, u0:25, u0:27, u0:28, u0:29, u0:31]
u0:12 <- [u0:30]
u0:23 -> [u0:1]
u0:24 -> [u0:1]
u0:25 -> [u0:1]
u0:27 -> [u0:1]
u0:28 -> [u0:1]
u0:29 -> [u0:1]
u0:30 -> [u0:12]
u0:31 -> [u0:1]


===============================================================================
raw-reference-expression-conflicts
===============================================================================


--- file: src/main.rs ---
// Test that `raw` as an identifier doesn't conflict with raw pointer syntax
fn some_call<T>(x: T) {}

fn test_raw_identifier() {
    let raw = 42;
    some_call(&raw);  // &raw is a reference to the variable `raw`
}

fn test_raw_pointer_const() {
    let value = 100;
    let ptr: *const i32 = &raw const value;  // raw pointer to immutable
    unsafe {
        let read_value = *ptr;
    }
}

fn test_raw_pointer_mut() {
    let mut value = 100;
    let ptr: *mut i32 = &raw mut value;  // raw pointer to mutable
    unsafe {
        *ptr = 200;
    }
}

fn test_both_syntaxes() {
    let raw = 50;          // variable named `raw`
    let other = 60;

    let ref_to_raw = &raw;              // reference to variable `raw`
    let ptr_to_other = &raw const other; // raw pointer to `other`
}

--- expect:symbols ---
u0:1  | Primitive     | i32                    | i32                                              | [global]
u0:2  | Primitive     | i64                    | i64                                              | [global]
u0:3  | Primitive     | i16                    | i16                                              | [global]
u0:4  | Primitive     | i8                     | i8                                               | [global]
u0:5  | Primitive     | i128                   | i128                                             | [global]
u0:6  | Primitive     | isize                  | isize                                            | [global]
u0:7  | Primitive     | u32                    | u32                                              | [global]
u0:8  | Primitive     | u64                    | u64                                              | [global]
u0:9  | Primitive     | u16                    | u16                                              | [global]
u0:10 | Primitive     | u8                     | u8                                               | [global]
u0:11 | Primitive     | u128                   | u128                                             | [global]
u0:12 | Primitive     | usize                  | usize                                            | [global]
u0:13 | Primitive     | f32                    | f32                                              | [global]
u0:14 | Primitive     | f64                    | f64                                              | [global]
u0:15 | Primitive     | bool                   | bool                                             | [global]
u0:16 | Primitive     | char                   | char                                             | [global]
u0:17 | Primitive     | str                    | str                                              | [global]
u0:18 | Primitive     | String                 | String                                           | [global]
u0:19 | Crate         | _c                     | _c                                               | [global]
u0:20 | Crate         | crate                  | _c::crate                                        |         
u0:21 | Module        | _m                     | _c::_m                                           |         
u0:22 | File          | main                   | _c::_m::main                                     |         
u0:23 | Function      | some_call              | _c::_m::main::some_call                          |         
u0:24 | TypeParameter | T                      | _c::_m::main::some_call::T                       |         
u0:25 | Variable      | x                      | _c::_m::main::some_call::x                       |         
u0:26 | Function      | test_raw_identifier    | _c::_m::main::test_raw_identifier                |         
u0:27 | Variable      | raw                    | _c::_m::main::test_raw_identifier::raw           |         
u0:28 | Function      | test_raw_pointer_const | _c::_m::main::test_raw_pointer_const             |         
u0:29 | Variable      | value                  | _c::_m::main::test_raw_pointer_const::value      |         
u0:30 | Variable      | ptr                    | _c::_m::main::test_raw_pointer_const::ptr        |         
u0:31 | Variable      | read_value             | _c::_m::main::test_raw_pointer_const::read_value |         
u0:32 | Function      | test_raw_pointer_mut   | _c::_m::main::test_raw_pointer_mut               |         
u0:33 | Variable      | value                  | _c::_m::main::test_raw_pointer_mut::value        |         
u0:34 | Variable      | ptr                    | _c::_m::main::test_raw_pointer_mut::ptr          |         
u0:35 | Function      | test_both_syntaxes     | _c::_m::main::test_both_syntaxes                 |         
u0:36 | Variable      | raw                    | _c::_m::main::test_both_syntaxes::raw            |         
u0:37 | Variable      | other                  | _c::_m::main::test_both_syntaxes::other          |         
u0:38 | Variable      | ref_to_raw             | _c::_m::main::test_both_syntaxes::ref_to_raw     |         
u0:39 | Variable      | ptr_to_other           | _c::_m::main::test_both_syntaxes::ptr_to_other   |         

--- expect:symbol-deps ---
u0:1 <- [u0:26, u0:27, u0:28, u0:29, u0:30, u0:31, u0:32, u0:33, u0:34, u0:35, u0:36, u0:37, u0:39]
u0:23 <- [u0:26]
u0:26 -> [u0:1, u0:23]
u0:27 -> [u0:1]
u0:28 -> [u0:1]
u0:29 -> [u0:1]
u0:30 -> [u0:1]
u0:31 -> [u0:1]
u0:32 -> [u0:1]
u0:33 -> [u0:1]
u0:34 -> [u0:1]
u0:35 -> [u0:1]
u0:36 -> [u0:1]
u0:37 -> [u0:1]
u0:39 -> [u0:1]
