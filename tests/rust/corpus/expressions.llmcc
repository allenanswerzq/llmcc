===============================================================================
basic-identifiers
===============================================================================


--- file: src/main.rs ---
abc;

--- expect:symbol-deps ---


===============================================================================
raw-identifiers
===============================================================================


--- file: src/main.rs ---
(r#abc as r#Def).r#ghi;

--- expect:symbol-deps ---


===============================================================================
unary-operator-expressions
===============================================================================


--- file: src/main.rs ---
-num;
!bits;
*boxed_thing;

--- expect:symbol-deps ---


===============================================================================
reference-expressions
===============================================================================


--- file: src/main.rs ---
&a;
&mut self.name;
&raw const b;
&raw mut self.age;

--- expect:symbol-deps ---


===============================================================================
try-expressions
===============================================================================


--- file: src/main.rs ---
a.unwrap()?;
&a?;

--- expect:symbol-deps ---


===============================================================================
binary-operator-expressions
===============================================================================


--- file: src/main.rs ---
a * b;
a / b;
a % b;
a + b;
a - b;
a >> b;
a << b;
a == b;
a && b;
a || b;

--- expect:symbol-deps ---


===============================================================================
grouped-expressions
===============================================================================


--- file: src/main.rs ---
(0);
(2 * (3 + 4));

--- expect:symbol-deps ---


===============================================================================
range-expressions
===============================================================================


--- file: src/main.rs ---
1..2;
3..;
..4;
..;
1..b;
a..b;
1..(1);
(1)..1;
(1)..(1);
1..{1};
for i in 1.. {
}

--- expect:symbol-deps ---


===============================================================================
assignment-expressions
===============================================================================


--- file: src/main.rs ---
x = y;

--- expect:symbol-deps ---


===============================================================================
compound-assignment-expressions
===============================================================================


--- file: src/main.rs ---
x += 1;
x += y;

--- expect:symbol-deps ---


===============================================================================
type-cast-expressions
===============================================================================


--- file: src/main.rs ---
struct Foo;
1000 as u8;
let character = integer as Foo;
let size: f64 = 1.0 + -len(values) as f64 + 1.0;

--- expect:symbol-deps ---
u0:14 <- [u0:24]
u0:22 <- [u0:23]
u0:23 -> [u0:22]
u0:24 -> [u0:14]


===============================================================================
call-expressions-basic
===============================================================================


--- file: src/main.rs ---
struct Foo;
struct Bar;
fn foo() {}
fn add(f: Foo, b: Bar) {}
fn func() {
  let f = Foo::new();
  let b: Bar = Bar::new(42);
  foo();
  add(f, b);
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32               | [global]
u0:2  | Primitive | i64    | i64               | [global]
u0:3  | Primitive | i16    | i16               | [global]
u0:4  | Primitive | i8     | i8                | [global]
u0:5  | Primitive | i128   | i128              | [global]
u0:6  | Primitive | isize  | isize             | [global]
u0:7  | Primitive | u32    | u32               | [global]
u0:8  | Primitive | u64    | u64               | [global]
u0:9  | Primitive | u16    | u16               | [global]
u0:10 | Primitive | u8     | u8                | [global]
u0:11 | Primitive | u128   | u128              | [global]
u0:12 | Primitive | usize  | usize             | [global]
u0:13 | Primitive | f32    | f32               | [global]
u0:14 | Primitive | f64    | f64               | [global]
u0:15 | Primitive | bool   | bool              | [global]
u0:16 | Primitive | char   | char              | [global]
u0:17 | Primitive | str    | str               | [global]
u0:18 | Primitive | String | String            | [global]
u0:19 | Crate     | _c     | _c                | [global]
u0:20 | Crate     | crate  | _c::crate         |         
u0:21 | File      | main   | _c::main          |         
u0:22 | Struct    | Foo    | _c::main::Foo     |         
u0:23 | Struct    | Bar    | _c::main::Bar     |         
u0:24 | Function  | foo    | _c::main::foo     |         
u0:25 | Function  | add    | _c::main::add     |         
u0:26 | Variable  | f      | _c::main::add::f  |         
u0:27 | Variable  | b      | _c::main::add::b  |         
u0:28 | Function  | func   | _c::main::func    |         
u0:29 | Variable  | f      | _c::main::func::f |         
u0:30 | Variable  | b      | _c::main::func::b |         

--- expect:symbol-deps ---
u0:22 <- [u0:25, u0:26, u0:28]
u0:23 <- [u0:25, u0:27, u0:28, u0:30]
u0:24 <- [u0:28]
u0:25 -> [u0:22, u0:23]
u0:25 <- [u0:28]
u0:26 -> [u0:22]
u0:27 -> [u0:23]
u0:28 -> [u0:22, u0:23, u0:24, u0:25]
u0:30 -> [u0:23]


===============================================================================
call-expressions-chained
===============================================================================


--- file: app/src/main.rs ---
struct Foo;
struct Bar;

struct AddResult;
struct ComputeResult;
impl AddResult {
    fn compute(self, b: Bar) -> ComputeResult {
        ComputeResult
    }
}
impl ComputeResult {
    fn finalize(self) {}
}
fn foo() {}
fn add(f: Foo) -> AddResult {
    AddResult
}
fn compute(b: Bar) -> ComputeResult {
    ComputeResult
}
fn finalize() {}

fn func() {
  let f = Foo::new();
  let b: Bar = Bar::new(42);
  foo();
  add(f).compute(b).finalize();
}

--- expect:symbols ---
u0:1  | Primitive | i32           | i32                               | [global]
u0:2  | Primitive | i64           | i64                               | [global]
u0:3  | Primitive | i16           | i16                               | [global]
u0:4  | Primitive | i8            | i8                                | [global]
u0:5  | Primitive | i128          | i128                              | [global]
u0:6  | Primitive | isize         | isize                             | [global]
u0:7  | Primitive | u32           | u32                               | [global]
u0:8  | Primitive | u64           | u64                               | [global]
u0:9  | Primitive | u16           | u16                               | [global]
u0:10 | Primitive | u8            | u8                                | [global]
u0:11 | Primitive | u128          | u128                              | [global]
u0:12 | Primitive | usize         | usize                             | [global]
u0:13 | Primitive | f32           | f32                               | [global]
u0:14 | Primitive | f64           | f64                               | [global]
u0:15 | Primitive | bool          | bool                              | [global]
u0:16 | Primitive | char          | char                              | [global]
u0:17 | Primitive | str           | str                               | [global]
u0:18 | Primitive | String        | String                            | [global]
u0:19 | Crate     | _c            | _c                                | [global]
u0:20 | Crate     | crate         | _c::crate                         |         
u0:21 | File      | main          | _c::main                          |         
u0:22 | Struct    | Foo           | _c::main::Foo                     |         
u0:23 | Struct    | Bar           | _c::main::Bar                     |         
u0:24 | Struct    | AddResult     | _c::main::AddResult               |         
u0:25 | Struct    | ComputeResult | _c::main::ComputeResult           |         
u0:26 | Function  | compute       | _c::main::AddResult::compute      |         
u0:27 | Variable  | b             | _c::main::AddResult::compute::b   |         
u0:28 | Function  | finalize      | _c::main::ComputeResult::finalize |         
u0:29 | Function  | foo           | _c::main::foo                     |         
u0:30 | Function  | add           | _c::main::add                     |         
u0:31 | Variable  | f             | _c::main::add::f                  |         
u0:32 | Function  | compute       | _c::main::compute                 |         
u0:33 | Variable  | b             | _c::main::compute::b              |         
u0:34 | Function  | finalize      | _c::main::finalize                |         
u0:35 | Function  | func          | _c::main::func                    |         
u0:36 | Variable  | f             | _c::main::func::f                 |         
u0:37 | Variable  | b             | _c::main::func::b                 |         

--- expect:symbol-deps ---
u0:22 <- [u0:30, u0:31, u0:35]
u0:23 <- [u0:26, u0:27, u0:32, u0:33, u0:35, u0:37]
u0:24 -> [u0:25, u0:26]
u0:24 <- [u0:30]
u0:25 -> [u0:28]
u0:25 <- [u0:24, u0:26, u0:32]
u0:26 -> [u0:23, u0:25]
u0:26 <- [u0:24]
u0:27 -> [u0:23]
u0:28 <- [u0:25]
u0:29 <- [u0:35]
u0:30 -> [u0:22, u0:24]
u0:30 <- [u0:35]
u0:31 -> [u0:22]
u0:32 -> [u0:23, u0:25]
u0:32 <- [u0:35]
u0:33 -> [u0:23]
u0:34 <- [u0:35]
u0:35 -> [u0:22, u0:23, u0:29, u0:30, u0:32, u0:34]
u0:37 -> [u0:23]

--- expect:blocks ---
u0:1  | root   | main
u0:2  | class  | Foo
u0:3  | class  | Bar
u0:4  | class  | AddResult
u0:5  | class  | ComputeResult
u0:6  | impl   | AddResult
u0:7  | method | compute
u0:8  | impl   | ComputeResult
u0:9  | method | finalize
u0:10 | func   | foo
u0:11 | func   | add
u0:12 | func   | compute
u0:13 | func   | finalize
u0:14 | func   | func

--- expect:block-deps ---
u0:10 <- [u0:14]
u0:11 -> [u0:2, u0:4]
u0:11 <- [u0:14]
u0:12 -> [u0:3, u0:5]
u0:12 <- [u0:14]
u0:13 <- [u0:14]
u0:14 -> [u0:10, u0:11, u0:12, u0:13, u0:2, u0:3]
u0:2 <- [u0:11, u0:14]
u0:3 <- [u0:12, u0:14, u0:7]
u0:4 -> [u0:5, u0:7]
u0:4 <- [u0:11]
u0:5 -> [u0:9]
u0:5 <- [u0:12, u0:4, u0:7]
u0:7 -> [u0:3, u0:5]
u0:7 <- [u0:4]
u0:9 <- [u0:5]

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Foo", full_path="$TMP/app/src/main.rs:1"];
      n10[label="foo", full_path="$TMP/app/src/main.rs:14"];
      n11[label="add", full_path="$TMP/app/src/main.rs:15"];
      n12[label="compute", full_path="$TMP/app/src/main.rs:18"];
      n3[label="Bar", full_path="$TMP/app/src/main.rs:2"];
      n13[label="finalize", full_path="$TMP/app/src/main.rs:21"];
      n14[label="func", full_path="$TMP/app/src/main.rs:23"];
      n4[label="AddResult", full_path="$TMP/app/src/main.rs:4"];
      n5[label="ComputeResult", full_path="$TMP/app/src/main.rs:5"];
    }
  }

  // Edges
  n11 -> n2;
  n11 -> n4;
  n12 -> n3;
  n12 -> n5;
  n14 -> n10;
  n14 -> n11;
  n14 -> n12;
  n14 -> n13;
  n4 -> n5;
}


===============================================================================
call-expressions-nested
===============================================================================


--- file: app/src/main.rs ---
struct Foo;
struct Bar;

struct AddResult;
struct ComputeResult;
impl AddResult {
    fn compute(self, b: Bar) -> ComputeResult {
        ComputeResult
    }
}
impl ComputeResult {
    fn finalize(self) {}
}
fn foo() {}
fn add(f: ComputeResult) -> AddResult {
    AddResult
}
fn compute(b: Bar) -> ComputeResult {
    ComputeResult
}

fn func() {
  let f = Foo::new();
  let b: Bar = Bar::new(42);
  foo();
  add(f, compute(b));
}

--- expect:symbols ---
u0:1  | Primitive | i32           | i32                               | [global]
u0:2  | Primitive | i64           | i64                               | [global]
u0:3  | Primitive | i16           | i16                               | [global]
u0:4  | Primitive | i8            | i8                                | [global]
u0:5  | Primitive | i128          | i128                              | [global]
u0:6  | Primitive | isize         | isize                             | [global]
u0:7  | Primitive | u32           | u32                               | [global]
u0:8  | Primitive | u64           | u64                               | [global]
u0:9  | Primitive | u16           | u16                               | [global]
u0:10 | Primitive | u8            | u8                                | [global]
u0:11 | Primitive | u128          | u128                              | [global]
u0:12 | Primitive | usize         | usize                             | [global]
u0:13 | Primitive | f32           | f32                               | [global]
u0:14 | Primitive | f64           | f64                               | [global]
u0:15 | Primitive | bool          | bool                              | [global]
u0:16 | Primitive | char          | char                              | [global]
u0:17 | Primitive | str           | str                               | [global]
u0:18 | Primitive | String        | String                            | [global]
u0:19 | Crate     | _c            | _c                                | [global]
u0:20 | Crate     | crate         | _c::crate                         |         
u0:21 | File      | main          | _c::main                          |         
u0:22 | Struct    | Foo           | _c::main::Foo                     |         
u0:23 | Struct    | Bar           | _c::main::Bar                     |         
u0:24 | Struct    | AddResult     | _c::main::AddResult               |         
u0:25 | Struct    | ComputeResult | _c::main::ComputeResult           |         
u0:26 | Function  | compute       | _c::main::AddResult::compute      |         
u0:27 | Variable  | b             | _c::main::AddResult::compute::b   |         
u0:28 | Function  | finalize      | _c::main::ComputeResult::finalize |         
u0:29 | Function  | foo           | _c::main::foo                     |         
u0:30 | Function  | add           | _c::main::add                     |         
u0:31 | Variable  | f             | _c::main::add::f                  |         
u0:32 | Function  | compute       | _c::main::compute                 |         
u0:33 | Variable  | b             | _c::main::compute::b              |         
u0:34 | Function  | func          | _c::main::func                    |         
u0:35 | Variable  | f             | _c::main::func::f                 |         
u0:36 | Variable  | b             | _c::main::func::b                 |         

--- expect:symbol-deps ---
u0:22 <- [u0:34]
u0:23 <- [u0:26, u0:27, u0:32, u0:33, u0:34, u0:36]
u0:24 -> [u0:25, u0:26]
u0:24 <- [u0:30]
u0:25 -> [u0:28]
u0:25 <- [u0:24, u0:26, u0:30, u0:31, u0:32]
u0:26 -> [u0:23, u0:25]
u0:26 <- [u0:24]
u0:27 -> [u0:23]
u0:28 <- [u0:25]
u0:29 <- [u0:34]
u0:30 -> [u0:24, u0:25, u0:32]
u0:30 <- [u0:34]
u0:31 -> [u0:25]
u0:32 -> [u0:23, u0:25]
u0:32 <- [u0:30, u0:34]
u0:33 -> [u0:23]
u0:34 -> [u0:22, u0:23, u0:29, u0:30, u0:32]
u0:36 -> [u0:23]

--- expect:blocks ---
u0:1  | root   | main
u0:2  | class  | Foo
u0:3  | class  | Bar
u0:4  | class  | AddResult
u0:5  | class  | ComputeResult
u0:6  | impl   | AddResult
u0:7  | method | compute
u0:8  | impl   | ComputeResult
u0:9  | method | finalize
u0:10 | func   | foo
u0:11 | func   | add
u0:12 | func   | compute
u0:13 | func   | func

--- expect:block-deps ---
u0:10 <- [u0:13]
u0:11 -> [u0:12, u0:4, u0:5]
u0:11 <- [u0:13]
u0:12 -> [u0:3, u0:5]
u0:12 <- [u0:11, u0:13]
u0:13 -> [u0:10, u0:11, u0:12, u0:2, u0:3]
u0:2 <- [u0:13]
u0:3 <- [u0:12, u0:13, u0:7]
u0:4 -> [u0:5, u0:7]
u0:4 <- [u0:11]
u0:5 -> [u0:9]
u0:5 <- [u0:11, u0:12, u0:4, u0:7]
u0:7 -> [u0:3, u0:5]
u0:7 <- [u0:4]
u0:9 <- [u0:5]

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Foo", full_path="$TMP/app/src/main.rs:1"];
      n10[label="foo", full_path="$TMP/app/src/main.rs:14"];
      n11[label="add", full_path="$TMP/app/src/main.rs:15"];
      n12[label="compute", full_path="$TMP/app/src/main.rs:18"];
      n3[label="Bar", full_path="$TMP/app/src/main.rs:2"];
      n13[label="func", full_path="$TMP/app/src/main.rs:22"];
      n4[label="AddResult", full_path="$TMP/app/src/main.rs:4"];
      n5[label="ComputeResult", full_path="$TMP/app/src/main.rs:5"];
    }
  }

  // Edges
  n11 -> n12;
  n11 -> n4;
  n12 -> n3;
  n12 -> n5;
  n13 -> n2;
  n13 -> n10;
  n13 -> n11;
  n4 -> n5;
}


===============================================================================
array-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Foo;

fn foo() {
  let a = Foo::new();
  [];
  let b = [1, a, 3];
  ["a", "b", "c"];
  [0; 128];
  [
      #[cfg(foo)]
      "foo",
      #[cfg(bar)]
      "bar",
  ];
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32              | [global]
u0:2  | Primitive | i64    | i64              | [global]
u0:3  | Primitive | i16    | i16              | [global]
u0:4  | Primitive | i8     | i8               | [global]
u0:5  | Primitive | i128   | i128             | [global]
u0:6  | Primitive | isize  | isize            | [global]
u0:7  | Primitive | u32    | u32              | [global]
u0:8  | Primitive | u64    | u64              | [global]
u0:9  | Primitive | u16    | u16              | [global]
u0:10 | Primitive | u8     | u8               | [global]
u0:11 | Primitive | u128   | u128             | [global]
u0:12 | Primitive | usize  | usize            | [global]
u0:13 | Primitive | f32    | f32              | [global]
u0:14 | Primitive | f64    | f64              | [global]
u0:15 | Primitive | bool   | bool             | [global]
u0:16 | Primitive | char   | char             | [global]
u0:17 | Primitive | str    | str              | [global]
u0:18 | Primitive | String | String           | [global]
u0:19 | Crate     | _c     | _c               | [global]
u0:20 | Crate     | crate  | _c::crate        |         
u0:21 | File      | main   | _c::main         |         
u0:22 | Struct    | Foo    | _c::main::Foo    |         
u0:23 | Function  | foo    | _c::main::foo    |         
u0:24 | Variable  | a      | _c::main::foo::a |         
u0:25 | Variable  | b      | _c::main::foo::b |         

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:25]
u0:22 <- [u0:23]
u0:23 -> [u0:1, u0:22]
u0:25 -> [u0:1]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Foo
u0:3 | func  | foo

--- expect:block-deps ---
u0:2 <- [u0:3]
u0:3 -> [u0:2]

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Foo", full_path="$TMP/app/src/main.rs:1"];
      n3[label="foo", full_path="$TMP/app/src/main.rs:3"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
tuple-expressions
===============================================================================


--- file: app/src/main.rs ---
struct TupleThing;

fn make_tuples() {
  let empty = ();
  let single = (TupleThing,);
  let triple = (TupleThing, 2, 3);
  let nested = ((1, 2), (3, 4));
  let destructured = match triple {
    (a, b, c) => (a, b, c),
  };
  let _all = (empty, single, nested, destructured);
}

--- expect:symbols ---
u0:1  | Primitive | i32          | i32                                 | [global]
u0:2  | Primitive | i64          | i64                                 | [global]
u0:3  | Primitive | i16          | i16                                 | [global]
u0:4  | Primitive | i8           | i8                                  | [global]
u0:5  | Primitive | i128         | i128                                | [global]
u0:6  | Primitive | isize        | isize                               | [global]
u0:7  | Primitive | u32          | u32                                 | [global]
u0:8  | Primitive | u64          | u64                                 | [global]
u0:9  | Primitive | u16          | u16                                 | [global]
u0:10 | Primitive | u8           | u8                                  | [global]
u0:11 | Primitive | u128         | u128                                | [global]
u0:12 | Primitive | usize        | usize                               | [global]
u0:13 | Primitive | f32          | f32                                 | [global]
u0:14 | Primitive | f64          | f64                                 | [global]
u0:15 | Primitive | bool         | bool                                | [global]
u0:16 | Primitive | char         | char                                | [global]
u0:17 | Primitive | str          | str                                 | [global]
u0:18 | Primitive | String       | String                              | [global]
u0:19 | Crate     | _c           | _c                                  | [global]
u0:20 | Crate     | crate        | _c::crate                           |         
u0:21 | File      | main         | _c::main                            |         
u0:22 | Struct    | TupleThing   | _c::main::TupleThing                |         
u0:23 | Function  | make_tuples  | _c::main::make_tuples               |         
u0:24 | Variable  | empty        | _c::main::make_tuples::empty        |         
u0:25 | Variable  | single       | _c::main::make_tuples::single       |         
u0:26 | Variable  | triple       | _c::main::make_tuples::triple       |         
u0:27 | Variable  | nested       | _c::main::make_tuples::nested       |         
u0:28 | Variable  | destructured | _c::main::make_tuples::destructured |         
u0:29 | Variable  | _all         | _c::main::make_tuples::_all         |         

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:27]
u0:22 <- [u0:23, u0:25, u0:26, u0:28]
u0:23 -> [u0:1, u0:22]
u0:25 -> [u0:22]
u0:26 -> [u0:22]
u0:27 -> [u0:1]
u0:28 -> [u0:22]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | TupleThing
u0:3 | func  | make_tuples

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="TupleThing", full_path="$TMP/app/src/main.rs:1"];
      n3[label="make_tuples", full_path="$TMP/app/src/main.rs:3"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
struct-expressions
===============================================================================


--- file: app/src/main.rs ---
struct SomeStruct {
    field1: i32,
    field2: String,
    field3: f64,
}
struct NothingInMe;
struct Point {
    x: f64,
    y: f64,
}
mod game {
    pub struct User {
        pub name: &'static str,
        pub age: u8,
        pub score: u32,
    }
}

struct Instant(Duration);


fn func() {
  NothingInMe {};
  Point {x: 10.0, y: 20.0};
  let a = SomeStruct { field1, field2: expression, field3, };
  let u = game::User {name: "Joe", age: 35, score: 100_000};
  let i = Instant { 0: Duration::from_millis(0) };
}

--- expect:symbols ---
u0:1  | Primitive | i32         | i32                          | [global]
u0:2  | Primitive | i64         | i64                          | [global]
u0:3  | Primitive | i16         | i16                          | [global]
u0:4  | Primitive | i8          | i8                           | [global]
u0:5  | Primitive | i128        | i128                         | [global]
u0:6  | Primitive | isize       | isize                        | [global]
u0:7  | Primitive | u32         | u32                          | [global]
u0:8  | Primitive | u64         | u64                          | [global]
u0:9  | Primitive | u16         | u16                          | [global]
u0:10 | Primitive | u8          | u8                           | [global]
u0:11 | Primitive | u128        | u128                         | [global]
u0:12 | Primitive | usize       | usize                        | [global]
u0:13 | Primitive | f32         | f32                          | [global]
u0:14 | Primitive | f64         | f64                          | [global]
u0:15 | Primitive | bool        | bool                         | [global]
u0:16 | Primitive | char        | char                         | [global]
u0:17 | Primitive | str         | str                          | [global]
u0:18 | Primitive | String      | String                       | [global]
u0:19 | Crate     | _c          | _c                           | [global]
u0:20 | Crate     | crate       | _c::crate                    |         
u0:21 | File      | main        | _c::main                     |         
u0:22 | Struct    | SomeStruct  | _c::main::SomeStruct         |         
u0:23 | Field     | field1      | _c::main::SomeStruct::field1 |         
u0:24 | Field     | field2      | _c::main::SomeStruct::field2 |         
u0:25 | Field     | field3      | _c::main::SomeStruct::field3 |         
u0:26 | Struct    | NothingInMe | _c::main::NothingInMe        |         
u0:27 | Struct    | Point       | _c::main::Point              |         
u0:28 | Field     | x           | _c::main::Point::x           |         
u0:29 | Field     | y           | _c::main::Point::y           |         
u0:30 | Namespace | game        | _c::main::game               |         
u0:31 | Struct    | User        | _c::main::game::User         | [global]
u0:32 | Field     | name        | _c::main::game::User::name   |         
u0:33 | Field     | age         | _c::main::game::User::age    |         
u0:34 | Field     | score       | _c::main::game::User::score  |         
u0:35 | Struct    | Instant     | _c::main::Instant            |         
u0:36 | Function  | func        | _c::main::func               |         
u0:37 | Variable  | a           | _c::main::func::a            |         
u0:38 | Variable  | u           | _c::main::func::u            |         
u0:39 | Variable  | i           | _c::main::func::i            |         

--- expect:symbol-deps ---
u0:1 <- [u0:22, u0:23]
u0:10 <- [u0:31, u0:33]
u0:14 <- [u0:22, u0:25, u0:27, u0:28, u0:29]
u0:17 <- [u0:31]
u0:18 <- [u0:22, u0:24]
u0:22 -> [u0:1, u0:14, u0:18]
u0:22 <- [u0:36, u0:37]
u0:23 -> [u0:1]
u0:24 -> [u0:18]
u0:25 -> [u0:14]
u0:26 <- [u0:36]
u0:27 -> [u0:14]
u0:27 <- [u0:36]
u0:28 -> [u0:14]
u0:29 -> [u0:14]
u0:30 -> [u0:31]
u0:31 -> [u0:10, u0:17, u0:7]
u0:31 <- [u0:30, u0:36, u0:38]
u0:33 -> [u0:10]
u0:34 -> [u0:7]
u0:35 <- [u0:36, u0:39]
u0:36 -> [u0:22, u0:26, u0:27, u0:31, u0:35]
u0:37 -> [u0:22]
u0:38 -> [u0:31]
u0:39 -> [u0:35]
u0:7 <- [u0:31, u0:34]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | SomeStruct
u0:3 | class | NothingInMe
u0:4 | class | Point
u0:5 | class | User
u0:6 | class | Instant
u0:7 | func  | func

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="SomeStruct", full_path="$TMP/app/src/main.rs:1"];
      n5[label="User", full_path="$TMP/app/src/main.rs:12"];
      n6[label="Instant", full_path="$TMP/app/src/main.rs:19"];
      n7[label="func", full_path="$TMP/app/src/main.rs:22"];
      n3[label="NothingInMe", full_path="$TMP/app/src/main.rs:6"];
      n4[label="Point", full_path="$TMP/app/src/main.rs:7"];
    }
  }

  // Edges
  n7 -> n2;
  n7 -> n5;
  n7 -> n6;
  n7 -> n3;
  n7 -> n4;
}


===============================================================================
struct-expressions-with-update-initializers
===============================================================================


--- file: app/src/main.rs ---
struct User {
    id: u32,
    score: u32,
}

fn build_user(score: u32) -> User {
  let base = User { id: 1, score: 10 };
  User {
    score,
    ..base
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32        | i32                         | [global]
u0:2  | Primitive | i64        | i64                         | [global]
u0:3  | Primitive | i16        | i16                         | [global]
u0:4  | Primitive | i8         | i8                          | [global]
u0:5  | Primitive | i128       | i128                        | [global]
u0:6  | Primitive | isize      | isize                       | [global]
u0:7  | Primitive | u32        | u32                         | [global]
u0:8  | Primitive | u64        | u64                         | [global]
u0:9  | Primitive | u16        | u16                         | [global]
u0:10 | Primitive | u8         | u8                          | [global]
u0:11 | Primitive | u128       | u128                        | [global]
u0:12 | Primitive | usize      | usize                       | [global]
u0:13 | Primitive | f32        | f32                         | [global]
u0:14 | Primitive | f64        | f64                         | [global]
u0:15 | Primitive | bool       | bool                        | [global]
u0:16 | Primitive | char       | char                        | [global]
u0:17 | Primitive | str        | str                         | [global]
u0:18 | Primitive | String     | String                      | [global]
u0:19 | Crate     | _c         | _c                          | [global]
u0:20 | Crate     | crate      | _c::crate                   |         
u0:21 | File      | main       | _c::main                    |         
u0:22 | Struct    | User       | _c::main::User              |         
u0:23 | Field     | id         | _c::main::User::id          |         
u0:24 | Field     | score      | _c::main::User::score       |         
u0:25 | Function  | build_user | _c::main::build_user        |         
u0:26 | Variable  | score      | _c::main::build_user::score |         
u0:27 | Variable  | base       | _c::main::build_user::base  |         

--- expect:symbol-deps ---
u0:22 -> [u0:7]
u0:22 <- [u0:25, u0:27]
u0:23 -> [u0:7]
u0:24 -> [u0:7]
u0:25 -> [u0:22, u0:7]
u0:26 -> [u0:7]
u0:27 -> [u0:22]
u0:7 <- [u0:22, u0:23, u0:24, u0:25, u0:26]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | User
u0:3 | func  | build_user

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="User", full_path="$TMP/app/src/main.rs:1"];
      n3[label="build_user", full_path="$TMP/app/src/main.rs:6"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
if-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Config {
  n: i32,
  x: i32,
}

fn main() {
  let cfg = Config { n: 1, x: 5 };
  if cfg.n == 1 {
  } else if cfg.n == 2 {
  } else {
  }

  let y = if cfg.x == 5 { 10 } else { 15 };

  if cfg.x > 0 && cfg.n > 0 {}

  if cfg.x > 0 || cfg.n > 0 {}
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                 | [global]
u0:2  | Primitive | i64    | i64                 | [global]
u0:3  | Primitive | i16    | i16                 | [global]
u0:4  | Primitive | i8     | i8                  | [global]
u0:5  | Primitive | i128   | i128                | [global]
u0:6  | Primitive | isize  | isize               | [global]
u0:7  | Primitive | u32    | u32                 | [global]
u0:8  | Primitive | u64    | u64                 | [global]
u0:9  | Primitive | u16    | u16                 | [global]
u0:10 | Primitive | u8     | u8                  | [global]
u0:11 | Primitive | u128   | u128                | [global]
u0:12 | Primitive | usize  | usize               | [global]
u0:13 | Primitive | f32    | f32                 | [global]
u0:14 | Primitive | f64    | f64                 | [global]
u0:15 | Primitive | bool   | bool                | [global]
u0:16 | Primitive | char   | char                | [global]
u0:17 | Primitive | str    | str                 | [global]
u0:18 | Primitive | String | String              | [global]
u0:19 | Crate     | _c     | _c                  | [global]
u0:20 | Crate     | crate  | _c::crate           |         
u0:21 | File      | main   | _c::main            |         
u0:22 | Struct    | Config | _c::main::Config    |         
u0:23 | Field     | n      | _c::main::Config::n |         
u0:24 | Field     | x      | _c::main::Config::x |         
u0:25 | Function  | main   | _c::main::main      |         
u0:26 | Variable  | cfg    | _c::main::main::cfg |         
u0:27 | Variable  | y      | _c::main::main::y   |         

--- expect:symbol-deps ---
u0:1 <- [u0:22, u0:23, u0:24, u0:25, u0:27]
u0:22 -> [u0:1]
u0:22 <- [u0:25, u0:26]
u0:23 -> [u0:1]
u0:24 -> [u0:1]
u0:25 -> [u0:1, u0:22]
u0:26 -> [u0:22]
u0:27 -> [u0:1]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Config
u0:3 | func  | main

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Config", full_path="$TMP/app/src/main.rs:1"];
      n3[label="main", full_path="$TMP/app/src/main.rs:6"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
basic-if-let-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Guard {
  val: Option<i32>,
}

fn check() {
  let guard = Guard { val: Some(42) };
  if let Some(a) = guard.val
    && a > 0
  {
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                    | [global]
u0:2  | Primitive | i64    | i64                    | [global]
u0:3  | Primitive | i16    | i16                    | [global]
u0:4  | Primitive | i8     | i8                     | [global]
u0:5  | Primitive | i128   | i128                   | [global]
u0:6  | Primitive | isize  | isize                  | [global]
u0:7  | Primitive | u32    | u32                    | [global]
u0:8  | Primitive | u64    | u64                    | [global]
u0:9  | Primitive | u16    | u16                    | [global]
u0:10 | Primitive | u8     | u8                     | [global]
u0:11 | Primitive | u128   | u128                   | [global]
u0:12 | Primitive | usize  | usize                  | [global]
u0:13 | Primitive | f32    | f32                    | [global]
u0:14 | Primitive | f64    | f64                    | [global]
u0:15 | Primitive | bool   | bool                   | [global]
u0:16 | Primitive | char   | char                   | [global]
u0:17 | Primitive | str    | str                    | [global]
u0:18 | Primitive | String | String                 | [global]
u0:19 | Crate     | _c     | _c                     | [global]
u0:20 | Crate     | crate  | _c::crate              |         
u0:21 | File      | main   | _c::main               |         
u0:22 | Struct    | Guard  | _c::main::Guard        |         
u0:23 | Field     | val    | _c::main::Guard::val   |         
u0:24 | Function  | check  | _c::main::check        |         
u0:25 | Variable  | guard  | _c::main::check::guard |         

--- expect:symbol-deps ---
u0:1 <- [u0:22]
u0:22 -> [u0:1]
u0:22 <- [u0:24, u0:25]
u0:24 -> [u0:22]
u0:25 -> [u0:22]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Guard
u0:3 | func  | check

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Guard", full_path="$TMP/app/src/main.rs:1"];
      n3[label="check", full_path="$TMP/app/src/main.rs:5"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
if-let-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Dish;
fn parse() {
  let dish_opt = Some(Dish);
  if let Some(dish) = dish_opt {
  }

  if let Some("chained") = a && b && let (C, D) = e {
  }

  if foo && let bar = || baz && quux {}
  if a && let b = || c || d && e {}
}

--- expect:symbols ---
u0:1  | Primitive | i32      | i32                       | [global]
u0:2  | Primitive | i64      | i64                       | [global]
u0:3  | Primitive | i16      | i16                       | [global]
u0:4  | Primitive | i8       | i8                        | [global]
u0:5  | Primitive | i128     | i128                      | [global]
u0:6  | Primitive | isize    | isize                     | [global]
u0:7  | Primitive | u32      | u32                       | [global]
u0:8  | Primitive | u64      | u64                       | [global]
u0:9  | Primitive | u16      | u16                       | [global]
u0:10 | Primitive | u8       | u8                        | [global]
u0:11 | Primitive | u128     | u128                      | [global]
u0:12 | Primitive | usize    | usize                     | [global]
u0:13 | Primitive | f32      | f32                       | [global]
u0:14 | Primitive | f64      | f64                       | [global]
u0:15 | Primitive | bool     | bool                      | [global]
u0:16 | Primitive | char     | char                      | [global]
u0:17 | Primitive | str      | str                       | [global]
u0:18 | Primitive | String   | String                    | [global]
u0:19 | Crate     | _c       | _c                        | [global]
u0:20 | Crate     | crate    | _c::crate                 |         
u0:21 | File      | main     | _c::main                  |         
u0:22 | Struct    | Dish     | _c::main::Dish            |         
u0:23 | Function  | parse    | _c::main::parse           |         
u0:24 | Variable  | dish_opt | _c::main::parse::dish_opt |         

--- expect:symbol-deps ---
u0:22 <- [u0:23, u0:24]
u0:23 -> [u0:22]
u0:24 -> [u0:22]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Dish
u0:3 | func  | parse

--- expect:block-deps ---
u0:2 <- [u0:3]
u0:3 -> [u0:2]

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Dish", full_path="$TMP/app/src/main.rs:1"];
      n3[label="parse", full_path="$TMP/app/src/main.rs:2"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
while-let-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Queue {
  items: Option<Vec<i32>>,
}

fn process() {
  let queue = Queue { items: Some(vec![]) };
  while let Some(items) = queue.items {
    let _ = items;
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32     | i32                      | [global]
u0:2  | Primitive | i64     | i64                      | [global]
u0:3  | Primitive | i16     | i16                      | [global]
u0:4  | Primitive | i8      | i8                       | [global]
u0:5  | Primitive | i128    | i128                     | [global]
u0:6  | Primitive | isize   | isize                    | [global]
u0:7  | Primitive | u32     | u32                      | [global]
u0:8  | Primitive | u64     | u64                      | [global]
u0:9  | Primitive | u16     | u16                      | [global]
u0:10 | Primitive | u8      | u8                       | [global]
u0:11 | Primitive | u128    | u128                     | [global]
u0:12 | Primitive | usize   | usize                    | [global]
u0:13 | Primitive | f32     | f32                      | [global]
u0:14 | Primitive | f64     | f64                      | [global]
u0:15 | Primitive | bool    | bool                     | [global]
u0:16 | Primitive | char    | char                     | [global]
u0:17 | Primitive | str     | str                      | [global]
u0:18 | Primitive | String  | String                   | [global]
u0:19 | Crate     | _c      | _c                       | [global]
u0:20 | Crate     | crate   | _c::crate                |         
u0:21 | File      | main    | _c::main                 |         
u0:22 | Struct    | Queue   | _c::main::Queue          |         
u0:23 | Field     | items   | _c::main::Queue::items   |         
u0:24 | Function  | process | _c::main::process        |         
u0:25 | Variable  | queue   | _c::main::process::queue |         

--- expect:symbol-deps ---
u0:1 <- [u0:22]
u0:22 -> [u0:1]
u0:22 <- [u0:24, u0:25]
u0:24 -> [u0:22]
u0:25 -> [u0:22]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Queue
u0:3 | func  | process

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Queue", full_path="$TMP/app/src/main.rs:1"];
      n3[label="process", full_path="$TMP/app/src/main.rs:5"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
match-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Value;

fn process_value() {
  let val = Value;
  match val {
    _ => {},
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32           | i32                          | [global]
u0:2  | Primitive | i64           | i64                          | [global]
u0:3  | Primitive | i16           | i16                          | [global]
u0:4  | Primitive | i8            | i8                           | [global]
u0:5  | Primitive | i128          | i128                         | [global]
u0:6  | Primitive | isize         | isize                        | [global]
u0:7  | Primitive | u32           | u32                          | [global]
u0:8  | Primitive | u64           | u64                          | [global]
u0:9  | Primitive | u16           | u16                          | [global]
u0:10 | Primitive | u8            | u8                           | [global]
u0:11 | Primitive | u128          | u128                         | [global]
u0:12 | Primitive | usize         | usize                        | [global]
u0:13 | Primitive | f32           | f32                          | [global]
u0:14 | Primitive | f64           | f64                          | [global]
u0:15 | Primitive | bool          | bool                         | [global]
u0:16 | Primitive | char          | char                         | [global]
u0:17 | Primitive | str           | str                          | [global]
u0:18 | Primitive | String        | String                       | [global]
u0:19 | Crate     | _c            | _c                           | [global]
u0:20 | Crate     | crate         | _c::crate                    |         
u0:21 | File      | main          | _c::main                     |         
u0:22 | Struct    | Value         | _c::main::Value              |         
u0:23 | Function  | process_value | _c::main::process_value      |         
u0:24 | Variable  | val           | _c::main::process_value::val |         

--- expect:symbol-deps ---
u0:22 <- [u0:23, u0:24]
u0:23 -> [u0:22]
u0:24 -> [u0:22]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Value
u0:3 | func  | process_value

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Value", full_path="$TMP/app/src/main.rs:1"];
      n3[label="process_value", full_path="$TMP/app/src/main.rs:3"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
while-expressions
===============================================================================


--- file: app/src/main.rs ---
struct State {
  done: bool,
}

fn loop_until() {
  let state = State { done: false };
  while !state.done {
    let _ = state.done;
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32        | i32                         | [global]
u0:2  | Primitive | i64        | i64                         | [global]
u0:3  | Primitive | i16        | i16                         | [global]
u0:4  | Primitive | i8         | i8                          | [global]
u0:5  | Primitive | i128       | i128                        | [global]
u0:6  | Primitive | isize      | isize                       | [global]
u0:7  | Primitive | u32        | u32                         | [global]
u0:8  | Primitive | u64        | u64                         | [global]
u0:9  | Primitive | u16        | u16                         | [global]
u0:10 | Primitive | u8         | u8                          | [global]
u0:11 | Primitive | u128       | u128                        | [global]
u0:12 | Primitive | usize      | usize                       | [global]
u0:13 | Primitive | f32        | f32                         | [global]
u0:14 | Primitive | f64        | f64                         | [global]
u0:15 | Primitive | bool       | bool                        | [global]
u0:16 | Primitive | char       | char                        | [global]
u0:17 | Primitive | str        | str                         | [global]
u0:18 | Primitive | String     | String                      | [global]
u0:19 | Crate     | _c         | _c                          | [global]
u0:20 | Crate     | crate      | _c::crate                   |         
u0:21 | File      | main       | _c::main                    |         
u0:22 | Struct    | State      | _c::main::State             |         
u0:23 | Field     | done       | _c::main::State::done       |         
u0:24 | Function  | loop_until | _c::main::loop_until        |         
u0:25 | Variable  | state      | _c::main::loop_until::state |         

--- expect:symbol-deps ---
u0:15 <- [u0:22, u0:23, u0:24]
u0:22 -> [u0:15]
u0:22 <- [u0:24, u0:25]
u0:23 -> [u0:15]
u0:24 -> [u0:15, u0:22]
u0:25 -> [u0:22]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | State
u0:3 | func  | loop_until

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="State", full_path="$TMP/app/src/main.rs:1"];
      n3[label="loop_until", full_path="$TMP/app/src/main.rs:5"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
loop-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Counter {
  limit: i32,
}

fn count() {
  let counter = Counter { limit: 10 };
  'outer: loop {
    'inner: loop {
      break 'outer;
    }
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32     | i32                      | [global]
u0:2  | Primitive | i64     | i64                      | [global]
u0:3  | Primitive | i16     | i16                      | [global]
u0:4  | Primitive | i8      | i8                       | [global]
u0:5  | Primitive | i128    | i128                     | [global]
u0:6  | Primitive | isize   | isize                    | [global]
u0:7  | Primitive | u32     | u32                      | [global]
u0:8  | Primitive | u64     | u64                      | [global]
u0:9  | Primitive | u16     | u16                      | [global]
u0:10 | Primitive | u8      | u8                       | [global]
u0:11 | Primitive | u128    | u128                     | [global]
u0:12 | Primitive | usize   | usize                    | [global]
u0:13 | Primitive | f32     | f32                      | [global]
u0:14 | Primitive | f64     | f64                      | [global]
u0:15 | Primitive | bool    | bool                     | [global]
u0:16 | Primitive | char    | char                     | [global]
u0:17 | Primitive | str     | str                      | [global]
u0:18 | Primitive | String  | String                   | [global]
u0:19 | Crate     | _c      | _c                       | [global]
u0:20 | Crate     | crate   | _c::crate                |         
u0:21 | File      | main    | _c::main                 |         
u0:22 | Struct    | Counter | _c::main::Counter        |         
u0:23 | Field     | limit   | _c::main::Counter::limit |         
u0:24 | Function  | count   | _c::main::count          |         
u0:25 | Variable  | counter | _c::main::count::counter |         

--- expect:symbol-deps ---
u0:1 <- [u0:22, u0:23]
u0:22 -> [u0:1]
u0:22 <- [u0:24, u0:25]
u0:23 -> [u0:1]
u0:24 -> [u0:22]
u0:25 -> [u0:22]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Counter
u0:3 | func  | count

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Counter", full_path="$TMP/app/src/main.rs:1"];
      n3[label="count", full_path="$TMP/app/src/main.rs:5"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
for-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Container;

fn iterate() {
  let container = Container;
  for i in 0..10 {
    let _ = i;
  }
}

--- expect:symbols ---
u0:1  | Primitive | i32       | i32                          | [global]
u0:2  | Primitive | i64       | i64                          | [global]
u0:3  | Primitive | i16       | i16                          | [global]
u0:4  | Primitive | i8        | i8                           | [global]
u0:5  | Primitive | i128      | i128                         | [global]
u0:6  | Primitive | isize     | isize                        | [global]
u0:7  | Primitive | u32       | u32                          | [global]
u0:8  | Primitive | u64       | u64                          | [global]
u0:9  | Primitive | u16       | u16                          | [global]
u0:10 | Primitive | u8        | u8                           | [global]
u0:11 | Primitive | u128      | u128                         | [global]
u0:12 | Primitive | usize     | usize                        | [global]
u0:13 | Primitive | f32       | f32                          | [global]
u0:14 | Primitive | f64       | f64                          | [global]
u0:15 | Primitive | bool      | bool                         | [global]
u0:16 | Primitive | char      | char                         | [global]
u0:17 | Primitive | str       | str                          | [global]
u0:18 | Primitive | String    | String                       | [global]
u0:19 | Crate     | _c        | _c                           | [global]
u0:20 | Crate     | crate     | _c::crate                    |         
u0:21 | File      | main      | _c::main                     |         
u0:22 | Struct    | Container | _c::main::Container          |         
u0:23 | Function  | iterate   | _c::main::iterate            |         
u0:24 | Variable  | container | _c::main::iterate::container |         

--- expect:symbol-deps ---
u0:22 <- [u0:23, u0:24]
u0:23 -> [u0:22]
u0:24 -> [u0:22]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Container
u0:3 | func  | iterate

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Container", full_path="$TMP/app/src/main.rs:1"];
      n3[label="iterate", full_path="$TMP/app/src/main.rs:3"];
    }
  }

  // Edges
  n3 -> n2;
}


===============================================================================
field-expressions
===============================================================================


--- file: app/src/main.rs ---
struct Foo;
struct Far;
struct Baz {
  x: Far,
}

struct MyStruct {
  myfield: Foo,
}

fn foo() -> Baz {
  Baz
}

fn bar() {
  let mystruct = MyStruct { myfield: Foo };
  let x = mystruct.myfield;
  let y = foo().x;
  value.0.1.iter();
  1.max(2);
}

--- expect:symbols ---
u0:1  | Primitive | i32      | i32                         | [global]
u0:2  | Primitive | i64      | i64                         | [global]
u0:3  | Primitive | i16      | i16                         | [global]
u0:4  | Primitive | i8       | i8                          | [global]
u0:5  | Primitive | i128     | i128                        | [global]
u0:6  | Primitive | isize    | isize                       | [global]
u0:7  | Primitive | u32      | u32                         | [global]
u0:8  | Primitive | u64      | u64                         | [global]
u0:9  | Primitive | u16      | u16                         | [global]
u0:10 | Primitive | u8       | u8                          | [global]
u0:11 | Primitive | u128     | u128                        | [global]
u0:12 | Primitive | usize    | usize                       | [global]
u0:13 | Primitive | f32      | f32                         | [global]
u0:14 | Primitive | f64      | f64                         | [global]
u0:15 | Primitive | bool     | bool                        | [global]
u0:16 | Primitive | char     | char                        | [global]
u0:17 | Primitive | str      | str                         | [global]
u0:18 | Primitive | String   | String                      | [global]
u0:19 | Crate     | _c       | _c                          | [global]
u0:20 | Crate     | crate    | _c::crate                   |         
u0:21 | File      | main     | _c::main                    |         
u0:22 | Struct    | Foo      | _c::main::Foo               |         
u0:23 | Struct    | Far      | _c::main::Far               |         
u0:24 | Struct    | Baz      | _c::main::Baz               |         
u0:25 | Field     | x        | _c::main::Baz::x            |         
u0:26 | Struct    | MyStruct | _c::main::MyStruct          |         
u0:27 | Field     | myfield  | _c::main::MyStruct::myfield |         
u0:28 | Function  | foo      | _c::main::foo               |         
u0:29 | Function  | bar      | _c::main::bar               |         
u0:30 | Variable  | mystruct | _c::main::bar::mystruct     |         
u0:31 | Variable  | x        | _c::main::bar::x            |         
u0:32 | Variable  | y        | _c::main::bar::y            |         

--- expect:symbol-deps ---
u0:22 <- [u0:26, u0:27, u0:29, u0:31]
u0:23 <- [u0:24, u0:25, u0:29, u0:32]
u0:24 -> [u0:23]
u0:24 <- [u0:28]
u0:25 -> [u0:23]
u0:26 -> [u0:22]
u0:26 <- [u0:29, u0:30]
u0:27 -> [u0:22]
u0:28 -> [u0:24]
u0:28 <- [u0:29]
u0:29 -> [u0:22, u0:23, u0:26, u0:28]
u0:30 -> [u0:26]
u0:31 -> [u0:22]
u0:32 -> [u0:23]

--- expect:blocks ---
u0:1 | root  | main
u0:2 | class | Foo
u0:3 | class | Far
u0:4 | class | Baz
u0:5 | class | MyStruct
u0:6 | func  | foo
u0:7 | func  | bar

--- expect:block-deps ---
u0:2 <- [u0:5, u0:7]
u0:3 <- [u0:4, u0:7]
u0:4 -> [u0:3]
u0:4 <- [u0:6]
u0:5 -> [u0:2]
u0:5 <- [u0:7]
u0:6 -> [u0:4]
u0:6 <- [u0:7]
u0:7 -> [u0:2, u0:3, u0:5, u0:6]

--- expect:graph ---
digraph project {
  graph [fontname="Helvetica Bold", fontsize=12];

  subgraph cluster_0 {
    label="_c";
    subgraph cluster_1 {
      label="main";
      style="filled";
      fillcolor="#EEEEEE";
      color="#616161";
      n2[label="Foo", full_path="$TMP/app/src/main.rs:1"];
      n6[label="foo", full_path="$TMP/app/src/main.rs:11"];
      n7[label="bar", full_path="$TMP/app/src/main.rs:15"];
      n3[label="Far", full_path="$TMP/app/src/main.rs:2"];
      n4[label="Baz", full_path="$TMP/app/src/main.rs:3"];
      n5[label="MyStruct", full_path="$TMP/app/src/main.rs:7"];
    }
  }

  // Edges
  n6 -> n4;
  n7 -> n6;
  n7 -> n5;
  n4 -> n3;
  n5 -> n2;
}


===============================================================================
method-call-expressions
===============================================================================


--- file: src/main.rs ---
struct Foo;

struct MyStruct;

impl MyStruct {
  fn foo(&self) -> Foo {}
}

fn func() {
    let mystruct = MyStruct;
    let x = mystruct.foo();
}

--- expect:symbols ---
u0:1  | Primitive | i32      | i32                      | [global]
u0:2  | Primitive | i64      | i64                      | [global]
u0:3  | Primitive | i16      | i16                      | [global]
u0:4  | Primitive | i8       | i8                       | [global]
u0:5  | Primitive | i128     | i128                     | [global]
u0:6  | Primitive | isize    | isize                    | [global]
u0:7  | Primitive | u32      | u32                      | [global]
u0:8  | Primitive | u64      | u64                      | [global]
u0:9  | Primitive | u16      | u16                      | [global]
u0:10 | Primitive | u8       | u8                       | [global]
u0:11 | Primitive | u128     | u128                     | [global]
u0:12 | Primitive | usize    | usize                    | [global]
u0:13 | Primitive | f32      | f32                      | [global]
u0:14 | Primitive | f64      | f64                      | [global]
u0:15 | Primitive | bool     | bool                     | [global]
u0:16 | Primitive | char     | char                     | [global]
u0:17 | Primitive | str      | str                      | [global]
u0:18 | Primitive | String   | String                   | [global]
u0:19 | Crate     | _c       | _c                       | [global]
u0:20 | Crate     | crate    | _c::crate                |         
u0:21 | File      | main     | _c::main                 |         
u0:22 | Struct    | Foo      | _c::main::Foo            |         
u0:23 | Struct    | MyStruct | _c::main::MyStruct       |         
u0:24 | Function  | foo      | _c::main::MyStruct::foo  |         
u0:25 | Function  | func     | _c::main::func           |         
u0:26 | Variable  | mystruct | _c::main::func::mystruct |         
u0:27 | Variable  | x        | _c::main::func::x        |         

--- expect:symbol-deps ---
u0:22 <- [u0:23, u0:24, u0:25, u0:27]
u0:23 -> [u0:22, u0:24]
u0:23 <- [u0:25, u0:26]
u0:24 -> [u0:22]
u0:24 <- [u0:23, u0:25]
u0:25 -> [u0:22, u0:23, u0:24]
u0:26 -> [u0:23]
u0:27 -> [u0:22]


===============================================================================
index-expressions
===============================================================================


--- file: src/main.rs ---
struct Item;

fn func() {
    let arr: [Item; 4] = [Item, Item, Item, Item];
    let first = arr[0];
    let second = arr[1];
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                    | [global]
u0:2  | Primitive | i64    | i64                    | [global]
u0:3  | Primitive | i16    | i16                    | [global]
u0:4  | Primitive | i8     | i8                     | [global]
u0:5  | Primitive | i128   | i128                   | [global]
u0:6  | Primitive | isize  | isize                  | [global]
u0:7  | Primitive | u32    | u32                    | [global]
u0:8  | Primitive | u64    | u64                    | [global]
u0:9  | Primitive | u16    | u16                    | [global]
u0:10 | Primitive | u8     | u8                     | [global]
u0:11 | Primitive | u128   | u128                   | [global]
u0:12 | Primitive | usize  | usize                  | [global]
u0:13 | Primitive | f32    | f32                    | [global]
u0:14 | Primitive | f64    | f64                    | [global]
u0:15 | Primitive | bool   | bool                   | [global]
u0:16 | Primitive | char   | char                   | [global]
u0:17 | Primitive | str    | str                    | [global]
u0:18 | Primitive | String | String                 | [global]
u0:19 | Crate     | _c     | _c                     | [global]
u0:20 | Crate     | crate  | _c::crate              |         
u0:21 | File      | main   | _c::main               |         
u0:22 | Struct    | Item   | _c::main::Item         |         
u0:23 | Function  | func   | _c::main::func         |         
u0:24 | Variable  | arr    | _c::main::func::arr    |         
u0:25 | Variable  | first  | _c::main::func::first  |         
u0:26 | Variable  | second | _c::main::func::second |         

--- expect:symbol-deps ---
u0:22 <- [u0:23, u0:24, u0:25, u0:26]
u0:23 -> [u0:22]
u0:24 -> [u0:22]
u0:25 -> [u0:22]
u0:26 -> [u0:22]


===============================================================================
scoped-functions
===============================================================================


--- file: app/src/foo.rs ---
pub fn f() {}

pub mod g {
  pub fn h() {}
}

--- file: app/src/main.rs ---
struct a;
impl a {
  fn b() {}
}

struct C<T>;
impl C<T> {
  fn e() {}
}

fn foo() {
  a::b();
  C::<D>::e();
  ::f();
  ::g::h();
}

--- expect:symbols ---
u0:1  | Primitive     | i32    | i32            | [global]
u0:2  | Primitive     | i64    | i64            | [global]
u0:3  | Primitive     | i16    | i16            | [global]
u0:4  | Primitive     | i8     | i8             | [global]
u0:5  | Primitive     | i128   | i128           | [global]
u0:6  | Primitive     | isize  | isize          | [global]
u0:7  | Primitive     | u32    | u32            | [global]
u0:8  | Primitive     | u64    | u64            | [global]
u0:9  | Primitive     | u16    | u16            | [global]
u0:10 | Primitive     | u8     | u8             | [global]
u0:11 | Primitive     | u128   | u128           | [global]
u0:12 | Primitive     | usize  | usize          | [global]
u0:13 | Primitive     | f32    | f32            | [global]
u0:14 | Primitive     | f64    | f64            | [global]
u0:15 | Primitive     | bool   | bool           | [global]
u0:16 | Primitive     | char   | char           | [global]
u0:17 | Primitive     | str    | str            | [global]
u0:18 | Primitive     | String | String         | [global]
u0:19 | Crate         | _c     | _c             | [global]
u0:20 | Crate         | crate  | _c::crate      |         
u0:21 | File          | foo    | _c::foo        |         
u0:22 | Function      | f      | _c::foo::f     | [global]
u0:23 | Namespace     | g      | _c::foo::g     | [global]
u0:24 | Function      | h      | _c::foo::g::h  | [global]
u1:25 | Crate         | crate  | _c::crate      |         
u1:26 | File          | main   | _c::main       |         
u1:27 | Struct        | a      | _c::main::a    |         
u1:28 | Function      | b      | _c::main::a::b |         
u1:29 | Struct        | C      | _c::main::C    |         
u1:30 | TypeParameter | T      | _c::main::C::T |         
u1:31 | Function      | e      | _c::main::C::e |         
u1:32 | Function      | foo    | _c::main::foo  |         

--- expect:symbol-deps ---
u0:22 <- [u1:32]
u0:23 -> [u0:24]
u0:23 <- [u1:32]
u0:24 <- [u0:23, u1:32]
u1:27 -> [u1:28]
u1:27 <- [u1:32]
u1:28 <- [u1:27, u1:32]
u1:29 -> [u1:31]
u1:29 <- [u1:32]
u1:31 <- [u1:29, u1:32]
u1:32 -> [u0:22, u0:23, u0:24, u1:27, u1:28, u1:29, u1:31]

--- expect:block-graph ---
(root:1 foo
    (func:2 f)
    (func:3 h)
)

(root:4 main
    (class:5 a)
    (impl:6 a
        (method:7 b)
    )
    (class:8 C)
    (impl:9 C
        (method:10 e)
    )
    (func:11 foo)
)

--- expect:block-deps ---
u0:2 <- [u1:11]
u0:3 <- [u1:11]
u1:10 <- [u1:11, u1:8]
u1:11 -> [u0:2, u0:3, u1:10, u1:5, u1:7, u1:8]
u1:5 -> [u1:7]
u1:5 <- [u1:11]
u1:7 <- [u1:11, u1:5]
u1:8 -> [u1:10]
u1:8 <- [u1:11]


===============================================================================
scoped-functions-with-fully-qualified-syntax
===============================================================================


--- file: src/main.rs ---
trait Animal {
    fn eat(&self);
}

struct Dog;
impl Dog {
  fn talk(&self) {}
}

impl Animal for Dog {
    fn eat(&self) {
      self.talk();
    }
}

fn foo(d: Dog) {
    <Dog as Animal>::eat(&d);
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                   | [global]
u0:2  | Primitive | i64    | i64                   | [global]
u0:3  | Primitive | i16    | i16                   | [global]
u0:4  | Primitive | i8     | i8                    | [global]
u0:5  | Primitive | i128   | i128                  | [global]
u0:6  | Primitive | isize  | isize                 | [global]
u0:7  | Primitive | u32    | u32                   | [global]
u0:8  | Primitive | u64    | u64                   | [global]
u0:9  | Primitive | u16    | u16                   | [global]
u0:10 | Primitive | u8     | u8                    | [global]
u0:11 | Primitive | u128   | u128                  | [global]
u0:12 | Primitive | usize  | usize                 | [global]
u0:13 | Primitive | f32    | f32                   | [global]
u0:14 | Primitive | f64    | f64                   | [global]
u0:15 | Primitive | bool   | bool                  | [global]
u0:16 | Primitive | char   | char                  | [global]
u0:17 | Primitive | str    | str                   | [global]
u0:18 | Primitive | String | String                | [global]
u0:19 | Crate     | _c     | _c                    | [global]
u0:20 | Crate     | crate  | _c::crate             |         
u0:21 | File      | main   | _c::main              |         
u0:22 | Trait     | Animal | _c::main::Animal      |         
u0:23 | Function  | eat    | _c::main::Animal::eat |         
u0:24 | Struct    | Dog    | _c::main::Dog         |         
u0:25 | Function  | talk   | _c::main::Dog::talk   |         
u0:26 | Function  | eat    | _c::main::Dog::eat    |         
u0:27 | Function  | foo    | _c::main::foo         |         
u0:28 | Variable  | d      | _c::main::foo::d      |         

--- expect:symbol-deps ---
u0:22 -> [u0:23]
u0:22 <- [u0:24]
u0:23 <- [u0:22]
u0:24 -> [u0:22, u0:25, u0:26]
u0:24 <- [u0:27, u0:28]
u0:25 <- [u0:24, u0:26]
u0:26 -> [u0:25]
u0:26 <- [u0:24, u0:27]
u0:27 -> [u0:24, u0:26]
u0:28 -> [u0:24]


===============================================================================
scoped-functions-with-macros-as-types
===============================================================================


--- file: src/main.rs ---
<Token![]>::foo();

--- expect:symbols ---
u0:1  | Primitive | i32    | i32       | [global]
u0:2  | Primitive | i64    | i64       | [global]
u0:3  | Primitive | i16    | i16       | [global]
u0:4  | Primitive | i8     | i8        | [global]
u0:5  | Primitive | i128   | i128      | [global]
u0:6  | Primitive | isize  | isize     | [global]
u0:7  | Primitive | u32    | u32       | [global]
u0:8  | Primitive | u64    | u64       | [global]
u0:9  | Primitive | u16    | u16       | [global]
u0:10 | Primitive | u8     | u8        | [global]
u0:11 | Primitive | u128   | u128      | [global]
u0:12 | Primitive | usize  | usize     | [global]
u0:13 | Primitive | f32    | f32       | [global]
u0:14 | Primitive | f64    | f64       | [global]
u0:15 | Primitive | bool   | bool      | [global]
u0:16 | Primitive | char   | char      | [global]
u0:17 | Primitive | str    | str       | [global]
u0:18 | Primitive | String | String    | [global]
u0:19 | Crate     | _c     | _c        | [global]
u0:20 | Crate     | crate  | _c::crate |         
u0:21 | File      | main   | _c::main  |         

--- expect:symbol-deps ---


===============================================================================
scoped-identifier-with-nested-super
===============================================================================


--- file: src/main.rs ---
pub fn foo() {}
pub mod m1 {
  mod m2 {
    fn bar() {
      super::super::foo();
    }
}


--- expect:symbols ---
u0:1  | Primitive | i32    | i32                   | [global]
u0:2  | Primitive | i64    | i64                   | [global]
u0:3  | Primitive | i16    | i16                   | [global]
u0:4  | Primitive | i8     | i8                    | [global]
u0:5  | Primitive | i128   | i128                  | [global]
u0:6  | Primitive | isize  | isize                 | [global]
u0:7  | Primitive | u32    | u32                   | [global]
u0:8  | Primitive | u64    | u64                   | [global]
u0:9  | Primitive | u16    | u16                   | [global]
u0:10 | Primitive | u8     | u8                    | [global]
u0:11 | Primitive | u128   | u128                  | [global]
u0:12 | Primitive | usize  | usize                 | [global]
u0:13 | Primitive | f32    | f32                   | [global]
u0:14 | Primitive | f64    | f64                   | [global]
u0:15 | Primitive | bool   | bool                  | [global]
u0:16 | Primitive | char   | char                  | [global]
u0:17 | Primitive | str    | str                   | [global]
u0:18 | Primitive | String | String                | [global]
u0:19 | Crate     | _c     | _c                    | [global]
u0:20 | Crate     | crate  | _c::crate             |         
u0:21 | File      | main   | _c::main              |         
u0:22 | Function  | foo    | _c::main::foo         | [global]
u0:23 | Namespace | m1     | _c::main::m1          | [global]
u0:24 | Namespace | m2     | _c::main::m1::m2      |         
u0:25 | Function  | bar    | _c::main::m1::m2::bar |         

--- expect:symbol-deps ---
u0:21 <- [u0:25]
u0:22 <- [u0:25]
u0:23 -> [u0:24]
u0:24 -> [u0:25]
u0:24 <- [u0:23]
u0:25 -> [u0:21, u0:22]
u0:25 <- [u0:24]

--- expect:blocks ---
u0:1 | root | main
u0:2 | func | foo
u0:3 | func | bar


===============================================================================
generic-functions
===============================================================================


--- file: src/main.rs ---
fn identity<T>(x: T) -> T {
    x
}

fn process<T, const N: usize>(arr: [T; N]) -> T {
    arr[0]
}

fn caller() {
    let a = identity::<i32>(42);
    let b = identity::<String>("hello".to_string());
    let c = process::<u8, 4>([1, 2, 3, 4]);
}

--- expect:symbols ---
u0:1  | Primitive     | i32      | i32                    | [global]
u0:2  | Primitive     | i64      | i64                    | [global]
u0:3  | Primitive     | i16      | i16                    | [global]
u0:4  | Primitive     | i8       | i8                     | [global]
u0:5  | Primitive     | i128     | i128                   | [global]
u0:6  | Primitive     | isize    | isize                  | [global]
u0:7  | Primitive     | u32      | u32                    | [global]
u0:8  | Primitive     | u64      | u64                    | [global]
u0:9  | Primitive     | u16      | u16                    | [global]
u0:10 | Primitive     | u8       | u8                     | [global]
u0:11 | Primitive     | u128     | u128                   | [global]
u0:12 | Primitive     | usize    | usize                  | [global]
u0:13 | Primitive     | f32      | f32                    | [global]
u0:14 | Primitive     | f64      | f64                    | [global]
u0:15 | Primitive     | bool     | bool                   | [global]
u0:16 | Primitive     | char     | char                   | [global]
u0:17 | Primitive     | str      | str                    | [global]
u0:18 | Primitive     | String   | String                 | [global]
u0:19 | Crate         | _c       | _c                     | [global]
u0:20 | Crate         | crate    | _c::crate              |         
u0:21 | File          | main     | _c::main               |         
u0:22 | Function      | identity | _c::main::identity     |         
u0:23 | TypeParameter | T        | _c::main::identity::T  |         
u0:24 | Variable      | x        | _c::main::identity::x  |         
u0:25 | Function      | process  | _c::main::process      |         
u0:26 | TypeParameter | T        | _c::main::process::T   |         
u0:27 | Const         | N        | _c::main::process::N   |         
u0:28 | Variable      | arr      | _c::main::process::arr |         
u0:29 | Function      | caller   | _c::main::caller       |         
u0:30 | Variable      | a        | _c::main::caller::a    |         
u0:31 | Variable      | b        | _c::main::caller::b    |         
u0:32 | Variable      | c        | _c::main::caller::c    |         

--- expect:symbol-deps ---
u0:1 <- [u0:29]
u0:10 <- [u0:29]
u0:12 <- [u0:25, u0:27]
u0:22 <- [u0:29, u0:30, u0:31]
u0:25 -> [u0:12, u0:27]
u0:25 <- [u0:29, u0:32]
u0:27 -> [u0:12]
u0:27 <- [u0:25]
u0:29 -> [u0:1, u0:10, u0:22, u0:25]
u0:30 -> [u0:22]
u0:31 -> [u0:22]
u0:32 -> [u0:25]


===============================================================================
closures
===============================================================================


--- file: src/main.rs ---
fn apply<F: Fn(i32) -> i32>(f: F, x: i32) -> i32 {
    f(x)
}

fn transform(items: Vec<i32>) -> Vec<i32> {
    let factor = 2;
    items.into_iter().map(|x| x * factor).collect()
}

fn caller() {
    let add_one = |n: i32| n + 1;
    let result = apply(add_one, 5);

    let mul = |a, b| a * b;
    let product = mul(3, 4);

    let closure_with_block = |x| {
        let y = x + 1;
        y * 2
    };
}

--- expect:symbols ---
u0:1  | Primitive     | i32                | i32                                  | [global]
u0:2  | Primitive     | i64                | i64                                  | [global]
u0:3  | Primitive     | i16                | i16                                  | [global]
u0:4  | Primitive     | i8                 | i8                                   | [global]
u0:5  | Primitive     | i128               | i128                                 | [global]
u0:6  | Primitive     | isize              | isize                                | [global]
u0:7  | Primitive     | u32                | u32                                  | [global]
u0:8  | Primitive     | u64                | u64                                  | [global]
u0:9  | Primitive     | u16                | u16                                  | [global]
u0:10 | Primitive     | u8                 | u8                                   | [global]
u0:11 | Primitive     | u128               | u128                                 | [global]
u0:12 | Primitive     | usize              | usize                                | [global]
u0:13 | Primitive     | f32                | f32                                  | [global]
u0:14 | Primitive     | f64                | f64                                  | [global]
u0:15 | Primitive     | bool               | bool                                 | [global]
u0:16 | Primitive     | char               | char                                 | [global]
u0:17 | Primitive     | str                | str                                  | [global]
u0:18 | Primitive     | String             | String                               | [global]
u0:19 | Crate         | _c                 | _c                                   | [global]
u0:20 | Crate         | crate              | _c::crate                            |         
u0:21 | File          | main               | _c::main                             |         
u0:22 | Function      | apply              | _c::main::apply                      |         
u0:23 | TypeParameter | F                  | _c::main::apply::F                   |         
u0:24 | Variable      | f                  | _c::main::apply::f                   |         
u0:25 | Variable      | x                  | _c::main::apply::x                   |         
u0:26 | Function      | transform          | _c::main::transform                  |         
u0:27 | Variable      | items              | _c::main::transform::items           |         
u0:28 | Variable      | factor             | _c::main::transform::factor          |         
u0:29 | Variable      | x                  | _c::main::transform::x               |         
u0:30 | Function      | caller             | _c::main::caller                     |         
u0:31 | Closure       | add_one            | _c::main::caller::add_one            |         
u0:32 | Variable      | n                  | _c::main::caller::n                  |         
u0:33 | Variable      | result             | _c::main::caller::result             |         
u0:34 | Closure       | mul                | _c::main::caller::mul                |         
u0:35 | Variable      | a                  | _c::main::caller::a                  |         
u0:36 | Variable      | b                  | _c::main::caller::b                  |         
u0:37 | Variable      | product            | _c::main::caller::product            |         
u0:38 | Closure       | closure_with_block | _c::main::caller::closure_with_block |         
u0:39 | Variable      | x                  | _c::main::caller::x                  |         
u0:40 | Variable      | y                  | _c::main::caller::y                  |         

--- expect:symbol-deps ---
u0:1 <- [u0:22, u0:25, u0:26, u0:28, u0:30, u0:31, u0:32, u0:38, u0:40]
u0:22 -> [u0:1]
u0:22 <- [u0:30, u0:33]
u0:25 -> [u0:1]
u0:26 -> [u0:1]
u0:28 -> [u0:1]
u0:30 -> [u0:1, u0:22, u0:34]
u0:31 -> [u0:1]
u0:32 -> [u0:1]
u0:33 -> [u0:22]
u0:34 <- [u0:30, u0:37]
u0:37 -> [u0:34]
u0:38 -> [u0:1]
u0:40 -> [u0:1]


===============================================================================
closures-with-typed-parameters
===============================================================================


--- file: src/main.rs ---
fn process<F: Fn(i32) -> bool>(filter: F, items: Vec<i32>) -> Vec<i32> {
    items.into_iter().filter(|x| filter(*x)).collect()
}

fn caller() {
    let is_even = |n: i32| -> bool { n % 2 == 0 };
    let is_positive = |x: i32| x > 0;

    let items = vec![1, 2, 3, 4, 5];
    let evens = process(is_even, items.clone());
    let positives = process(is_positive, items);

    let with_multiple_params = |a: i32, b: i32, c: i32| -> i32 {
        a + b + c
    };
    let sum = with_multiple_params(1, 2, 3);
}

--- expect:symbols ---
u0:1  | Primitive     | i32                  | i32                                    | [global]
u0:2  | Primitive     | i64                  | i64                                    | [global]
u0:3  | Primitive     | i16                  | i16                                    | [global]
u0:4  | Primitive     | i8                   | i8                                     | [global]
u0:5  | Primitive     | i128                 | i128                                   | [global]
u0:6  | Primitive     | isize                | isize                                  | [global]
u0:7  | Primitive     | u32                  | u32                                    | [global]
u0:8  | Primitive     | u64                  | u64                                    | [global]
u0:9  | Primitive     | u16                  | u16                                    | [global]
u0:10 | Primitive     | u8                   | u8                                     | [global]
u0:11 | Primitive     | u128                 | u128                                   | [global]
u0:12 | Primitive     | usize                | usize                                  | [global]
u0:13 | Primitive     | f32                  | f32                                    | [global]
u0:14 | Primitive     | f64                  | f64                                    | [global]
u0:15 | Primitive     | bool                 | bool                                   | [global]
u0:16 | Primitive     | char                 | char                                   | [global]
u0:17 | Primitive     | str                  | str                                    | [global]
u0:18 | Primitive     | String               | String                                 | [global]
u0:19 | Crate         | _c                   | _c                                     | [global]
u0:20 | Crate         | crate                | _c::crate                              |         
u0:21 | File          | main                 | _c::main                               |         
u0:22 | Function      | process              | _c::main::process                      |         
u0:23 | TypeParameter | F                    | _c::main::process::F                   |         
u0:24 | Variable      | filter               | _c::main::process::filter              |         
u0:25 | Variable      | items                | _c::main::process::items               |         
u0:26 | Variable      | x                    | _c::main::process::x                   |         
u0:27 | Function      | caller               | _c::main::caller                       |         
u0:28 | Closure       | is_even              | _c::main::caller::is_even              |         
u0:29 | Variable      | n                    | _c::main::caller::n                    |         
u0:30 | Closure       | is_positive          | _c::main::caller::is_positive          |         
u0:31 | Variable      | x                    | _c::main::caller::x                    |         
u0:32 | Variable      | items                | _c::main::caller::items                |         
u0:33 | Variable      | evens                | _c::main::caller::evens                |         
u0:34 | Variable      | positives            | _c::main::caller::positives            |         
u0:35 | Closure       | with_multiple_params | _c::main::caller::with_multiple_params |         
u0:36 | Variable      | a                    | _c::main::caller::a                    |         
u0:37 | Variable      | b                    | _c::main::caller::b                    |         
u0:38 | Variable      | c                    | _c::main::caller::c                    |         
u0:39 | Variable      | sum                  | _c::main::caller::sum                  |         

--- expect:symbol-deps ---
u0:1 <- [u0:22, u0:27, u0:28, u0:29, u0:30, u0:31, u0:32, u0:35, u0:36, u0:37, u0:38, u0:39]
u0:15 <- [u0:22, u0:27]
u0:22 -> [u0:1, u0:15]
u0:22 <- [u0:27, u0:33, u0:34]
u0:27 -> [u0:1, u0:15, u0:22, u0:35]
u0:28 -> [u0:1]
u0:29 -> [u0:1]
u0:30 -> [u0:1]
u0:31 -> [u0:1]
u0:32 -> [u0:1]
u0:33 -> [u0:22]
u0:34 -> [u0:22]
u0:35 -> [u0:1]
u0:35 <- [u0:27]
u0:36 -> [u0:1]
u0:37 -> [u0:1]
u0:38 -> [u0:1]
u0:39 -> [u0:1]


===============================================================================
generators
===============================================================================


--- file: src/main.rs ---
fn create_counter(start: i32, end: i32) -> impl Iterator<Item = i32> {
    let mut i = start;
    move || {
        while i <= end {
            yield i;
            i += 1;
        }
    }
}

fn caller() {
    let counter = create_counter(0, 10);
    let gen = move || {
        yield 1;
        yield 2;
        return 3;
    };
}

--- expect:symbols ---
u0:1  | Primitive | i32            | i32                             | [global]
u0:2  | Primitive | i64            | i64                             | [global]
u0:3  | Primitive | i16            | i16                             | [global]
u0:4  | Primitive | i8             | i8                              | [global]
u0:5  | Primitive | i128           | i128                            | [global]
u0:6  | Primitive | isize          | isize                           | [global]
u0:7  | Primitive | u32            | u32                             | [global]
u0:8  | Primitive | u64            | u64                             | [global]
u0:9  | Primitive | u16            | u16                             | [global]
u0:10 | Primitive | u8             | u8                              | [global]
u0:11 | Primitive | u128           | u128                            | [global]
u0:12 | Primitive | usize          | usize                           | [global]
u0:13 | Primitive | f32            | f32                             | [global]
u0:14 | Primitive | f64            | f64                             | [global]
u0:15 | Primitive | bool           | bool                            | [global]
u0:16 | Primitive | char           | char                            | [global]
u0:17 | Primitive | str            | str                             | [global]
u0:18 | Primitive | String         | String                          | [global]
u0:19 | Crate     | _c             | _c                              | [global]
u0:20 | Crate     | crate          | _c::crate                       |         
u0:21 | File      | main           | _c::main                        |         
u0:22 | Function  | create_counter | _c::main::create_counter        |         
u0:23 | Variable  | start          | _c::main::create_counter::start |         
u0:24 | Variable  | end            | _c::main::create_counter::end   |         
u0:25 | Variable  | i              | _c::main::create_counter::i     |         
u0:26 | Function  | caller         | _c::main::caller                |         
u0:27 | Variable  | counter        | _c::main::caller::counter       |         
u0:28 | Closure   | gen            | _c::main::caller::gen           |         

--- expect:symbol-deps ---
u0:1 <- [u0:22, u0:23, u0:24, u0:25, u0:26, u0:28]
u0:22 -> [u0:1]
u0:22 <- [u0:26, u0:27]
u0:23 -> [u0:1]
u0:24 -> [u0:1]
u0:25 -> [u0:1]
u0:26 -> [u0:1, u0:22]
u0:27 -> [u0:22]
u0:28 -> [u0:1]


===============================================================================
unsafe-blocks
===============================================================================


--- file: src/main.rs ---
unsafe fn dangerous() -> i32 { 42 }

fn safe_wrapper() -> i32 {
    unsafe { dangerous() }
}

static mut COUNTER: i32 = 0;

fn increment_counter() {
    unsafe {
        COUNTER += 1;
    }
}

fn read_counter() -> i32 {
    unsafe { COUNTER }
}

fn with_raw_pointers() {
    let x = 10;
    let ptr = &x as *const i32;
    unsafe {
        let val = *ptr;
    }
}

--- expect:symbols ---
u0:1  | Primitive | i32               | i32                              | [global]
u0:2  | Primitive | i64               | i64                              | [global]
u0:3  | Primitive | i16               | i16                              | [global]
u0:4  | Primitive | i8                | i8                               | [global]
u0:5  | Primitive | i128              | i128                             | [global]
u0:6  | Primitive | isize             | isize                            | [global]
u0:7  | Primitive | u32               | u32                              | [global]
u0:8  | Primitive | u64               | u64                              | [global]
u0:9  | Primitive | u16               | u16                              | [global]
u0:10 | Primitive | u8                | u8                               | [global]
u0:11 | Primitive | u128              | u128                             | [global]
u0:12 | Primitive | usize             | usize                            | [global]
u0:13 | Primitive | f32               | f32                              | [global]
u0:14 | Primitive | f64               | f64                              | [global]
u0:15 | Primitive | bool              | bool                             | [global]
u0:16 | Primitive | char              | char                             | [global]
u0:17 | Primitive | str               | str                              | [global]
u0:18 | Primitive | String            | String                           | [global]
u0:19 | Crate     | _c                | _c                               | [global]
u0:20 | Crate     | crate             | _c::crate                        |         
u0:21 | File      | main              | _c::main                         |         
u0:22 | Function  | dangerous         | _c::main::dangerous              |         
u0:23 | Function  | safe_wrapper      | _c::main::safe_wrapper           |         
u0:24 | Static    | COUNTER           | _c::main::COUNTER                |         
u0:25 | Function  | increment_counter | _c::main::increment_counter      |         
u0:26 | Function  | read_counter      | _c::main::read_counter           |         
u0:27 | Function  | with_raw_pointers | _c::main::with_raw_pointers      |         
u0:28 | Variable  | x                 | _c::main::with_raw_pointers::x   |         
u0:29 | Variable  | ptr               | _c::main::with_raw_pointers::ptr |         
u0:30 | Variable  | val               | _c::main::with_raw_pointers::val |         

--- expect:symbol-deps ---
u0:1 <- [u0:22, u0:23, u0:24, u0:26, u0:27, u0:28, u0:29, u0:30]
u0:22 -> [u0:1]
u0:22 <- [u0:23]
u0:23 -> [u0:1, u0:22]
u0:24 -> [u0:1]
u0:24 <- [u0:25, u0:26]
u0:25 -> [u0:24]
u0:26 -> [u0:1, u0:24]
u0:27 -> [u0:1]
u0:28 -> [u0:1]
u0:29 -> [u0:1]
u0:30 -> [u0:1]


===============================================================================
inline-const-or-const-blocks-as-expression
===============================================================================


--- file: src/main.rs ---
fn compute_at_compile_time() {
    // Simple const block
    let sum = const { 1 + 2 + 3 };

    // Const block in array repeat expression
    let powers: [i32; 4] = [const { 2_i32.pow(10) }; 4];

    // Const block for complex compile-time computation
    let factorial_5 = const {
        let mut result = 1;
        let mut i = 1;
        while i <= 5 {
            result *= i;
            i += 1;
        }
        result
    };

    // Const block in conditional
    let max_size = if true { const { 1024 } } else { const { 512 } };
}

const ARRAY_SIZE: usize = const { 10 * 10 };

static PRECOMPUTED: i32 = const { 7 * 8 };

--- expect:symbols ---
u0:1  | Primitive | i32                     | i32                                            | [global]
u0:2  | Primitive | i64                     | i64                                            | [global]
u0:3  | Primitive | i16                     | i16                                            | [global]
u0:4  | Primitive | i8                      | i8                                             | [global]
u0:5  | Primitive | i128                    | i128                                           | [global]
u0:6  | Primitive | isize                   | isize                                          | [global]
u0:7  | Primitive | u32                     | u32                                            | [global]
u0:8  | Primitive | u64                     | u64                                            | [global]
u0:9  | Primitive | u16                     | u16                                            | [global]
u0:10 | Primitive | u8                      | u8                                             | [global]
u0:11 | Primitive | u128                    | u128                                           | [global]
u0:12 | Primitive | usize                   | usize                                          | [global]
u0:13 | Primitive | f32                     | f32                                            | [global]
u0:14 | Primitive | f64                     | f64                                            | [global]
u0:15 | Primitive | bool                    | bool                                           | [global]
u0:16 | Primitive | char                    | char                                           | [global]
u0:17 | Primitive | str                     | str                                            | [global]
u0:18 | Primitive | String                  | String                                         | [global]
u0:19 | Crate     | _c                      | _c                                             | [global]
u0:20 | Crate     | crate                   | _c::crate                                      |         
u0:21 | File      | main                    | _c::main                                       |         
u0:22 | Function  | compute_at_compile_time | _c::main::compute_at_compile_time              |         
u0:23 | Variable  | sum                     | _c::main::compute_at_compile_time::sum         |         
u0:24 | Variable  | powers                  | _c::main::compute_at_compile_time::powers      |         
u0:25 | Variable  | factorial_5             | _c::main::compute_at_compile_time::factorial_5 |         
u0:26 | Variable  | result                  | _c::main::compute_at_compile_time::result      |         
u0:27 | Variable  | i                       | _c::main::compute_at_compile_time::i           |         
u0:28 | Variable  | max_size                | _c::main::compute_at_compile_time::max_size    |         
u0:29 | Const     | ARRAY_SIZE              | _c::main::ARRAY_SIZE                           |         
u0:30 | Static    | PRECOMPUTED             | _c::main::PRECOMPUTED                          |         

--- expect:symbol-deps ---
u0:1 <- [u0:22, u0:23, u0:24, u0:25, u0:26, u0:27, u0:28, u0:30]
u0:12 <- [u0:29]
u0:22 -> [u0:1]
u0:23 -> [u0:1]
u0:24 -> [u0:1]
u0:25 -> [u0:1]
u0:26 -> [u0:1]
u0:27 -> [u0:1]
u0:28 -> [u0:1]
u0:29 -> [u0:12]
u0:30 -> [u0:1]


===============================================================================
raw-reference-expression-conflicts
===============================================================================


--- file: src/main.rs ---
// Test that `raw` as an identifier doesn't conflict with raw pointer syntax
fn some_call<T>(x: T) {}

fn test_raw_identifier() {
    let raw = 42;
    some_call(&raw);  // &raw is a reference to the variable `raw`
}

fn test_raw_pointer_const() {
    let value = 100;
    let ptr: *const i32 = &raw const value;  // raw pointer to immutable
    unsafe {
        let read_value = *ptr;
    }
}

fn test_raw_pointer_mut() {
    let mut value = 100;
    let ptr: *mut i32 = &raw mut value;  // raw pointer to mutable
    unsafe {
        *ptr = 200;
    }
}

fn test_both_syntaxes() {
    let raw = 50;          // variable named `raw`
    let other = 60;

    let ref_to_raw = &raw;              // reference to variable `raw`
    let ptr_to_other = &raw const other; // raw pointer to `other`
}

--- expect:symbols ---
u0:1  | Primitive     | i32                    | i32                                          | [global]
u0:2  | Primitive     | i64                    | i64                                          | [global]
u0:3  | Primitive     | i16                    | i16                                          | [global]
u0:4  | Primitive     | i8                     | i8                                           | [global]
u0:5  | Primitive     | i128                   | i128                                         | [global]
u0:6  | Primitive     | isize                  | isize                                        | [global]
u0:7  | Primitive     | u32                    | u32                                          | [global]
u0:8  | Primitive     | u64                    | u64                                          | [global]
u0:9  | Primitive     | u16                    | u16                                          | [global]
u0:10 | Primitive     | u8                     | u8                                           | [global]
u0:11 | Primitive     | u128                   | u128                                         | [global]
u0:12 | Primitive     | usize                  | usize                                        | [global]
u0:13 | Primitive     | f32                    | f32                                          | [global]
u0:14 | Primitive     | f64                    | f64                                          | [global]
u0:15 | Primitive     | bool                   | bool                                         | [global]
u0:16 | Primitive     | char                   | char                                         | [global]
u0:17 | Primitive     | str                    | str                                          | [global]
u0:18 | Primitive     | String                 | String                                       | [global]
u0:19 | Crate         | _c                     | _c                                           | [global]
u0:20 | Crate         | crate                  | _c::crate                                    |         
u0:21 | File          | main                   | _c::main                                     |         
u0:22 | Function      | some_call              | _c::main::some_call                          |         
u0:23 | TypeParameter | T                      | _c::main::some_call::T                       |         
u0:24 | Variable      | x                      | _c::main::some_call::x                       |         
u0:25 | Function      | test_raw_identifier    | _c::main::test_raw_identifier                |         
u0:26 | Variable      | raw                    | _c::main::test_raw_identifier::raw           |         
u0:27 | Function      | test_raw_pointer_const | _c::main::test_raw_pointer_const             |         
u0:28 | Variable      | value                  | _c::main::test_raw_pointer_const::value      |         
u0:29 | Variable      | ptr                    | _c::main::test_raw_pointer_const::ptr        |         
u0:30 | Variable      | read_value             | _c::main::test_raw_pointer_const::read_value |         
u0:31 | Function      | test_raw_pointer_mut   | _c::main::test_raw_pointer_mut               |         
u0:32 | Variable      | value                  | _c::main::test_raw_pointer_mut::value        |         
u0:33 | Variable      | ptr                    | _c::main::test_raw_pointer_mut::ptr          |         
u0:34 | Function      | test_both_syntaxes     | _c::main::test_both_syntaxes                 |         
u0:35 | Variable      | raw                    | _c::main::test_both_syntaxes::raw            |         
u0:36 | Variable      | other                  | _c::main::test_both_syntaxes::other          |         
u0:37 | Variable      | ref_to_raw             | _c::main::test_both_syntaxes::ref_to_raw     |         
u0:38 | Variable      | ptr_to_other           | _c::main::test_both_syntaxes::ptr_to_other   |         

--- expect:symbol-deps ---
u0:1 <- [u0:25, u0:26, u0:27, u0:28, u0:29, u0:30, u0:31, u0:32, u0:33, u0:34, u0:35, u0:36, u0:38]
u0:22 <- [u0:25]
u0:25 -> [u0:1, u0:22]
u0:26 -> [u0:1]
u0:27 -> [u0:1]
u0:28 -> [u0:1]
u0:29 -> [u0:1]
u0:30 -> [u0:1]
u0:31 -> [u0:1]
u0:32 -> [u0:1]
u0:33 -> [u0:1]
u0:34 -> [u0:1]
u0:35 -> [u0:1]
u0:36 -> [u0:1]
u0:38 -> [u0:1]
