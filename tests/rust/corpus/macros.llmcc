===============================================================================
macro-invocation-no-arguments
===============================================================================


--- file: src/main.rs ---
macro_rules! a [];
mod d {
    macro_rules! e [];
}
mod f {
    mod g {
        macro_rules! h [];
    }
}

fn foo() {
    a!();
    b![];
    c!{};
    d::e!();
    f::g::h!{};
}

--- expect:symbols ---
u0:1  | Type      | i32     | i32                      | [global]
u0:2  | Type      | i64     | i64                      | [global]
u0:3  | Type      | i16     | i16                      | [global]
u0:4  | Type      | i8      | i8                       | [global]
u0:5  | Type      | i128    | i128                     | [global]
u0:6  | Type      | isize   | isize                    | [global]
u0:7  | Type      | u32     | u32                      | [global]
u0:8  | Type      | u64     | u64                      | [global]
u0:9  | Type      | u16     | u16                      | [global]
u0:10 | Type      | u8      | u8                       | [global]
u0:11 | Type      | u128    | u128                     | [global]
u0:12 | Type      | usize   | usize                    | [global]
u0:13 | Type      | f32     | f32                      | [global]
u0:14 | Type      | f64     | f64                      | [global]
u0:15 | Type      | bool    | bool                     | [global]
u0:16 | Type      | char    | char                     | [global]
u0:17 | Type      | str     | str                      | [global]
u0:18 | Module    | main    | main                     | [global]
u0:19 | File      | main    | main::main               |         
u0:20 | Macro     | a       | main::main::a            |         
u0:21 | Namespace | d       | main::main::d            |         
u0:22 | Macro     | e       | main::main::d::e         |         
u0:23 | Namespace | f       | main::main::f            |         
u0:24 | Namespace | g       | main::main::f::g         |         
u0:25 | Macro     | h       | main::main::f::g::h      |         
u0:26 | Function  | foo     | main::main::foo          |         
u0:27 | Namespace | block_0 | main::main::foo::block_0 |         

--- expect:symbol-deps ---
u0:20 <- [u0:26]
u0:22 <- [u0:26]
u0:25 <- [u0:26]
u0:26 -> [u0:20, u0:22, u0:25]


===============================================================================
macro-invocation-arbitrary-tokens
===============================================================================


--- file: src/main.rs ---
macro_rules! a [];
fn foo() {
    a!(* a *);
    a!(& a &);
    a!(- a -);
    a!(b + c + +);
    a!('a'..='z');
    a!('\u{0}'..='\u{2}');
    a!('lifetime)
    default!(a);
    union!(a);
    a!($);
    a!($());
    a!($ a $);
    a!(${$([ a ])});
    a!($a $a:ident $($a);*);
}

--- expect:symbols ---
u0:1  | Type      | i32     | i32                      | [global]
u0:2  | Type      | i64     | i64                      | [global]
u0:3  | Type      | i16     | i16                      | [global]
u0:4  | Type      | i8      | i8                       | [global]
u0:5  | Type      | i128    | i128                     | [global]
u0:6  | Type      | isize   | isize                    | [global]
u0:7  | Type      | u32     | u32                      | [global]
u0:8  | Type      | u64     | u64                      | [global]
u0:9  | Type      | u16     | u16                      | [global]
u0:10 | Type      | u8      | u8                       | [global]
u0:11 | Type      | u128    | u128                     | [global]
u0:12 | Type      | usize   | usize                    | [global]
u0:13 | Type      | f32     | f32                      | [global]
u0:14 | Type      | f64     | f64                      | [global]
u0:15 | Type      | bool    | bool                     | [global]
u0:16 | Type      | char    | char                     | [global]
u0:17 | Type      | str     | str                      | [global]
u0:18 | Module    | main    | main                     | [global]
u0:19 | File      | main    | main::main               |         
u0:20 | Macro     | a       | main::main::a            |         
u0:21 | Function  | foo     | main::main::foo          |         
u0:22 | Namespace | block_0 | main::main::foo::block_0 |         

--- expect:symbol-deps ---
u0:20 <- [u0:21]
u0:21 -> [u0:20]


===============================================================================
macro-invocation-with-comments
===============================================================================


--- file: src/main.rs ---
macro_rules! ok [];
fn foo() {
    ok! {
    // one
    /* two */
    }
}

--- expect:symbols ---
u0:1  | Type      | i32     | i32                      | [global]
u0:2  | Type      | i64     | i64                      | [global]
u0:3  | Type      | i16     | i16                      | [global]
u0:4  | Type      | i8      | i8                       | [global]
u0:5  | Type      | i128    | i128                     | [global]
u0:6  | Type      | isize   | isize                    | [global]
u0:7  | Type      | u32     | u32                      | [global]
u0:8  | Type      | u64     | u64                      | [global]
u0:9  | Type      | u16     | u16                      | [global]
u0:10 | Type      | u8      | u8                       | [global]
u0:11 | Type      | u128    | u128                     | [global]
u0:12 | Type      | usize   | usize                    | [global]
u0:13 | Type      | f32     | f32                      | [global]
u0:14 | Type      | f64     | f64                      | [global]
u0:15 | Type      | bool    | bool                     | [global]
u0:16 | Type      | char    | char                     | [global]
u0:17 | Type      | str     | str                      | [global]
u0:18 | Module    | main    | main                     | [global]
u0:19 | File      | main    | main::main               |         
u0:20 | Macro     | ok      | main::main::ok           |         
u0:21 | Function  | foo     | main::main::foo          |         
u0:22 | Namespace | block_0 | main::main::foo::block_0 |         

--- expect:symbol-deps ---
u0:20 <- [u0:21]
u0:21 -> [u0:20]


===============================================================================
macro-definition
===============================================================================


--- file: src/main.rs ---
macro_rules! say_hello {
    () => (
        println!("Hello!");
    )
}

macro_rules! four {
    () => {1 + 3};
}

macro_rules! foo {
    (x => $e:expr) => (println!("mode X: {}", $e));
    (y => $e:expr) => (println!("mode Y: {}", $e))
}

macro_rules! o_O {
    (
      $($x:expr; [ $( $y:expr ),* ]);*
    ) => {
      $($($x + $e),*),*
    }
}

macro_rules! zero_or_one {
    ($($e:expr),?) => {
        $($e),?
    };
}

macro_rules! empty [
    () => {};
];

--- expect:symbols ---
u0:1  | Type   | i32         | i32                     | [global]
u0:2  | Type   | i64         | i64                     | [global]
u0:3  | Type   | i16         | i16                     | [global]
u0:4  | Type   | i8          | i8                      | [global]
u0:5  | Type   | i128        | i128                    | [global]
u0:6  | Type   | isize       | isize                   | [global]
u0:7  | Type   | u32         | u32                     | [global]
u0:8  | Type   | u64         | u64                     | [global]
u0:9  | Type   | u16         | u16                     | [global]
u0:10 | Type   | u8          | u8                      | [global]
u0:11 | Type   | u128        | u128                    | [global]
u0:12 | Type   | usize       | usize                   | [global]
u0:13 | Type   | f32         | f32                     | [global]
u0:14 | Type   | f64         | f64                     | [global]
u0:15 | Type   | bool        | bool                    | [global]
u0:16 | Type   | char        | char                    | [global]
u0:17 | Type   | str         | str                     | [global]
u0:18 | Module | main        | main                    | [global]
u0:19 | File   | main        | main::main              |         
u0:20 | Macro  | say_hello   | main::main::say_hello   |         
u0:21 | Macro  | four        | main::main::four        |         
u0:22 | Macro  | foo         | main::main::foo         |         
u0:23 | Macro  | o_O         | main::main::o_O         |         
u0:24 | Macro  | zero_or_one | main::main::zero_or_one |         
u0:25 | Macro  | empty       | main::main::empty       |         

--- expect:symbol-deps ---
