===============================================================================
macro-invocation-no-arguments
===============================================================================


--- file: src/main.rs ---
macro_rules! a [];
mod d {
    macro_rules! e [];
}
mod f {
    mod g {
        macro_rules! h [];
    }
}

fn foo() {
    a!();
    b![];
    c!{};
    d::e!();
    f::g::h!{};
}

--- expect:symbols ---
u0:1 | Module    | main | main | [global]
u0:2 | File      | main | main |         
u0:3 | Macro     | a    | a    |         
u0:4 | Namespace | d    | d    |         
u0:5 | Macro     | e    | e    |         
u0:6 | Namespace | f    | f    |         
u0:7 | Namespace | g    | g    |         
u0:8 | Macro     | h    | h    |         
u0:9 | Function  | foo  | foo  |         

--- expect:symbol-deps ---
u0:3 <- [u0:9]
u0:5 <- [u0:9]
u0:8 <- [u0:9]
u0:9 -> [u0:3, u0:5, u0:8]


===============================================================================
macro-invocation-arbitrary-tokens
===============================================================================


--- file: src/main.rs ---
macro_rules! a [];
fn foo() {
    a!(* a *);
    a!(& a &);
    a!(- a -);
    a!(b + c + +);
    a!('a'..='z');
    a!('\u{0}'..='\u{2}');
    a!('lifetime)
    default!(a);
    union!(a);
    a!($);
    a!($());
    a!($ a $);
    a!(${$([ a ])});
    a!($a $a:ident $($a);*);
}

--- expect:symbols ---
u0:1 | Module   | main | main | [global]
u0:2 | File     | main | main |         
u0:3 | Macro    | a    | a    |         
u0:4 | Function | foo  | foo  |         

--- expect:symbol-deps ---
u0:3 <- [u0:4]
u0:4 -> [u0:3]


===============================================================================
macro-invocation-with-comments
===============================================================================


--- file: src/main.rs ---
macro_rules! ok [];
fn foo() {
    ok! {
    // one
    /* two */
    }
}

--- expect:symbols ---
u0:1 | Module   | main | main | [global]
u0:2 | File     | main | main |         
u0:3 | Macro    | ok   | ok   |         
u0:4 | Function | foo  | foo  |         

--- expect:symbol-deps ---
u0:3 <- [u0:4]
u0:4 -> [u0:3]


===============================================================================
macro-definition
===============================================================================


--- file: src/main.rs ---
macro_rules! say_hello {
    () => (
        println!("Hello!");
    )
}

macro_rules! four {
    () => {1 + 3};
}

macro_rules! foo {
    (x => $e:expr) => (println!("mode X: {}", $e));
    (y => $e:expr) => (println!("mode Y: {}", $e))
}

macro_rules! o_O {
    (
      $($x:expr; [ $( $y:expr ),* ]);*
    ) => {
      $($($x + $e),*),*
    }
}

macro_rules! zero_or_one {
    ($($e:expr),?) => {
        $($e),?
    };
}

macro_rules! empty [
    () => {};
];

--- expect:symbols ---
u0:1 | Module | main        | main        | [global]
u0:2 | File   | main        | main        |         
u0:3 | Macro  | say_hello   | say_hello   |         
u0:4 | Macro  | four        | four        |         
u0:5 | Macro  | foo         | foo         |         
u0:6 | Macro  | o_O         | o_O         |         
u0:7 | Macro  | zero_or_one | zero_or_one |         
u0:8 | Macro  | empty       | empty       |         
