===============================================================================
call-target-callkind-function-one
===============================================================================
Tests basic function call resolution where main() calls helper().

--- file: src/main.rs ---
fn helper() -> i32 {
    42
}

fn main() {
    let x = helper();
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                   | [global]
u0:2  | Primitive | i64    | i64                   | [global]
u0:3  | Primitive | i16    | i16                   | [global]
u0:4  | Primitive | i8     | i8                    | [global]
u0:5  | Primitive | i128   | i128                  | [global]
u0:6  | Primitive | isize  | isize                 | [global]
u0:7  | Primitive | u32    | u32                   | [global]
u0:8  | Primitive | u64    | u64                   | [global]
u0:9  | Primitive | u16    | u16                   | [global]
u0:10 | Primitive | u8     | u8                    | [global]
u0:11 | Primitive | u128   | u128                  | [global]
u0:12 | Primitive | usize  | usize                 | [global]
u0:13 | Primitive | f32    | f32                   | [global]
u0:14 | Primitive | f64    | f64                   | [global]
u0:15 | Primitive | bool   | bool                  | [global]
u0:16 | Primitive | char   | char                  | [global]
u0:17 | Primitive | str    | str                   | [global]
u0:18 | Primitive | String | String                | [global]
u0:19 | Crate     | _c     | _c                    | [global]
u0:20 | Crate     | crate  | _c::crate             |
u0:21 | Module    | _m     | _c::_m                |
u0:22 | File      | main   | _c::_m::main          |
u0:23 | Function  | helper | _c::_m::main::helper  |
u0:24 | Function  | main   | _c::_m::main::main    |
u0:25 | Variable  | x      | _c::_m::main::main::x |

--- expect:symbol-deps ---
u0:1 <- [u0:23]
u0:23 -> [u0:1]
u0:23 <- [u0:24, u0:25]
u0:24 -> [u0:23]
u0:25 -> [u0:23]


===============================================================================
call-target-callkind-function-two
===============================================================================
Tests function call with multiple arguments: main() calls add(a, b).

--- file: src/main.rs ---
fn add(a: i32, b: i32) -> i32 {
    a + b
}

fn main() {
    let result = add(1, 2);
}

--- expect:symbols ---
u0:1  | Primitive | i32    | i32                        | [global]
u0:2  | Primitive | i64    | i64                        | [global]
u0:3  | Primitive | i16    | i16                        | [global]
u0:4  | Primitive | i8     | i8                         | [global]
u0:5  | Primitive | i128   | i128                       | [global]
u0:6  | Primitive | isize  | isize                      | [global]
u0:7  | Primitive | u32    | u32                        | [global]
u0:8  | Primitive | u64    | u64                        | [global]
u0:9  | Primitive | u16    | u16                        | [global]
u0:10 | Primitive | u8     | u8                         | [global]
u0:11 | Primitive | u128   | u128                       | [global]
u0:12 | Primitive | usize  | usize                      | [global]
u0:13 | Primitive | f32    | f32                        | [global]
u0:14 | Primitive | f64    | f64                        | [global]
u0:15 | Primitive | bool   | bool                       | [global]
u0:16 | Primitive | char   | char                       | [global]
u0:17 | Primitive | str    | str                        | [global]
u0:18 | Primitive | String | String                     | [global]
u0:19 | Crate     | _c     | _c                         | [global]
u0:20 | Crate     | crate  | _c::crate                  |
u0:21 | Module    | _m     | _c::_m                     |
u0:22 | File      | main   | _c::_m::main               |
u0:23 | Function  | add    | _c::_m::main::add          |
u0:24 | Variable  | a      | _c::_m::main::add::a       |
u0:25 | Variable  | b      | _c::_m::main::add::b       |
u0:26 | Function  | main   | _c::_m::main::main         |
u0:27 | Variable  | result | _c::_m::main::main::result |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:24, u0:25]
u0:23 -> [u0:1]
u0:23 <- [u0:26, u0:27]
u0:24 -> [u0:1]
u0:25 -> [u0:1]
u0:26 -> [u0:23]
u0:27 -> [u0:23]


===============================================================================
call-target-callkind-macro
===============================================================================
Tests macro invocation call kind detection with say_hello!().

--- file: src/main.rs ---
macro_rules! say_hello {
    () => {
        println!("Hello!");
    };
}

fn main() {
    say_hello!();
}

--- expect:symbols ---
u0:1  | Primitive | i32       | i32                     | [global]
u0:2  | Primitive | i64       | i64                     | [global]
u0:3  | Primitive | i16       | i16                     | [global]
u0:4  | Primitive | i8        | i8                      | [global]
u0:5  | Primitive | i128      | i128                    | [global]
u0:6  | Primitive | isize     | isize                   | [global]
u0:7  | Primitive | u32       | u32                     | [global]
u0:8  | Primitive | u64       | u64                     | [global]
u0:9  | Primitive | u16       | u16                     | [global]
u0:10 | Primitive | u8        | u8                      | [global]
u0:11 | Primitive | u128      | u128                    | [global]
u0:12 | Primitive | usize     | usize                   | [global]
u0:13 | Primitive | f32       | f32                     | [global]
u0:14 | Primitive | f64       | f64                     | [global]
u0:15 | Primitive | bool      | bool                    | [global]
u0:16 | Primitive | char      | char                    | [global]
u0:17 | Primitive | str       | str                     | [global]
u0:18 | Primitive | String    | String                  | [global]
u0:19 | Crate     | _c        | _c                      | [global]
u0:20 | Crate     | crate     | _c::crate               |
u0:21 | Module    | _m        | _c::_m                  |
u0:22 | File      | main      | _c::_m::main            |
u0:23 | Macro     | say_hello | _c::_m::main::say_hello |
u0:24 | Function  | main      | _c::_m::main::main      |

--- expect:symbol-deps ---
u0:23 <- [u0:24]
u0:24 -> [u0:23]


===============================================================================
call-target-callkind-chain-method-callchainroot-invocation
===============================================================================
Tests method chain where root is an invocation: Builder::new().add(1).add(2).build().

--- file: src/main.rs ---
struct Builder {
    value: i32,
}

impl Builder {
    fn new() -> Self {
        Builder { value: 0 }
    }

    fn add(mut self, n: i32) -> Self {
        self.value += n;
        self
    }

    fn build(self) -> i32 {
        self.value
    }
}

fn main() {
    let result = Builder::new().add(1).add(2).build();
}

--- expect:symbols ---
u0:1  | Primitive | i32     | i32                           | [global]
u0:2  | Primitive | i64     | i64                           | [global]
u0:3  | Primitive | i16     | i16                           | [global]
u0:4  | Primitive | i8      | i8                            | [global]
u0:5  | Primitive | i128    | i128                          | [global]
u0:6  | Primitive | isize   | isize                         | [global]
u0:7  | Primitive | u32     | u32                           | [global]
u0:8  | Primitive | u64     | u64                           | [global]
u0:9  | Primitive | u16     | u16                           | [global]
u0:10 | Primitive | u8      | u8                            | [global]
u0:11 | Primitive | u128    | u128                          | [global]
u0:12 | Primitive | usize   | usize                         | [global]
u0:13 | Primitive | f32     | f32                           | [global]
u0:14 | Primitive | f64     | f64                           | [global]
u0:15 | Primitive | bool    | bool                          | [global]
u0:16 | Primitive | char    | char                          | [global]
u0:17 | Primitive | str     | str                           | [global]
u0:18 | Primitive | String  | String                        | [global]
u0:19 | Crate     | _c      | _c                            | [global]
u0:20 | Crate     | crate   | _c::crate                     |
u0:21 | Module    | _m      | _c::_m                        |
u0:22 | File      | main    | _c::_m::main                  |
u0:23 | Struct    | Builder | _c::_m::main::Builder         |
u0:24 | Field     | value   | _c::_m::main::Builder::value  |
u0:25 | Function  | new     | _c::_m::main::Builder::new    |
u0:26 | Function  | add     | _c::_m::main::Builder::add    |
u0:27 | Variable  | n       | _c::_m::main::Builder::add::n |
u0:28 | Function  | build   | _c::_m::main::Builder::build  |
u0:29 | Function  | main    | _c::_m::main::main            |
u0:30 | Variable  | result  | _c::_m::main::main::result    |

--- expect:symbol-deps ---
u0:1 <- [u0:23, u0:24, u0:26, u0:27, u0:28]
u0:23 -> [u0:1, u0:26, u0:28]
u0:23 <- [u0:25, u0:29, u0:30]
u0:24 -> [u0:1]
u0:25 -> [u0:23]
u0:25 <- [u0:29]
u0:26 -> [u0:1]
u0:26 <- [u0:23, u0:29]
u0:27 -> [u0:1]
u0:28 -> [u0:1]
u0:28 <- [u0:23, u0:29]
u0:29 -> [u0:23, u0:25, u0:26, u0:28]
u0:30 -> [u0:23]


===============================================================================
call-target-callkind-chain-method-callchainroot-expr
===============================================================================
Tests method chain where root is a variable expression: data.iter().map().count().

--- file: src/main.rs ---
struct Data;

struct Iter;

impl Data {
    fn new() -> Self { Data }

    fn iter(&self) -> Iter { Iter }
}

impl Iter {
    fn map(&self) -> Iter { Iter }

    fn count(&self) -> usize { 0 }
}

fn expr_chain() {
    let data = Data::new();
    data.iter().map().count();
}

--- expect:symbols ---
u0:1  | Primitive | i32        | i32                            | [global]
u0:2  | Primitive | i64        | i64                            | [global]
u0:3  | Primitive | i16        | i16                            | [global]
u0:4  | Primitive | i8         | i8                             | [global]
u0:5  | Primitive | i128       | i128                           | [global]
u0:6  | Primitive | isize      | isize                          | [global]
u0:7  | Primitive | u32        | u32                            | [global]
u0:8  | Primitive | u64        | u64                            | [global]
u0:9  | Primitive | u16        | u16                            | [global]
u0:10 | Primitive | u8         | u8                             | [global]
u0:11 | Primitive | u128       | u128                           | [global]
u0:12 | Primitive | usize      | usize                          | [global]
u0:13 | Primitive | f32        | f32                            | [global]
u0:14 | Primitive | f64        | f64                            | [global]
u0:15 | Primitive | bool       | bool                           | [global]
u0:16 | Primitive | char       | char                           | [global]
u0:17 | Primitive | str        | str                            | [global]
u0:18 | Primitive | String     | String                         | [global]
u0:19 | Crate     | _c         | _c                             | [global]
u0:20 | Crate     | crate      | _c::crate                      |
u0:21 | Module    | _m         | _c::_m                         |
u0:22 | File      | main       | _c::_m::main                   |
u0:23 | Struct    | Data       | _c::_m::main::Data             |
u0:24 | Struct    | Iter       | _c::_m::main::Iter             |
u0:25 | Function  | new        | _c::_m::main::Data::new        |
u0:26 | Function  | iter       | _c::_m::main::Data::iter       |
u0:27 | Function  | map        | _c::_m::main::Iter::map        |
u0:28 | Function  | count      | _c::_m::main::Iter::count      |
u0:29 | Function  | expr_chain | _c::_m::main::expr_chain       |
u0:30 | Variable  | data       | _c::_m::main::expr_chain::data |

--- expect:symbol-deps ---
u0:12 <- [u0:28]
u0:23 -> [u0:24, u0:25, u0:26]
u0:23 <- [u0:29, u0:30]
u0:24 -> [u0:27, u0:28]
u0:24 <- [u0:23, u0:26]
u0:25 <- [u0:23, u0:29]
u0:26 -> [u0:24]
u0:26 <- [u0:23, u0:29]
u0:27 <- [u0:24, u0:29]
u0:28 -> [u0:12]
u0:28 <- [u0:24, u0:29]
u0:29 -> [u0:23, u0:25, u0:26, u0:27, u0:28]
u0:30 -> [u0:23]


===============================================================================
call-target-callkind-chain-variable
===============================================================================
Tests method call on intermediate variable: cursor = stream.advance(); cursor.flush().

--- file: src/main.rs ---
struct Stream;

impl Stream {
    fn advance(&mut self) -> &mut Self { self }
    fn flush(&self) {}
}

fn chain_variable_demo(mut stream: Stream) {
    let cursor = stream.advance();
    cursor.flush();
}

--- expect:symbols ---
u0:1  | Primitive | i32                 | i32                                       | [global]
u0:2  | Primitive | i64                 | i64                                       | [global]
u0:3  | Primitive | i16                 | i16                                       | [global]
u0:4  | Primitive | i8                  | i8                                        | [global]
u0:5  | Primitive | i128                | i128                                      | [global]
u0:6  | Primitive | isize               | isize                                     | [global]
u0:7  | Primitive | u32                 | u32                                       | [global]
u0:8  | Primitive | u64                 | u64                                       | [global]
u0:9  | Primitive | u16                 | u16                                       | [global]
u0:10 | Primitive | u8                  | u8                                        | [global]
u0:11 | Primitive | u128                | u128                                      | [global]
u0:12 | Primitive | usize               | usize                                     | [global]
u0:13 | Primitive | f32                 | f32                                       | [global]
u0:14 | Primitive | f64                 | f64                                       | [global]
u0:15 | Primitive | bool                | bool                                      | [global]
u0:16 | Primitive | char                | char                                      | [global]
u0:17 | Primitive | str                 | str                                       | [global]
u0:18 | Primitive | String              | String                                    | [global]
u0:19 | Crate     | _c                  | _c                                        | [global]
u0:20 | Crate     | crate               | _c::crate                                 |
u0:21 | Module    | _m                  | _c::_m                                    |
u0:22 | File      | main                | _c::_m::main                              |
u0:23 | Struct    | Stream              | _c::_m::main::Stream                      |
u0:24 | Function  | advance             | _c::_m::main::Stream::advance             |
u0:25 | Function  | flush               | _c::_m::main::Stream::flush               |
u0:26 | Function  | chain_variable_demo | _c::_m::main::chain_variable_demo         |
u0:27 | Variable  | stream              | _c::_m::main::chain_variable_demo::stream |
u0:28 | Variable  | cursor              | _c::_m::main::chain_variable_demo::cursor |

--- expect:symbol-deps ---
u0:23 -> [u0:24, u0:25]
u0:23 <- [u0:26, u0:27, u0:28]
u0:24 <- [u0:23, u0:26]
u0:25 <- [u0:23, u0:26]
u0:26 -> [u0:23, u0:24, u0:25]
u0:27 -> [u0:23]
u0:28 -> [u0:23]
