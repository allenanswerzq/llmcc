===============================================================================
call-target-callkind-function-one
===============================================================================


--- file: app/src/main.rs ---
mod helpers {
    pub fn compute() {}
}

fn function_demo() {
    helpers::compute();
}

--- expect:symbols ---
u0:1 | Module    | main          | main          | [global]
u0:2 | File      | main          | main          |         
u0:3 | Namespace | helpers       | helpers       |         
u0:4 | Function  | compute       | compute       |         
u0:5 | Function  | function_demo | function_demo |         

--- expect:symbol-deps ---


--- expect:graph ---
digraph project {
}


===============================================================================
call-target-callkind-function-two
===============================================================================


--- file: app/src/main.rs ---
struct Foo;
struct Baz;
struct SessionBuilder;

impl SessionBuilder {
    fn new() -> Self {
        SessionBuilder
    }

    fn static_func() -> Foo {}
}

fn qualified_call(baz: &Baz) {
    SessionBuilder::new();
    let x = SessionBuilder::static_func();
}

--- expect:symbols ---
u0:1  | Module   | main                | main                | [global]
u0:2  | File     | main                | main                |         
u0:3  | Struct   | Foo                 | Foo                 |         
u0:4  | Struct   | Baz                 | Baz                 |         
u0:5  | Struct   | SessionBuilder      | SessionBuilder      |         
u0:6  | Impl     | impl SessionBuilder | impl SessionBuilder |         
u0:7  | Function | new                 | new                 |         
u0:8  | Function | static_func         | static_func         |         
u0:9  | Function | qualified_call      | qualified_call      |         
u0:10 | Variable | baz                 | baz                 |         
u0:11 | Variable | x                   | x                   |         

--- expect:symbol-deps ---
u0:10 -> [u0:4]
u0:4 <- [u0:10]
u0:5 <- [u0:6]
u0:6 -> [u0:5]

--- expect:blocks ---
u0:159 | root   | main               
u0:160 | class  | Foo                
u0:161 | class  | Baz                
u0:162 | class  | SessionBuilder     
u0:163 | impl   | impl SessionBuilder
u0:164 | method | new                
u0:165 | method | static_func        
u0:166 | func   | qualified_call     
u0:167 | call   | block#167          
u0:168 | call   | block#168          

--- expect:block-deps ---
u0:162 <- [u0:163]
u0:163 -> [u0:162]

--- expect:graph ---
digraph project {
}


===============================================================================
call-target-callkind-macro
===============================================================================


--- file: src/main.rs ---
macro_rules! log_value {
    ($value:expr) => {{
        let _captured = $value;
    }};
}

fn macro_demo() {
    log_value!("hi");
}

--- expect:symbols ---
u0:1 | Module   | main       | main       | [global]
u0:2 | File     | main       | main       |         
u0:3 | Macro    | log_value  | log_value  |         
u0:4 | Function | macro_demo | macro_demo |         

--- expect:symbol-deps ---



===============================================================================
call-target-callkind-chain-method-callchainroot-invocation
===============================================================================


--- file: app/src/main.rs ---
struct Builder;

impl Builder {
    fn new() -> Self {
        Builder
    }

    fn step(self) -> Self {
        self
    }

    fn finish(self) {}
}

fn chain_invocation_demo() {
    Builder::new().step().finish();
}

--- expect:symbols ---
u0:1 | Module   | main                  | main                  | [global]
u0:2 | File     | main                  | main                  |         
u0:3 | Struct   | Builder               | Builder               |         
u0:4 | Impl     | impl Builder          | impl Builder          |         
u0:5 | Function | new                   | new                   |         
u0:6 | Function | step                  | step                  |         
u0:7 | Function | finish                | finish                |         
u0:8 | Function | chain_invocation_demo | chain_invocation_demo |         

--- expect:symbol-deps ---
u0:3 <- [u0:4]
u0:4 -> [u0:3]

--- expect:graph ---
digraph project {
}


===============================================================================
call-target-callkind-chain-method-callchainroot-expr
===============================================================================


--- file: app/src/main.rs ---
struct Data;
struct Iter;

impl Data {
    fn iter(&self) -> Iter {
        Iter
    }
}

impl Iter {
    fn map(&self) -> Iter {
        Iter
    }

    fn count(&self) -> usize {
        0
    }
}

fn expr_chain() {
    let data = Data::new();
    data.iter().map().count();
}

--- expect:symbols ---
u0:1  | Module   | main       | main       | [global]
u0:2  | File     | main       | main       |         
u0:3  | Struct   | Data       | Data       |         
u0:4  | Struct   | Iter       | Iter       |         
u0:5  | Impl     | impl Data  | impl Data  |         
u0:6  | Function | iter       | iter       |         
u0:7  | Impl     | impl Iter  | impl Iter  |         
u0:8  | Function | map        | map        |         
u0:9  | Function | count      | count      |         
u0:10 | Function | expr_chain | expr_chain |         
u0:11 | Variable | data       | data       |         

--- expect:symbol-deps ---
u0:3 <- [u0:5]
u0:4 <- [u0:7]
u0:5 -> [u0:3]
u0:7 -> [u0:4]

--- expect:blocks ---
u0:177 | root   | main      
u0:178 | class  | Data      
u0:179 | class  | Iter      
u0:180 | impl   | impl Data 
u0:181 | method | iter      
u0:182 | impl   | impl Iter 
u0:183 | method | map       
u0:184 | method | count     
u0:185 | func   | expr_chain
u0:186 | call   | block#186 
u0:187 | call   | block#187 

--- expect:graph ---
digraph project {
}


===============================================================================
call-target-callkind-chain-variable
===============================================================================


--- file: app/src/main.rs ---
struct Stream;

impl Stream {
    fn advance(&mut self) -> &mut Self {
        self
    }

    fn flush(&self) {}
}

fn chain_variable_demo(mut stream: Stream) {
    let cursor = stream.advance();
    cursor.flush();
}

--- expect:symbols ---
u0:1 | Module   | main                | main                | [global]
u0:2 | File     | main                | main                |         
u0:3 | Struct   | Stream              | Stream              |         
u0:4 | Impl     | impl Stream         | impl Stream         |         
u0:5 | Function | advance             | advance             |         
u0:6 | Function | flush               | flush               |         
u0:7 | Function | chain_variable_demo | chain_variable_demo |         
u0:8 | Variable | stream              | stream              |         
u0:9 | Variable | cursor              | cursor              |         

--- expect:symbol-deps ---
u0:3 <- [u0:4, u0:8]
u0:4 -> [u0:3]
u0:8 -> [u0:3]

--- expect:blocks ---
u0:188 | root   | main               
u0:189 | class  | Stream             
u0:190 | impl   | impl Stream        
u0:191 | method | advance            
u0:192 | method | flush              
u0:193 | func   | chain_variable_demo
u0:194 | call   | block#194          
u0:195 | call   | block#195          

--- expect:block-deps ---
u0:189 <- [u0:190]
u0:190 -> [u0:189]

--- expect:graph ---
digraph project {
}

